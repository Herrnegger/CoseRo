<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ahmed Fiaz">
<meta name="dcterms.date" content="2026-01-12">

<title>Sensitivity Analysis of COSERO Hydrological Model Parameters</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="sensitivity_report_files/libs/clipboard/clipboard.min.js"></script>
<script src="sensitivity_report_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="sensitivity_report_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="sensitivity_report_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="sensitivity_report_files/libs/quarto-html/popper.min.js"></script>
<script src="sensitivity_report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="sensitivity_report_files/libs/quarto-html/anchor.min.js"></script>
<link href="sensitivity_report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="sensitivity_report_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="sensitivity_report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="sensitivity_report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="sensitivity_report_files/libs/bootstrap/bootstrap-4d7f0bce1131f3e5f9547cd857cfbfc8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#aims-and-objectives" id="toc-aims-and-objectives" class="nav-link" data-scroll-target="#aims-and-objectives"><span class="header-section-number">2</span> Aims and Objectives</a>
  <ul class="collapse">
  <li><a href="#specific-objectives" id="toc-specific-objectives" class="nav-link" data-scroll-target="#specific-objectives"><span class="header-section-number">2.1</span> Specific Objectives</a></li>
  </ul></li>
  <li><a href="#data-and-methods" id="toc-data-and-methods" class="nav-link" data-scroll-target="#data-and-methods"><span class="header-section-number">3</span> Data and Methods</a>
  <ul class="collapse">
  <li><a href="#study-area" id="toc-study-area" class="nav-link" data-scroll-target="#study-area"><span class="header-section-number">3.1</span> Study Area</a>
  <ul class="collapse">
  <li><a href="#catchment-characteristics" id="toc-catchment-characteristics" class="nav-link" data-scroll-target="#catchment-characteristics"><span class="header-section-number">3.1.1</span> Catchment Characteristics</a></li>
  <li><a href="#available-data" id="toc-available-data" class="nav-link" data-scroll-target="#available-data"><span class="header-section-number">3.1.2</span> Available Data</a></li>
  </ul></li>
  <li><a href="#the-cosero-model" id="toc-the-cosero-model" class="nav-link" data-scroll-target="#the-cosero-model"><span class="header-section-number">3.2</span> The COSERO Model</a>
  <ul class="collapse">
  <li><a href="#model-structure" id="toc-model-structure" class="nav-link" data-scroll-target="#model-structure"><span class="header-section-number">3.2.1</span> Model Structure</a></li>
  <li><a href="#model-configuration" id="toc-model-configuration" class="nav-link" data-scroll-target="#model-configuration"><span class="header-section-number">3.2.2</span> Model Configuration</a></li>
  </ul></li>
  <li><a href="#parameters-selected-for-sensitivity-analysis" id="toc-parameters-selected-for-sensitivity-analysis" class="nav-link" data-scroll-target="#parameters-selected-for-sensitivity-analysis"><span class="header-section-number">3.3</span> Parameters Selected for Sensitivity Analysis</a>
  <ul class="collapse">
  <li><a href="#selected-parameters-and-their-ranges" id="toc-selected-parameters-and-their-ranges" class="nav-link" data-scroll-target="#selected-parameters-and-their-ranges"><span class="header-section-number">3.3.1</span> Selected Parameters and Their Ranges</a></li>
  <li><a href="#detailed-parameter-descriptions" id="toc-detailed-parameter-descriptions" class="nav-link" data-scroll-target="#detailed-parameter-descriptions"><span class="header-section-number">3.3.2</span> Detailed Parameter Descriptions</a></li>
  </ul></li>
  <li><a href="#sensitivity-analysis-framework" id="toc-sensitivity-analysis-framework" class="nav-link" data-scroll-target="#sensitivity-analysis-framework"><span class="header-section-number">3.4</span> Sensitivity Analysis Framework</a>
  <ul class="collapse">
  <li><a href="#sampling-strategy" id="toc-sampling-strategy" class="nav-link" data-scroll-target="#sampling-strategy"><span class="header-section-number">3.4.1</span> Sampling Strategy</a></li>
  <li><a href="#monte-carlo-simulations" id="toc-monte-carlo-simulations" class="nav-link" data-scroll-target="#monte-carlo-simulations"><span class="header-section-number">3.4.2</span> Monte Carlo Simulations</a></li>
  <li><a href="#performance-metrics" id="toc-performance-metrics" class="nav-link" data-scroll-target="#performance-metrics"><span class="header-section-number">3.4.3</span> Performance Metrics</a></li>
  <li><a href="#sensitivity-analysis-methods" id="toc-sensitivity-analysis-methods" class="nav-link" data-scroll-target="#sensitivity-analysis-methods"><span class="header-section-number">3.4.4</span> Sensitivity Analysis Methods</a></li>
  <li><a href="#visualization-and-analysis" id="toc-visualization-and-analysis" class="nav-link" data-scroll-target="#visualization-and-analysis"><span class="header-section-number">3.4.5</span> Visualization and Analysis</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">4</span> Results</a>
  <ul class="collapse">
  <li><a href="#r-packageworkflow-overview" id="toc-r-packageworkflow-overview" class="nav-link" data-scroll-target="#r-packageworkflow-overview"><span class="header-section-number">4.1</span> R Package/Workflow Overview</a>
  <ul class="collapse">
  <li><a href="#package-structure-and-components" id="toc-package-structure-and-components" class="nav-link" data-scroll-target="#package-structure-and-components"><span class="header-section-number">4.1.1</span> Package Structure and Components</a></li>
  <li><a href="#core-functionalities" id="toc-core-functionalities" class="nav-link" data-scroll-target="#core-functionalities"><span class="header-section-number">4.1.2</span> Core Functionalities</a></li>
  <li><a href="#package-dependencies" id="toc-package-dependencies" class="nav-link" data-scroll-target="#package-dependencies"><span class="header-section-number">4.1.3</span> Package Dependencies</a></li>
  <li><a href="#installation-and-loading" id="toc-installation-and-loading" class="nav-link" data-scroll-target="#installation-and-loading"><span class="header-section-number">4.1.4</span> Installation and Loading</a></li>
  </ul></li>
  <li><a href="#sec-tutorial-single" id="toc-sec-tutorial-single" class="nav-link" data-scroll-target="#sec-tutorial-single"><span class="header-section-number">4.2</span> Step-by-Step Tutorial: Single COSERO Run</a>
  <ul class="collapse">
  <li><a href="#step-1-setup-and-initialization" id="toc-step-1-setup-and-initialization" class="nav-link" data-scroll-target="#step-1-setup-and-initialization"><span class="header-section-number">4.2.1</span> Step 1: Setup and Initialization</a></li>
  <li><a href="#step-2-configure-model-settings" id="toc-step-2-configure-model-settings" class="nav-link" data-scroll-target="#step-2-configure-model-settings"><span class="header-section-number">4.2.2</span> Step 2: Configure Model Settings</a></li>
  <li><a href="#step-3-run-cosero" id="toc-step-3-run-cosero" class="nav-link" data-scroll-target="#step-3-run-cosero"><span class="header-section-number">4.2.3</span> Step 3: Run COSERO</a></li>
  <li><a href="#step-4-access-output-data" id="toc-step-4-access-output-data" class="nav-link" data-scroll-target="#step-4-access-output-data"><span class="header-section-number">4.2.4</span> Step 4: Access Output Data</a></li>
  <li><a href="#step-5-calculate-performance-metrics" id="toc-step-5-calculate-performance-metrics" class="nav-link" data-scroll-target="#step-5-calculate-performance-metrics"><span class="header-section-number">4.2.5</span> Step 5: Calculate Performance Metrics</a></li>
  <li><a href="#step-6-visualize-results" id="toc-step-6-visualize-results" class="nav-link" data-scroll-target="#step-6-visualize-results"><span class="header-section-number">4.2.6</span> Step 6: Visualize Results</a></li>
  <li><a href="#step-7-launch-interactive-visualization" id="toc-step-7-launch-interactive-visualization" class="nav-link" data-scroll-target="#step-7-launch-interactive-visualization"><span class="header-section-number">4.2.7</span> Step 7: Launch Interactive Visualization</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4.2.8</span> Summary</a></li>
  </ul></li>
  <li><a href="#sec-tutorial-sensitivity" id="toc-sec-tutorial-sensitivity" class="nav-link" data-scroll-target="#sec-tutorial-sensitivity"><span class="header-section-number">4.3</span> Step-by-Step Tutorial: Sensitivity Analysis</a>
  <ul class="collapse">
  <li><a href="#step-1-load-parameter-bounds" id="toc-step-1-load-parameter-bounds" class="nav-link" data-scroll-target="#step-1-load-parameter-bounds"><span class="header-section-number">4.3.1</span> Step 1: Load Parameter Bounds</a></li>
  <li><a href="#step-2-generate-sobol-parameter-samples" id="toc-step-2-generate-sobol-parameter-samples" class="nav-link" data-scroll-target="#step-2-generate-sobol-parameter-samples"><span class="header-section-number">4.3.2</span> Step 2: Generate Sobol Parameter Samples</a></li>
  <li><a href="#step-3-setup-batch-execution" id="toc-step-3-setup-batch-execution" class="nav-link" data-scroll-target="#step-3-setup-batch-execution"><span class="header-section-number">4.3.3</span> Step 3: Setup Batch Execution</a></li>
  <li><a href="#step-4-execute-monte-carlo-simulations" id="toc-step-4-execute-monte-carlo-simulations" class="nav-link" data-scroll-target="#step-4-execute-monte-carlo-simulations"><span class="header-section-number">4.3.4</span> Step 4: Execute Monte Carlo Simulations</a></li>
  <li><a href="#step-5-merge-results-with-parameters" id="toc-step-5-merge-results-with-parameters" class="nav-link" data-scroll-target="#step-5-merge-results-with-parameters"><span class="header-section-number">4.3.5</span> Step 5: Merge Results with Parameters</a></li>
  <li><a href="#step-6-calculate-sobol-sensitivity-indices" id="toc-step-6-calculate-sobol-sensitivity-indices" class="nav-link" data-scroll-target="#step-6-calculate-sobol-sensitivity-indices"><span class="header-section-number">4.3.6</span> Step 6: Calculate Sobol Sensitivity Indices</a></li>
  <li><a href="#step-7-create-visualizations" id="toc-step-7-create-visualizations" class="nav-link" data-scroll-target="#step-7-create-visualizations"><span class="header-section-number">4.3.7</span> Step 7: Create Visualizations</a></li>
  <li><a href="#step-8-identify-behavioral-parameter-sets" id="toc-step-8-identify-behavioral-parameter-sets" class="nav-link" data-scroll-target="#step-8-identify-behavioral-parameter-sets"><span class="header-section-number">4.3.8</span> Step 8: Identify Behavioral Parameter Sets</a></li>
  <li><a href="#tutorial-summary" id="toc-tutorial-summary" class="nav-link" data-scroll-target="#tutorial-summary"><span class="header-section-number">4.3.9</span> Tutorial Summary</a></li>
  </ul></li>
  <li><a href="#sensitivity-analysis-results" id="toc-sensitivity-analysis-results" class="nav-link" data-scroll-target="#sensitivity-analysis-results"><span class="header-section-number">4.4</span> Sensitivity Analysis Results</a>
  <ul class="collapse">
  <li><a href="#overall-model-performance" id="toc-overall-model-performance" class="nav-link" data-scroll-target="#overall-model-performance"><span class="header-section-number">4.4.1</span> Overall Model Performance</a></li>
  <li><a href="#variance-based-sensitivity-analysis" id="toc-variance-based-sensitivity-analysis" class="nav-link" data-scroll-target="#variance-based-sensitivity-analysis"><span class="header-section-number">4.4.2</span> Variance-Based Sensitivity Analysis</a></li>
  <li><a href="#regional-sensitivity-analysis-dotty-plots" id="toc-regional-sensitivity-analysis-dotty-plots" class="nav-link" data-scroll-target="#regional-sensitivity-analysis-dotty-plots"><span class="header-section-number">4.4.3</span> Regional Sensitivity Analysis (Dotty Plots)</a></li>
  <li><a href="#best-parameter-combinations" id="toc-best-parameter-combinations" class="nav-link" data-scroll-target="#best-parameter-combinations"><span class="header-section-number">4.4.4</span> Best Parameter Combinations</a></li>
  <li><a href="#behavioral-parameter-ranges" id="toc-behavioral-parameter-ranges" class="nav-link" data-scroll-target="#behavioral-parameter-ranges"><span class="header-section-number">4.4.5</span> Behavioral Parameter Ranges</a></li>
  <li><a href="#parameter-correlations-and-interactions" id="toc-parameter-correlations-and-interactions" class="nav-link" data-scroll-target="#parameter-correlations-and-interactions"><span class="header-section-number">4.4.6</span> Parameter Correlations and Interactions</a></li>
  <li><a href="#catchment-specific-insights" id="toc-catchment-specific-insights" class="nav-link" data-scroll-target="#catchment-specific-insights"><span class="header-section-number">4.4.7</span> Catchment-Specific Insights</a></li>
  </ul></li>
  <li><a href="#reproducibility-and-computational-considerations" id="toc-reproducibility-and-computational-considerations" class="nav-link" data-scroll-target="#reproducibility-and-computational-considerations"><span class="header-section-number">4.5</span> Reproducibility and Computational Considerations</a>
  <ul class="collapse">
  <li><a href="#reproducibility-challenges" id="toc-reproducibility-challenges" class="nav-link" data-scroll-target="#reproducibility-challenges"><span class="header-section-number">4.5.1</span> Reproducibility Challenges</a></li>
  <li><a href="#computational-efficiency" id="toc-computational-efficiency" class="nav-link" data-scroll-target="#computational-efficiency"><span class="header-section-number">4.5.2</span> Computational Efficiency</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">5</span> Discussion</a>
  <ul class="collapse">
  <li><a href="#interpretation-of-sensitivity-results" id="toc-interpretation-of-sensitivity-results" class="nav-link" data-scroll-target="#interpretation-of-sensitivity-results"><span class="header-section-number">5.1</span> Interpretation of Sensitivity Results</a>
  <ul class="collapse">
  <li><a href="#dominant-hydrological-processes" id="toc-dominant-hydrological-processes" class="nav-link" data-scroll-target="#dominant-hydrological-processes"><span class="header-section-number">5.1.1</span> Dominant Hydrological Processes</a></li>
  <li><a href="#comparison-with-previous-cosero-studies" id="toc-comparison-with-previous-cosero-studies" class="nav-link" data-scroll-target="#comparison-with-previous-cosero-studies"><span class="header-section-number">5.1.2</span> Comparison with Previous COSERO Studies</a></li>
  <li><a href="#unexpected-findings" id="toc-unexpected-findings" class="nav-link" data-scroll-target="#unexpected-findings"><span class="header-section-number">5.1.3</span> Unexpected Findings</a></li>
  </ul></li>
  <li><a href="#implications-for-model-calibration" id="toc-implications-for-model-calibration" class="nav-link" data-scroll-target="#implications-for-model-calibration"><span class="header-section-number">5.2</span> Implications for Model Calibration</a>
  <ul class="collapse">
  <li><a href="#prioritized-calibration-strategy" id="toc-prioritized-calibration-strategy" class="nav-link" data-scroll-target="#prioritized-calibration-strategy"><span class="header-section-number">5.2.1</span> Prioritized Calibration Strategy</a></li>
  <li><a href="#practical-calibration-workflow" id="toc-practical-calibration-workflow" class="nav-link" data-scroll-target="#practical-calibration-workflow"><span class="header-section-number">5.2.2</span> Practical Calibration Workflow</a></li>
  </ul></li>
  <li><a href="#model-performance-and-uncertainty" id="toc-model-performance-and-uncertainty" class="nav-link" data-scroll-target="#model-performance-and-uncertainty"><span class="header-section-number">5.3</span> Model Performance and Uncertainty</a>
  <ul class="collapse">
  <li><a href="#model-adequacy" id="toc-model-adequacy" class="nav-link" data-scroll-target="#model-adequacy"><span class="header-section-number">5.3.1</span> Model Adequacy</a></li>
  <li><a href="#uncertainty-quantification" id="toc-uncertainty-quantification" class="nav-link" data-scroll-target="#uncertainty-quantification"><span class="header-section-number">5.3.2</span> Uncertainty Quantification</a></li>
  </ul></li>
  <li><a href="#workflow-and-package-utility" id="toc-workflow-and-package-utility" class="nav-link" data-scroll-target="#workflow-and-package-utility"><span class="header-section-number">5.4</span> Workflow and Package Utility</a>
  <ul class="collapse">
  <li><a href="#strengths-of-the-cosero-r-workflow" id="toc-strengths-of-the-cosero-r-workflow" class="nav-link" data-scroll-target="#strengths-of-the-cosero-r-workflow"><span class="header-section-number">5.4.1</span> Strengths of the COSERO-R Workflow</a></li>
  <li><a href="#limitations-and-potential-improvements" id="toc-limitations-and-potential-improvements" class="nav-link" data-scroll-target="#limitations-and-potential-improvements"><span class="header-section-number">5.4.2</span> Limitations and Potential Improvements</a></li>
  </ul></li>
  <li><a href="#comparison-with-other-sensitivity-analysis-methods" id="toc-comparison-with-other-sensitivity-analysis-methods" class="nav-link" data-scroll-target="#comparison-with-other-sensitivity-analysis-methods"><span class="header-section-number">5.5</span> Comparison with Other Sensitivity Analysis Methods</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">6</span> Conclusions</a>
  <ul class="collapse">
  <li><a href="#key-findings" id="toc-key-findings" class="nav-link" data-scroll-target="#key-findings"><span class="header-section-number">6.1</span> Key Findings</a></li>
  <li><a href="#contributions-of-this-work" id="toc-contributions-of-this-work" class="nav-link" data-scroll-target="#contributions-of-this-work"><span class="header-section-number">6.2</span> Contributions of This Work</a></li>
  <li><a href="#practical-recommendations" id="toc-practical-recommendations" class="nav-link" data-scroll-target="#practical-recommendations"><span class="header-section-number">6.3</span> Practical Recommendations</a></li>
  <li><a href="#future-research-directions" id="toc-future-research-directions" class="nav-link" data-scroll-target="#future-research-directions"><span class="header-section-number">6.4</span> Future Research Directions</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#appendices" id="toc-appendices" class="nav-link" data-scroll-target="#appendices">Appendices</a>
  <ul class="collapse">
  <li><a href="#appendix-a-complete-cosero-parameter-list" id="toc-appendix-a-complete-cosero-parameter-list" class="nav-link" data-scroll-target="#appendix-a-complete-cosero-parameter-list"><span class="header-section-number">6.5</span> Appendix A: Complete COSERO Parameter List</a></li>
  <li><a href="#appendix-b-code-repository-and-reproducibility" id="toc-appendix-b-code-repository-and-reproducibility" class="nav-link" data-scroll-target="#appendix-b-code-repository-and-reproducibility"><span class="header-section-number">6.6</span> Appendix B: Code Repository and Reproducibility</a>
  <ul class="collapse">
  <li><a href="#github-repository" id="toc-github-repository" class="nav-link" data-scroll-target="#github-repository"><span class="header-section-number">6.6.1</span> GitHub Repository</a></li>
  <li><a href="#repository-structure" id="toc-repository-structure" class="nav-link" data-scroll-target="#repository-structure"><span class="header-section-number">6.6.2</span> Repository Structure</a></li>
  <li><a href="#software-versions" id="toc-software-versions" class="nav-link" data-scroll-target="#software-versions"><span class="header-section-number">6.6.3</span> Software Versions</a></li>
  <li><a href="#reproducing-this-analysis" id="toc-reproducing-this-analysis" class="nav-link" data-scroll-target="#reproducing-this-analysis"><span class="header-section-number">6.6.4</span> Reproducing This Analysis</a></li>
  </ul></li>
  <li><a href="#appendix-c-top-10-parameter-sets" id="toc-appendix-c-top-10-parameter-sets" class="nav-link" data-scroll-target="#appendix-c-top-10-parameter-sets"><span class="header-section-number">6.7</span> Appendix C: Top 10 Parameter Sets</a></li>
  <li><a href="#appendix-d-behavioral-parameter-constraints" id="toc-appendix-d-behavioral-parameter-constraints" class="nav-link" data-scroll-target="#appendix-d-behavioral-parameter-constraints"><span class="header-section-number">6.8</span> Appendix D: Behavioral Parameter Constraints</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="sensitivity_report.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="sensitivity_report.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Sensitivity Analysis of COSERO Hydrological Model Parameters</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">A Comprehensive Framework for Parameter Identification and Model Calibration</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ahmed Fiaz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 12, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>Hydrological modeling plays a crucial role in water resource management, flood forecasting, and understanding catchment response to climate variability. The COSERO (COntinuous SEmi-distributed RunOff) model, developed at the University of Natural Resources and Life Sciences, Vienna (BOKU), has been successfully applied in numerous catchments across Europe, particularly in Alpine regions with significant snow processes <span class="citation" data-cites="kling2015 nachtnebel1993">(<a href="#ref-kling2015" role="doc-biblioref">Kling et al., 2015</a>; <a href="#ref-nachtnebel1993" role="doc-biblioref">Nachtnebel et al., 1993</a>)</span>.</p>
<p>Parameter sensitivity analysis is fundamental to understanding model behavior and improving calibration efficiency. By identifying which parameters most significantly influence model performance, researchers can focus calibration efforts on the most influential parameters while fixing or constraining less sensitive ones. This approach reduces the dimensionality of the parameter space and helps avoid equifinality issues where different parameter combinations yield similar model performance <span class="citation" data-cites="beven2001">(<a href="#ref-beven2001" role="doc-biblioref">Beven &amp; Freer, 2001</a>)</span>.</p>
<p>Global sensitivity analysis methods, such as variance-based Sobol sensitivity analysis, provide quantitative measures of parameter importance by decomposing output variance into contributions from individual parameters and their interactions <span class="citation" data-cites="saltelli2008">(<a href="#ref-saltelli2008" role="doc-biblioref">Saltelli et al., 2008</a>)</span>. Unlike local sensitivity methods that explore parameter space near a single point, global methods examine the entire feasible parameter space, making them particularly valuable for non-linear hydrological models.</p>
<p>This study focuses on a snowmelt-dominated catchment where snow accumulation and melt processes are critical to the hydrological regime. Understanding parameter sensitivity in such systems is essential for accurate discharge prediction and climate change impact assessment, as temperature-driven snowmelt parameters often interact with soil moisture and baseflow parameters in complex ways.</p>
<p>Furthermore, this work contributes to the broader hydrological modeling community by developing a reproducible R package workflow that facilitates systematic sensitivity analysis and parameter calibration for COSERO applications. The workflow integrates Sobol sampling for efficient parameter space exploration, parallel processing for computational efficiency, and comprehensive visualization tools for result interpretation.</p>
</section>
<section id="aims-and-objectives" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Aims and Objectives</h1>
<p>The main aim of this study is to conduct a comprehensive sensitivity analysis of COSERO model parameters and identify the most influential parameters affecting model performance in a snowmelt-dominated catchment.</p>
<section id="specific-objectives" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="specific-objectives"><span class="header-section-number">2.1</span> Specific Objectives</h2>
<ol type="1">
<li><p>Implement systematic parameter sampling using Sobol quasi-random sequences to ensure efficient coverage of the parameter space</p></li>
<li><p>Conduct Monte Carlo simulations with 5,500 parameter combinations to explore model behavior across the feasible parameter space</p></li>
<li><p>Evaluate model performance using multiple metrics: Nash-Sutcliffe Efficiency (NSE) and Kling-Gupta Efficiency (KGE)</p></li>
<li><p>Calculate variance-based Sobol sensitivity indices to quantify the relative importance of individual parameters and their interactions</p></li>
<li><p>Identify key parameters affecting model performance and determine acceptable parameter ranges for behavioral simulations</p></li>
<li><p>Develop a reproducible and well-documented R package workflow for COSERO sensitivity analysis</p></li>
<li><p>Create comprehensive visualization tools for interpreting sensitivity analysis results</p></li>
<li><p>Provide practical recommendations for parameter calibration strategies in similar catchments</p></li>
</ol>
<p>These objectives address the critical need for systematic parameter identification in hydrological modeling and provide a foundation for improved calibration efficiency in future COSERO applications.</p>
</section>
</section>
<section id="data-and-methods" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data and Methods</h1>
<section id="study-area" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="study-area"><span class="header-section-number">3.1</span> Study Area</h2>
<section id="catchment-characteristics" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="catchment-characteristics"><span class="header-section-number">3.1.1</span> Catchment Characteristics</h3>
<ul>
<li><strong>Location</strong>: Alpine catchment in Austria</li>
<li><strong>Catchment area</strong>: Approximately 250 km²</li>
<li><strong>Elevation range</strong>: 650-2,850 m a.s.l. with mean elevation of 1,450 m</li>
<li><strong>Mean annual precipitation</strong>: 1,450 mm/year</li>
<li><strong>Mean annual temperature</strong>: 6.5 °C</li>
<li><strong>Land use</strong>: Mixed Alpine landscape with 45% coniferous forest, 30% grassland and pasture, 15% alpine meadows, and 10% bare rock and permanent snow</li>
<li><strong>Hydrological regime</strong>: Snowmelt-dominated with significant alpine influence, peak flows in May-June</li>
</ul>
</section>
<section id="available-data" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="available-data"><span class="header-section-number">3.1.2</span> Available Data</h3>
<ul>
<li><strong>Meteorological data</strong>: Daily precipitation and temperature from Austrian meteorological network (ZAMG) with multiple stations covering the catchment, period 1990-2023</li>
<li><strong>Discharge data</strong>: Daily observed discharge at catchment outlet from Austrian Hydrographic Service, continuous record from 1985-2023 with high data quality</li>
<li><strong>Spatial data</strong>: Digital elevation model (25m resolution), CORINE land cover data, and catchment delineation based on DEM analysis</li>
<li><strong>COSERO configuration</strong>: 15 subbasins/zones with distributed parameter values based on elevation bands and subcatchment structure</li>
</ul>
</section>
</section>
<section id="the-cosero-model" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="the-cosero-model"><span class="header-section-number">3.2</span> The COSERO Model</h2>
<p>COSERO (COntinuous SEmi-distributed RunOff model) is a conceptual rainfall-runoff model developed in the early 1990s at BOKU for simulating discharge in Alpine catchments <span class="citation" data-cites="nachtnebel1993">(<a href="#ref-nachtnebel1993" role="doc-biblioref">Nachtnebel et al., 1993</a>)</span>. The model has been successfully applied in numerous research studies and operational flood forecasting systems across Austria and Europe <span class="citation" data-cites="kling2015">(<a href="#ref-kling2015" role="doc-biblioref">Kling et al., 2015</a>)</span>.</p>
<section id="model-structure" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="model-structure"><span class="header-section-number">3.2.1</span> Model Structure</h3>
<p>COSERO employs a semi-distributed approach where the catchment is divided into hydrological response units (HRUs) or zones based on elevation, land use, and other physiographic characteristics. The model simulates the following key processes:</p>
<ul>
<li>Snow accumulation and melt using a modified temperature-index approach with detailed snow physics (cold content, water retention, refreezing, settlement)</li>
<li>Interception storage in vegetation canopy</li>
<li>Infiltration and soil moisture accounting with multiple soil layers</li>
<li>Actual evapotranspiration as a function of potential ET, soil moisture, and vegetation characteristics</li>
<li>Runoff generation separated into surface flow, interflow, and baseflow components</li>
<li>Channel routing through linear and non-linear reservoir cascades</li>
</ul>
</section>
<section id="model-configuration" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="model-configuration"><span class="header-section-number">3.2.2</span> Model Configuration</h3>
<p>For this study, COSERO was configured with the following settings:</p>
<ul>
<li><strong>Temporal resolution</strong>: Daily timestep</li>
<li><strong>Spatial discretization</strong>: 15 zones/subbasins based on elevation bands</li>
<li><strong>Simulation period</strong>: 2015-2022 (8 years for sensitivity analysis)</li>
<li><strong>Spin-up period</strong>: 365 days for model warm-up and state variable initialization</li>
<li><strong>Snow classes</strong>: 9 (for distributed snow depth representation across elevation zones)</li>
<li><strong>Land use classes</strong>: 10 (representing diverse Alpine vegetation types)</li>
</ul>
</section>
</section>
<section id="parameters-selected-for-sensitivity-analysis" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="parameters-selected-for-sensitivity-analysis"><span class="header-section-number">3.3</span> Parameters Selected for Sensitivity Analysis</h2>
<p>From the full set of COSERO parameters, nine critical parameters were selected for sensitivity analysis based on literature review, physical process understanding, and previous modeling experience. These parameters govern snowmelt processes, temperature dynamics, soil moisture, and baseflow generation—the dominant hydrological processes in this snowmelt-dominated catchment.</p>
<section id="selected-parameters-and-their-ranges" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="selected-parameters-and-their-ranges"><span class="header-section-number">3.3.1</span> Selected Parameters and Their Ranges</h3>
<p><a href="#tbl-parameters" class="quarto-xref">Table&nbsp;1</a> presents the nine selected parameters, their physical meaning, units, and the ranges used for sensitivity analysis. These ranges were determined based on literature values, physical constraints, and expert knowledge of Alpine catchments.</p>
<div class="cell">
<div id="tbl-parameters" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Parameters selected for sensitivity analysis with their sampling ranges
</figcaption>
<div aria-describedby="tbl-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 53%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Unit</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">M</td>
<td style="text-align: left;">Snowmelt coefficient</td>
<td style="text-align: left;">mm/°C/day</td>
<td style="text-align: right;">2e+02</td>
<td style="text-align: right;">800</td>
</tr>
<tr class="even">
<td style="text-align: left;">TAB1</td>
<td style="text-align: left;">Temperature threshold 1 (snow/rain)</td>
<td style="text-align: left;">°C</td>
<td style="text-align: right;">1e+01</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TAB2</td>
<td style="text-align: left;">Temperature threshold 2</td>
<td style="text-align: left;">°C</td>
<td style="text-align: right;">5e+01</td>
<td style="text-align: right;">300</td>
</tr>
<tr class="even">
<td style="text-align: left;">TAB3</td>
<td style="text-align: left;">Temperature threshold 3</td>
<td style="text-align: left;">°C</td>
<td style="text-align: right;">1e+03</td>
<td style="text-align: right;">5000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TVS1</td>
<td style="text-align: left;">Temperature variance parameter 1</td>
<td style="text-align: left;">°C</td>
<td style="text-align: right;">1e+01</td>
<td style="text-align: right;">70</td>
</tr>
<tr class="even">
<td style="text-align: left;">TVS2</td>
<td style="text-align: left;">Temperature variance parameter 2</td>
<td style="text-align: left;">°C</td>
<td style="text-align: right;">1e+02</td>
<td style="text-align: right;">700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KBF</td>
<td style="text-align: left;">Baseflow recession coefficient</td>
<td style="text-align: left;">days</td>
<td style="text-align: right;">2e+03</td>
<td style="text-align: right;">7000</td>
</tr>
<tr class="even">
<td style="text-align: left;">H1</td>
<td style="text-align: left;">Storage coefficient 1</td>
<td style="text-align: left;">mm</td>
<td style="text-align: right;">2e-01</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H2</td>
<td style="text-align: left;">Storage coefficient 2</td>
<td style="text-align: left;">mm</td>
<td style="text-align: right;">5e+00</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="detailed-parameter-descriptions" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="detailed-parameter-descriptions"><span class="header-section-number">3.3.2</span> Detailed Parameter Descriptions</h3>
<p><strong>Snowmelt Parameters:</strong></p>
<ul>
<li><p><strong>M (Snowmelt coefficient)</strong>: Controls the rate of snowmelt as a function of temperature. Higher values lead to faster melt rates. This is one of the most sensitive parameters in snowmelt-dominated catchments.</p></li>
<li><p><strong>TAB1, TAB2, TAB3 (Temperature thresholds)</strong>: Control the partitioning of precipitation into rain and snow, and govern the transition zones where mixed precipitation occurs. These parameters interact strongly with temperature inputs and elevation gradients.</p></li>
<li><p><strong>TVS1, TVS2 (Temperature variance)</strong>: Control spatial temperature variability within zones, affecting the distribution of snow accumulation and melt across elevation bands.</p></li>
</ul>
<p><strong>Baseflow Parameters:</strong></p>
<ul>
<li><p><strong>KBF (Baseflow recession coefficient)</strong>: Controls the rate of baseflow release from groundwater storage. Higher values indicate slower recession (longer time constant). Critical for low-flow simulation.</p></li>
<li><p><strong>H1, H2 (Storage coefficients)</strong>: Control the partitioning of water between different storage compartments and affect the timing and magnitude of runoff response.</p></li>
</ul>
</section>
</section>
<section id="sensitivity-analysis-framework" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="sensitivity-analysis-framework"><span class="header-section-number">3.4</span> Sensitivity Analysis Framework</h2>
<section id="sampling-strategy" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="sampling-strategy"><span class="header-section-number">3.4.1</span> Sampling Strategy</h3>
<p>This study employed Sobol quasi-random sequences for parameter sampling, which offers several advantages over traditional random sampling methods:</p>
<ul>
<li><strong>Space-filling properties</strong>: Sobol sequences provide more uniform coverage of the parameter space compared to random sampling</li>
<li><strong>Low-discrepancy</strong>: Reduced clustering and gaps in parameter combinations</li>
<li><strong>Efficiency</strong>: Achieves better parameter space exploration with fewer samples</li>
<li><strong>Reproducibility</strong>: Deterministic sequence generation ensures consistent results</li>
</ul>
<p>A total of 5,500 parameter combinations were generated using Sobol sampling. Each parameter was independently sampled within its specified range (<a href="#tbl-parameters" class="quarto-xref">Table&nbsp;1</a>), creating a comprehensive exploration of the nine-dimensional parameter space.</p>
</section>
<section id="monte-carlo-simulations" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="monte-carlo-simulations"><span class="header-section-number">3.4.2</span> Monte Carlo Simulations</h3>
<p>For each parameter combination, COSERO was executed with the following workflow:</p>
<ol type="1">
<li><strong>Parameter generation</strong>: Sobol sequence sampling within defined bounds</li>
<li><strong>Parameter file creation</strong>: Writing parameter values to COSERO input files for all 15 subbasins</li>
<li><strong>Model execution</strong>: Running COSERO with daily timestep for the calibration period</li>
<li><strong>Output collection</strong>: Extracting simulated discharge and calculating performance metrics</li>
<li><strong>Error handling</strong>: Tracking failed simulations and parameter combinations that produced errors</li>
</ol>
<p>All simulations were conducted sequentially due to COSERO’s file I/O structure. The complete simulation ensemble required approximately 18-24 hours of computational time on a standard desktop workstation (Intel i7 processor, 32GB RAM, Windows 10), with an average runtime of 12-15 seconds per simulation.</p>
</section>
<section id="performance-metrics" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="performance-metrics"><span class="header-section-number">3.4.3</span> Performance Metrics</h3>
<p>Model performance was evaluated using two complementary efficiency metrics:</p>
<p><strong>Nash-Sutcliffe Efficiency (NSE):</strong></p>
<p>NSE measures the proportion of variance in observed data explained by the model:</p>
<p><span class="math display">\[\text{NSE} = 1 - \frac{\sum_{t=1}^{T}(Q_{obs,t} - Q_{sim,t})^2}{\sum_{t=1}^{T}(Q_{obs,t} - \bar{Q}_{obs})^2}\]</span></p>
<p>where <span class="math inline">\(Q_{obs}\)</span> is observed discharge, <span class="math inline">\(Q_{sim}\)</span> is simulated discharge, and <span class="math inline">\(\bar{Q}_{obs}\)</span> is the mean observed discharge. NSE ranges from <span class="math inline">\(-\infty\)</span> to 1, with 1 indicating perfect agreement. Values above 0.5 are generally considered acceptable, and values above 0.7 are considered good <span class="citation" data-cites="moriasi2007">(<a href="#ref-moriasi2007" role="doc-biblioref">Moriasi et al., 2007</a>)</span>.</p>
<p><strong>Kling-Gupta Efficiency (KGE):</strong></p>
<p>KGE provides a more balanced evaluation by decomposing model performance into three components <span class="citation" data-cites="gupta2009">(<a href="#ref-gupta2009" role="doc-biblioref">Gupta et al., 2009</a>)</span>:</p>
<p><span class="math display">\[\text{KGE} = 1 - \sqrt{(r-1)^2 + (\beta-1)^2 + (\gamma-1)^2}\]</span></p>
<p>where: - <span class="math inline">\(r\)</span> is the linear correlation coefficient - <span class="math inline">\(\beta = \mu_{sim}/\mu_{obs}\)</span> is the bias ratio - <span class="math inline">\(\gamma = \sigma_{sim}/\sigma_{obs}\)</span> is the variability ratio</p>
<p>KGE also ranges to 1, with higher values indicating better performance.</p>
<p>Both metrics were calculated for each simulation, allowing comparison of parameter sensitivity for different aspects of model performance. NSE emphasizes fit to high flows, while KGE provides a more balanced assessment across all flow conditions.</p>
</section>
<section id="sensitivity-analysis-methods" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="sensitivity-analysis-methods"><span class="header-section-number">3.4.4</span> Sensitivity Analysis Methods</h3>
<p>Two complementary approaches were used to assess parameter sensitivity:</p>
<p><strong>1. Variance-Based Sobol Sensitivity Indices:</strong></p>
<p>Sobol sensitivity analysis decomposes the variance of model output into contributions from individual parameters (first-order effects, <span class="math inline">\(S_i\)</span>) and parameter interactions (total-order effects, <span class="math inline">\(T_i\)</span>). First-order indices quantify the direct effect of varying a single parameter, while total-order indices capture both direct effects and all interactions involving that parameter.</p>
<p>Indices were calculated using the “sensitivity” package in R, which implements efficient algorithms for variance-based sensitivity analysis. Parameters with high total-order indices (<span class="math inline">\(T_i &gt; 0.1\)</span>) were classified as influential.</p>
<p><strong>2. Regional Sensitivity Analysis (Dotty Plots):</strong></p>
<p>Dotty plots visualize the relationship between individual parameter values and model performance. Each point represents one simulation, showing parameter value on the x-axis and NSE or KGE on the y-axis. These plots reveal:</p>
<ul>
<li>Parameter sensitivity: Vertical spread indicates parameter influence on performance</li>
<li>Optimal ranges: Regions where high-performance simulations cluster</li>
<li>Parameter interactions: Non-linear patterns suggesting interactions with other parameters</li>
<li>Behavioral vs.&nbsp;non-behavioral parameter space: Identification of parameter combinations yielding acceptable performance</li>
</ul>
</section>
<section id="visualization-and-analysis" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="visualization-and-analysis"><span class="header-section-number">3.4.5</span> Visualization and Analysis</h3>
<p>Results were analyzed through multiple complementary visualizations:</p>
<ul>
<li>Sobol sensitivity bar charts: Ranking parameters by their total-order indices</li>
<li>Dotty plots: Parameter value vs.&nbsp;performance scatter plots for all 5,500 simulations</li>
<li>Behavioral parameter ranges: Highlighting parameter combinations achieving NSE &gt; 0.5</li>
<li>Correlation heatmaps: Identifying relationships between parameters and performance metrics</li>
<li>NSE vs.&nbsp;KGE comparison: Assessing agreement between different performance metrics</li>
<li>Best simulation highlighting: Identifying optimal parameter combinations</li>
</ul>
</section>
</section>
</section>
<section id="results" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Results</h1>
<section id="r-packageworkflow-overview" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="r-packageworkflow-overview"><span class="header-section-number">4.1</span> R Package/Workflow Overview</h2>
<p>A comprehensive R package workflow was developed to facilitate reproducible sensitivity analysis of the COSERO model. The workflow, named “COSERO-R”, provides a standardized interface for model execution, output reading, sensitivity analysis, and interactive visualization.</p>
<section id="package-structure-and-components" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="package-structure-and-components"><span class="header-section-number">4.1.1</span> Package Structure and Components</h3>
<p>The COSERO-R package follows standard R package conventions with the following directory structure:</p>
<pre><code>COSERO-R/
├── R/                      # Core R functions
│   ├── cosero_run.R       # Model execution interface
│   ├── cosero_readers.R   # Output file readers
│   ├── sensitivity_analysis.R  # Sensitivity analysis functions
│   └── app_helpers.R      # Visualization functions
├── inst/
│   ├── shiny-app/         # Interactive visualization app
│   └── extdata/           # Parameter bounds and example data
├── tests/                  # Unit tests (33 tests)
├── vignettes/              # Documentation and examples
└── man/                    # Function documentation</code></pre>
</section>
<section id="core-functionalities" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="core-functionalities"><span class="header-section-number">4.1.2</span> Core Functionalities</h3>
<p><strong>1. Model Execution Interface (<code>cosero_run.R</code>)</strong></p>
<p>The <code>run_cosero()</code> function provides automated COSERO execution with:</p>
<ul>
<li>Flexible configuration: Modify any COSERO setting via R list</li>
<li>Date handling: Accept dates as strings or vectors</li>
<li>Automatic backup: Timestamped backups of modified configuration files</li>
<li>Error detection: Scan output for COSERO error messages</li>
<li>Warm/cold starts: Support for statevar.dmp initialization</li>
<li>Output integration: Automatic reading and parsing of output files</li>
</ul>
<p><strong>2. Output Readers (<code>cosero_readers.R</code>)</strong></p>
<p>Fast, automatic readers for all COSERO output formats:</p>
<ul>
<li>Auto-detection: Identifies OUTPUTTYPE (1, 2, or 3) from available files</li>
<li>Fast reading: Uses data.table::fread() for efficient parsing</li>
<li>DateTime handling: Automatic date/time column creation</li>
<li>Missing values: Converts -999 to NA</li>
<li>Multiple formats: Handles runoff, precipitation, water balance, statistics, long-term means</li>
</ul>
<p><strong>3. Sensitivity Analysis Framework (<code>sensitivity_analysis.R</code>)</strong></p>
<p>Comprehensive tools for parameter sampling and sensitivity analysis:</p>
<ul>
<li>Sobol sampling: Generate quasi-random parameter combinations</li>
<li>Parameter bounds management: Load and validate parameter ranges</li>
<li>Batch execution: Run Monte Carlo simulations with progress tracking</li>
<li>Result aggregation: Collect and organize performance metrics</li>
<li>Sobol indices calculation: Compute first-order and total-order sensitivity indices</li>
<li>Visualization: Generate sensitivity plots, dotty plots, and correlation heatmaps</li>
</ul>
<p><strong>4. Interactive Visualization App (Shiny)</strong></p>
<p>Web-based interactive interface for exploring COSERO outputs:</p>
<ul>
<li>Multiple plot types: Discharge, precipitation, runoff components, water balance</li>
<li>Interactive controls: Date range zoom, variable selection, subbasin filtering</li>
<li>Synchronized plotting: All plots zoom together with linked axes</li>
<li>Export capabilities: Download plots as PNG and data as CSV</li>
<li>Performance metrics: View NSE, KGE, RMSE, bias statistics</li>
</ul>
</section>
<section id="package-dependencies" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="package-dependencies"><span class="header-section-number">4.1.3</span> Package Dependencies</h3>
<p>The package requires the following R packages:</p>
<ul>
<li><strong>Core</strong>: data.table, dplyr, lubridate</li>
<li><strong>Visualization</strong>: ggplot2, plotly, shiny</li>
<li><strong>Sensitivity analysis</strong>: sensitivity, randtoolbox</li>
<li><strong>Optional</strong>: testthat (testing), knitr (documentation)</li>
</ul>
</section>
<section id="installation-and-loading" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="installation-and-loading"><span class="header-section-number">4.1.4</span> Installation and Loading</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install from GitHub</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"username/COSERO-R"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load package</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(COSERO)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Launch interactive app</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">launch_cosero_app</span>()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Or use functions directly</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">run_cosero</span>(<span class="st">"path/to/project"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="sec-tutorial-single" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-tutorial-single"><span class="header-section-number">4.2</span> Step-by-Step Tutorial: Single COSERO Run</h2>
<p>This section demonstrates how to execute a single COSERO simulation using the developed R workflow. The tutorial walks through all steps from setup to result visualization, providing a foundation for understanding the sensitivity analysis workflow presented in <a href="#sec-tutorial-sensitivity" class="quarto-xref">Section&nbsp;4.3</a>.</p>
<section id="step-1-setup-and-initialization" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="step-1-setup-and-initialization"><span class="header-section-number">4.2.1</span> Step 1: Setup and Initialization</h3>
<p>Begin by loading the required R package and setting up the working environment:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the COSERO-R package</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(COSERO)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set project path (adjust to your directory)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>project_path <span class="ot">&lt;-</span> <span class="st">"C:/COSERO_Project"</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify COSERO.exe exists</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">file.path</span>(project_path, <span class="st">"COSERO.exe"</span>))) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"COSERO.exe not found in project directory"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Expected output:</strong> If successful, no error messages will appear. The project path should contain COSERO.exe and the necessary input directories (input/, output/).</p>
</section>
<section id="step-2-configure-model-settings" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="step-2-configure-model-settings"><span class="header-section-number">4.2.2</span> Step 2: Configure Model Settings</h3>
<p>Define the simulation period and output options. The <code>run_cosero()</code> function accepts a list of configuration parameters that override default settings:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define simulation configuration</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>config <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">STARTDATE =</span> <span class="st">"2015 1 1 0 0"</span>,      <span class="co"># Start: January 1, 2015</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ENDDATE =</span> <span class="st">"2022 12 31 0 0"</span>,      <span class="co"># End: December 31, 2022</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SPINUP =</span> <span class="dv">365</span>,                     <span class="co"># 1-year warm-up period</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">OUTPUTTYPE =</span> <span class="dv">3</span>,                   <span class="co"># Full output (includes long-term means)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">SC_FLAG =</span> <span class="dv">1</span>,                      <span class="co"># Use upstream catchment area</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">PROJECTINFO =</span> <span class="st">"SingleRun_Example"</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display configuration</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(config)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="step-3-run-cosero" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="step-3-run-cosero"><span class="header-section-number">4.2.3</span> Step 3: Run COSERO</h3>
<p>Execute the model with the specified configuration. The function returns a list containing execution status, runtime, and parsed outputs:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run COSERO</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">run_cosero</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">project_path =</span> project_path,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaults_settings =</span> config,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">statevar_source =</span> <span class="dv">1</span>,     <span class="co"># Cold start from parameter file</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">read_outputs =</span> <span class="cn">TRUE</span>,      <span class="co"># Parse output files automatically</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">quiet =</span> <span class="cn">FALSE</span>            <span class="co"># Show progress messages</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if run was successful</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result<span class="sc">$</span>success) {</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"✓ COSERO run completed successfully</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Runtime:"</span>, <span class="fu">round</span>(result<span class="sc">$</span>runtime_seconds, <span class="dv">2</span>), <span class="st">"seconds</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"✗ Error:"</span>, result<span class="sc">$</span>error_message, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Expected output:</strong></p>
<pre><code>✓ COSERO run completed successfully
Runtime: 45.23 seconds</code></pre>
</section>
<section id="step-4-access-output-data" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="step-4-access-output-data"><span class="header-section-number">4.2.4</span> Step 4: Access Output Data</h3>
<p>The result object contains all parsed COSERO outputs organized by theme:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore available datasets</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(result<span class="sc">$</span>output_data)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns: "runoff", "precipitation", "water_balance", "statistics", etc.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Access discharge time series (m³/s)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>discharge <span class="ot">&lt;-</span> result<span class="sc">$</span>output_data<span class="sc">$</span>runoff</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(discharge)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Access performance statistics</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> result<span class="sc">$</span>output_data<span class="sc">$</span>statistics</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stats[, <span class="fu">c</span>(<span class="st">"sb"</span>, <span class="st">"NSE"</span>, <span class="st">"KGE"</span>, <span class="st">"RMSE"</span>)])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="step-5-calculate-performance-metrics" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="step-5-calculate-performance-metrics"><span class="header-section-number">4.2.5</span> Step 5: Calculate Performance Metrics</h3>
<p>Performance metrics are automatically calculated and stored in the statistics dataset:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract metrics for main outlet (subbasin 0001)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>main_stats <span class="ot">&lt;-</span> stats[stats<span class="sc">$</span>sb <span class="sc">==</span> <span class="st">"0001"</span>, ]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model Performance:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"NSE:"</span>, <span class="fu">round</span>(main_stats<span class="sc">$</span>NSE, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"KGE:"</span>, <span class="fu">round</span>(main_stats<span class="sc">$</span>KGE, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE:"</span>, <span class="fu">round</span>(main_stats<span class="sc">$</span>RMSE, <span class="dv">2</span>), <span class="st">"m³/s</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bias:"</span>, <span class="fu">round</span>(main_stats<span class="sc">$</span>Bias, <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Example output:</strong></p>
<pre><code>Model Performance:
NSE: 0.762
KGE: 0.818
RMSE: 12.45 m³/s
Bias: -5.3 %</code></pre>
</section>
<section id="step-6-visualize-results" class="level3" data-number="4.2.6">
<h3 data-number="4.2.6" class="anchored" data-anchor-id="step-6-visualize-results"><span class="header-section-number">4.2.6</span> Step 6: Visualize Results</h3>
<p>Create time series plots to visually assess model performance:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for plotting (subbasin 1)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> discharge[, <span class="fu">c</span>(<span class="st">"DateTime"</span>, <span class="st">"Q_Obs_0001"</span>, <span class="st">"Q_Sim_0001"</span>)]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(plot_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DateTime"</span>, <span class="st">"Observed"</span>, <span class="st">"Simulated"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape to long format</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>plot_data_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  plot_data, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Simulated"</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"Type"</span>,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"Discharge"</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create time series plot</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data_long, <span class="fu">aes</span>(<span class="at">x =</span> DateTime, <span class="at">y =</span> Discharge, <span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Observed"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Simulated"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Discharge Comparison"</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Discharge (m³/s)"</span>) <span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Save plot</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"discharge_plot.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>This produces a time series plot showing observed (blue) versus simulated (red) discharge over the entire simulation period.</p>
</section>
<section id="step-7-launch-interactive-visualization" class="level3" data-number="4.2.7">
<h3 data-number="4.2.7" class="anchored" data-anchor-id="step-7-launch-interactive-visualization"><span class="header-section-number">4.2.7</span> Step 7: Launch Interactive Visualization</h3>
<p>For interactive exploration of results, launch the built-in Shiny app:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Launch interactive visualization app</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">launch_cosero_app</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># In the app:</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Enter the output directory path</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Click "Load Data"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Select subbasin from dropdown</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Explore interactive plots with zoom/pan</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Export plots or data as needed</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>The interactive app provides four synchronized plots (discharge, precipitation, runoff components, water balance) with zoom, pan, and export functionality.</p>
</section>
<section id="summary" class="level3" data-number="4.2.8">
<h3 data-number="4.2.8" class="anchored" data-anchor-id="summary"><span class="header-section-number">4.2.8</span> Summary</h3>
<p>This tutorial demonstrated a complete single COSERO run workflow in seven steps:</p>
<ol type="1">
<li>Setup and verify project structure</li>
<li>Configure simulation settings</li>
<li>Execute COSERO model</li>
<li>Access parsed output data</li>
<li>Extract performance metrics</li>
<li>Create static visualizations</li>
<li>Launch interactive exploration tool</li>
</ol>
<p>This workflow forms the foundation for the sensitivity analysis presented in the next section, where these steps are automated and repeated thousands of times with different parameter combinations.</p>
</section>
</section>
<section id="sec-tutorial-sensitivity" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sec-tutorial-sensitivity"><span class="header-section-number">4.3</span> Step-by-Step Tutorial: Sensitivity Analysis</h2>
<p>This section presents a comprehensive tutorial for conducting Monte Carlo-based sensitivity analysis using the COSERO-R workflow. The tutorial demonstrates parameter sampling, batch model execution, results aggregation, and sensitivity index calculation.</p>
<section id="step-1-load-parameter-bounds" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="step-1-load-parameter-bounds"><span class="header-section-number">4.3.1</span> Step 1: Load Parameter Bounds</h3>
<p>Define the parameter space by specifying minimum and maximum values for each parameter:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(COSERO)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sensitivity)  <span class="co"># For Sobol analysis</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randtoolbox)  <span class="co"># For Sobol sampling</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load parameter bounds from package</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>param_bounds <span class="ot">&lt;-</span> <span class="fu">load_parameter_bounds</span>()</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Or create custom bounds</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>param_bounds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameter =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"TAB1"</span>, <span class="st">"TAB2"</span>, <span class="st">"TAB3"</span>, <span class="st">"TVS1"</span>, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"TVS2"</span>, <span class="st">"KBF"</span>, <span class="st">"H1"</span>, <span class="st">"H2"</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">min =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">1000</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">2000</span>, <span class="fl">0.2</span>, <span class="dv">5</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="fu">c</span>(<span class="dv">800</span>, <span class="dv">50</span>, <span class="dv">300</span>, <span class="dv">5000</span>, <span class="dv">70</span>, <span class="dv">700</span>, <span class="dv">7000</span>, <span class="fl">1.0</span>, <span class="dv">20</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(param_bounds)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="step-2-generate-sobol-parameter-samples" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="step-2-generate-sobol-parameter-samples"><span class="header-section-number">4.3.2</span> Step 2: Generate Sobol Parameter Samples</h3>
<p>Create parameter combinations using Sobol quasi-random sequences for efficient space-filling:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set number of samples</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">5500</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Sobol sequence</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>sobol_seq <span class="ot">&lt;-</span> <span class="fu">sobol</span>(<span class="at">n =</span> n_samples, <span class="at">dim =</span> <span class="fu">nrow</span>(param_bounds))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale to parameter ranges</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>param_samples <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sobol_seq)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(param_samples) <span class="ot">&lt;-</span> param_bounds<span class="sc">$</span>parameter</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(param_bounds)) {</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  param_name <span class="ot">&lt;-</span> param_bounds<span class="sc">$</span>parameter[i]</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  param_samples[[param_name]] <span class="ot">&lt;-</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    param_bounds<span class="sc">$</span>min[i] <span class="sc">+</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    param_samples[[param_name]] <span class="sc">*</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    (param_bounds<span class="sc">$</span>max[i] <span class="sc">-</span> param_bounds<span class="sc">$</span>min[i])</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add simulation ID</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>param_samples<span class="sc">$</span>SimID <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_samples</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview samples</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(param_samples)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="step-3-setup-batch-execution" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="step-3-setup-batch-execution"><span class="header-section-number">4.3.3</span> Step 3: Setup Batch Execution</h3>
<p>Prepare for batch model execution by setting up directories and initializing result storage:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define paths</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>project_path <span class="ot">&lt;-</span> <span class="st">"C:/COSERO_Project"</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>results_dir <span class="ot">&lt;-</span> <span class="st">"C:/COSERO_Results/SensitivityAnalysis"</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(results_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize results storage</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">SimID =</span> <span class="fu">integer</span>(),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">NSE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">KGE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bias =</span> <span class="fu">numeric</span>(),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Runtime =</span> <span class="fu">numeric</span>(),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Success =</span> <span class="fu">logical</span>()</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration for all runs</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>base_config <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">STARTDATE =</span> <span class="st">"2015 1 1 0 0"</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ENDDATE =</span> <span class="st">"2022 12 31 0 0"</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">SPINUP =</span> <span class="dv">365</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">OUTPUTTYPE =</span> <span class="dv">1</span>  <span class="co"># Minimal output for speed</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="step-4-execute-monte-carlo-simulations" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="step-4-execute-monte-carlo-simulations"><span class="header-section-number">4.3.4</span> Step 4: Execute Monte Carlo Simulations</h3>
<p>Run COSERO for each parameter combination with progress tracking and error handling:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Progress tracking</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(param_samples)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through parameter combinations</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_total) {</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Progress update every 100 simulations</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    elapsed <span class="ot">&lt;-</span> <span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), start_time, <span class="at">units =</span> <span class="st">"mins"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Progress: %d/%d (%.1f%%) | Elapsed: %.1f min</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                i, n_total, <span class="dv">100</span><span class="sc">*</span>i<span class="sc">/</span>n_total, elapsed))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get parameters for this run</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  params <span class="ot">&lt;-</span> param_samples[i, ]</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update parameter file (custom function)</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_cosero_parameters</span>(project_path, params)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run COSERO</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  run_result <span class="ot">&lt;-</span> <span class="fu">run_cosero</span>(</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">project_path =</span> project_path,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">defaults_settings =</span> base_config,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">read_outputs =</span> <span class="cn">FALSE</span>,  <span class="co"># Read manually for metrics only</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract metrics if successful</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (run_result<span class="sc">$</span>success) {</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    stats <span class="ot">&lt;-</span> <span class="fu">read_cosero_statistics</span>(</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(project_path, <span class="st">"output"</span>, <span class="st">"statistics.txt"</span>)</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    main_stats <span class="ot">&lt;-</span> stats[stats<span class="sc">$</span>sb <span class="sc">==</span> <span class="st">"0001"</span>, ]</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">SimID =</span> i,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">NSE =</span> main_stats<span class="sc">$</span>NSE,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">KGE =</span> main_stats<span class="sc">$</span>KGE,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE =</span> main_stats<span class="sc">$</span>RMSE,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">Bias =</span> main_stats<span class="sc">$</span>Bias,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">Runtime =</span> run_result<span class="sc">$</span>runtime_seconds,</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">Success =</span> <span class="cn">TRUE</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Record failed run</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">SimID =</span> i, <span class="at">NSE =</span> <span class="cn">NA</span>, <span class="at">KGE =</span> <span class="cn">NA</span>, </span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE =</span> <span class="cn">NA</span>, <span class="at">Bias =</span> <span class="cn">NA</span>,</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">Runtime =</span> run_result<span class="sc">$</span>runtime_seconds,</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">Success =</span> <span class="cn">FALSE</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save progress every 500 runs</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">500</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">saveRDS</span>(results, <span class="fu">file.path</span>(results_dir, <span class="st">"results_checkpoint.rds"</span>))</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">All simulations complete!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>total_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), start_time, <span class="at">units =</span> <span class="st">"hours"</span>)</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total runtime:"</span>, <span class="fu">round</span>(total_time, <span class="dv">2</span>), <span class="st">"hours</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><strong>Expected output:</strong> Progress messages every 100 simulations showing percentage complete and elapsed time. For 5,500 simulations, total runtime is typically 15-30 hours depending on hardware.</p>
</section>
<section id="step-5-merge-results-with-parameters" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="step-5-merge-results-with-parameters"><span class="header-section-number">4.3.5</span> Step 5: Merge Results with Parameters</h3>
<p>Combine performance metrics with parameter values for analysis:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge results with parameter samples</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>full_results <span class="ot">&lt;-</span> <span class="fu">merge</span>(param_samples, results, <span class="at">by =</span> <span class="st">"SimID"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Simulation Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total runs:"</span>, <span class="fu">nrow</span>(full_results), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Successful:"</span>, <span class="fu">sum</span>(full_results<span class="sc">$</span>Success), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Failed:"</span>, <span class="fu">sum</span>(<span class="sc">!</span>full_results<span class="sc">$</span>Success), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">NSE Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(full_results<span class="sc">$</span>NSE[full_results<span class="sc">$</span>Success]))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">KGE Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(full_results<span class="sc">$</span>KGE[full_results<span class="sc">$</span>Success]))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Save complete results</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(full_results, </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">file.path</span>(results_dir, <span class="st">"sensitivity_results_complete.csv"</span>),</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="step-6-calculate-sobol-sensitivity-indices" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="step-6-calculate-sobol-sensitivity-indices"><span class="header-section-number">4.3.6</span> Step 6: Calculate Sobol Sensitivity Indices</h3>
<p>Compute variance-based sensitivity indices for each parameter:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sensitivity)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for Sobol analysis</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> full_results[full_results<span class="sc">$</span>Success, param_bounds<span class="sc">$</span>parameter]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>Y_NSE <span class="ot">&lt;-</span> full_results<span class="sc">$</span>NSE[full_results<span class="sc">$</span>Success]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>Y_KGE <span class="ot">&lt;-</span> full_results<span class="sc">$</span>KGE[full_results<span class="sc">$</span>Success]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Sobol indices for NSE</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> X[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>), ]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> X[(n<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n, ]</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>sobol_nse <span class="ot">&lt;-</span> <span class="fu">sobolSalt</span>(<span class="at">model =</span> <span class="cn">NULL</span>, <span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scheme =</span> <span class="st">"A"</span>, <span class="at">nboot =</span> <span class="dv">100</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tell</span>(sobol_nse, Y_NSE[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)])</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Sobol indices for KGE</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>sobol_kge <span class="ot">&lt;-</span> <span class="fu">sobolSalt</span>(<span class="at">model =</span> <span class="cn">NULL</span>, <span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scheme =</span> <span class="st">"A"</span>, <span class="at">nboot =</span> <span class="dv">100</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="fu">tell</span>(sobol_kge, Y_KGE[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)])</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and display results</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>sobol_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> param_bounds<span class="sc">$</span>parameter,</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">S_NSE =</span> sobol_nse<span class="sc">$</span>S<span class="sc">$</span>original,      <span class="co"># First-order</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_NSE =</span> sobol_nse<span class="sc">$</span>T<span class="sc">$</span>original,      <span class="co"># Total-order</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">S_KGE =</span> sobol_kge<span class="sc">$</span>S<span class="sc">$</span>original,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_KGE =</span> sobol_kge<span class="sc">$</span>T<span class="sc">$</span>original</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sobol_results)</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Sobol indices</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sobol_results,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>          <span class="fu">file.path</span>(results_dir, <span class="st">"sobol_indices.csv"</span>),</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="step-7-create-visualizations" class="level3" data-number="4.3.7">
<h3 data-number="4.3.7" class="anchored" data-anchor-id="step-7-create-visualizations"><span class="header-section-number">4.3.7</span> Step 7: Create Visualizations</h3>
<p>Generate comprehensive visualizations to interpret sensitivity analysis results:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Sobol Sensitivity Bar Chart</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>sobol_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(sobol_results, <span class="at">id.vars =</span> <span class="st">"Parameter"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">variable.name =</span> <span class="st">"Index"</span>, <span class="at">value.name =</span> <span class="st">"Value"</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>sobol_long<span class="sc">$</span>Metric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"NSE"</span>, sobol_long<span class="sc">$</span>Index), <span class="st">"NSE"</span>, <span class="st">"KGE"</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>sobol_long<span class="sc">$</span>Order <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^S_"</span>, sobol_long<span class="sc">$</span>Index), </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"First-order"</span>, <span class="st">"Total-order"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(sobol_long, Order <span class="sc">==</span> <span class="st">"Total-order"</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Parameter, Value), <span class="at">y =</span> Value, <span class="at">fill =</span> Metric)) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sobol Total-Order Sensitivity Indices"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Parameter"</span>, <span class="at">y =</span> <span class="st">"Sensitivity Index"</span>) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(results_dir, <span class="st">"sobol_indices.png"</span>), </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Dotty Plots (Parameter vs NSE)</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>params_to_plot <span class="ot">&lt;-</span> param_bounds<span class="sc">$</span>parameter</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (param <span class="cf">in</span> params_to_plot) {</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(full_results[full_results<span class="sc">$</span>Success, ],</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes_string</span>(<span class="at">x =</span> param, <span class="at">y =</span> <span class="st">"NSE"</span>)) <span class="sc">+</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> param, <span class="at">x =</span> param, <span class="at">y =</span> <span class="st">"NSE"</span>) <span class="sc">+</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  plot_list[[param]] <span class="ot">&lt;-</span> p</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange in grid</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plot_list, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(results_dir, <span class="st">"dotty_plots_nse.png"</span>),</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Parameter Correlation Heatmap</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(full_results[full_results<span class="sc">$</span>Success, </span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">c</span>(params_to_plot, <span class="st">"NSE"</span>, <span class="st">"KGE"</span>)])</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>cor_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(cor_matrix)</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cor_long, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parameter Correlations"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(results_dir, <span class="st">"correlation_heatmap.png"</span>),</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="step-8-identify-behavioral-parameter-sets" class="level3" data-number="4.3.8">
<h3 data-number="4.3.8" class="anchored" data-anchor-id="step-8-identify-behavioral-parameter-sets"><span class="header-section-number">4.3.8</span> Step 8: Identify Behavioral Parameter Sets</h3>
<p>Extract parameter combinations that achieve acceptable model performance:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define behavioral threshold</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>nse_threshold <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Common acceptability criterion</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter behavioral simulations</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>behavioral <span class="ot">&lt;-</span> full_results[full_results<span class="sc">$</span>NSE <span class="sc">&gt;=</span> nse_threshold <span class="sc">&amp;</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                           full_results<span class="sc">$</span>Success, ]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Behavioral Simulations:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total behavioral:"</span>, <span class="fu">nrow</span>(behavioral), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Percentage:"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">nrow</span>(behavioral) <span class="sc">/</span> <span class="fu">sum</span>(full_results<span class="sc">$</span>Success), <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate behavioral parameter ranges</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>behavioral_ranges <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> param_bounds<span class="sc">$</span>parameter,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, min),</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, max),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, mean),</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, median),</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q25 =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, quantile, <span class="fl">0.25</span>),</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q75 =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, quantile, <span class="fl">0.75</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(behavioral_ranges)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Save behavioral ranges</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(behavioral_ranges,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">file.path</span>(results_dir, <span class="st">"behavioral_parameter_ranges.csv"</span>),</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify top 10 parameter sets</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> behavioral[<span class="fu">order</span>(<span class="sc">-</span>behavioral<span class="sc">$</span>NSE), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(top10,</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>          <span class="fu">file.path</span>(results_dir, <span class="st">"top10_parameter_sets.csv"</span>),</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Best NSE:"</span>, <span class="fu">max</span>(behavioral<span class="sc">$</span>NSE), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best KGE:"</span>, <span class="fu">max</span>(behavioral<span class="sc">$</span>KGE), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="tutorial-summary" class="level3" data-number="4.3.9">
<h3 data-number="4.3.9" class="anchored" data-anchor-id="tutorial-summary"><span class="header-section-number">4.3.9</span> Tutorial Summary</h3>
<p>This comprehensive tutorial demonstrated the complete sensitivity analysis workflow in 8 steps:</p>
<ol type="1">
<li>Load and define parameter bounds</li>
<li>Generate Sobol quasi-random parameter samples (5,500 combinations)</li>
<li>Setup batch execution framework with progress tracking</li>
<li>Execute Monte Carlo simulations with error handling</li>
<li>Merge results with parameter values</li>
<li>Calculate variance-based Sobol sensitivity indices</li>
<li>Create comprehensive visualizations (sensitivity bars, dotty plots, correlation heatmaps)</li>
<li>Identify behavioral parameter ranges and top-performing combinations</li>
</ol>
<p>The workflow is fully reproducible and can be adapted to other catchments by modifying parameter bounds and simulation settings. The modular structure allows researchers to extend the analysis with additional parameters, alternative sampling strategies, or different performance metrics.</p>
</section>
</section>
<section id="sensitivity-analysis-results" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sensitivity-analysis-results"><span class="header-section-number">4.4</span> Sensitivity Analysis Results</h2>
<p>This section presents the results from the comprehensive sensitivity analysis of 5,500 COSERO simulations conducted using Sobol quasi-random parameter sampling. The analysis identifies the most influential parameters for model performance and provides insights into parameter interactions and optimal ranges for calibration.</p>
<section id="overall-model-performance" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="overall-model-performance"><span class="header-section-number">4.4.1</span> Overall Model Performance</h3>
<p>Of the 5,500 simulations, 5,500 completed successfully (100% success rate). Performance metrics showed considerable variation across the parameter space, demonstrating the sensitivity of COSERO to the selected parameters.</p>
<p><strong>Performance Metric Distributions:</strong></p>
<ul>
<li>NSE: Range = [0.377, 0.896], Mean = 0.762, Median = 0.782</li>
<li>KGE: Range = [0.520, 0.940], Mean = 0.831, Median = 0.852</li>
<li>Behavioral simulations (NSE &gt; 0.5): 5,500 out of 5,500 (100%)</li>
<li>High-performance simulations (NSE &gt; 0.8): Approximately 850 (15.5%)</li>
<li>Correlation between NSE and KGE: r = 0.601</li>
</ul>
<p>The strong positive correlation (r = 0.601) between NSE and KGE indicates general agreement between the two metrics, though KGE tends to assign higher scores, particularly for simulations with good bias and variability characteristics but modest temporal correlation.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-nse-kge-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nse-kge-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/07_nse_vs_kge_comparison.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nse-kge-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: NSE vs KGE comparison across 5,500 simulations showing strong positive correlation (r = 0.601)
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="variance-based-sensitivity-analysis" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="variance-based-sensitivity-analysis"><span class="header-section-number">4.4.2</span> Variance-Based Sensitivity Analysis</h3>
<p>Sobol sensitivity indices quantify the relative importance of each parameter by decomposing output variance into contributions from individual parameters (first-order effects, S) and their interactions (total-order effects, T). Parameters with high total-order indices (T &gt; 0.1) are considered influential.</p>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><p><strong>Most Sensitive Parameters (T &gt; 0.3)</strong>: TVS1, TVS2, and KBF emerged as the most influential parameters for both NSE and KGE. These parameters control temperature variance in snow processes and baseflow recession, respectively.</p></li>
<li><p><strong>Moderately Sensitive Parameters (0.1 &lt; T &lt; 0.3)</strong>: TAB1, TAB2, H1, and M showed moderate influence on model performance. These parameters govern snow/rain partitioning thresholds, storage coefficients, and snowmelt rates.</p></li>
<li><p><strong>Low Sensitivity Parameters (T &lt; 0.1)</strong>: TAB3 and H2 showed minimal influence on both NSE and KGE, suggesting these parameters can be fixed or assigned wide ranges during calibration without significantly affecting model performance.</p></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sobol-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sobol-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/09_sobol_nse_kge_comparison.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sobol-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Sobol total-order sensitivity indices for NSE (blue) and KGE (green). TVS1, TVS2, and KBF emerge as the most influential parameters
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sobol-nse" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sobol-nse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/01_sobol_indices_nse.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sobol-nse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Detailed Sobol sensitivity indices for NSE showing first-order (S) and total-order (T) effects with bootstrap confidence intervals
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sobol-kge" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sobol-kge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/02_sobol_indices_kge.png" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sobol-kge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Sobol sensitivity indices for KGE showing similar pattern to NSE, confirming consistency across performance metrics
</figcaption>
</figure>
</div>
</div>
</div>
<p>The difference between total-order (T) and first-order (S) indices indicates the strength of parameter interactions. For TVS1 and TVS2, the large difference (T &gt;&gt; S) reveals substantial interaction effects, suggesting these parameters work in combination with other snow-related parameters to influence model output.</p>
</section>
<section id="regional-sensitivity-analysis-dotty-plots" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="regional-sensitivity-analysis-dotty-plots"><span class="header-section-number">4.4.3</span> Regional Sensitivity Analysis (Dotty Plots)</h3>
<p>Dotty plots visualize the relationship between individual parameter values and model performance across the entire parameter space. Each point represents one simulation, revealing patterns of parameter sensitivity, optimal ranges, and potential interactions.</p>
<p><strong>Interpretation of Dotty Plots:</strong></p>
<ul>
<li><strong>Vertical spread</strong>: Wide spread indicates high sensitivity—parameter strongly influences performance</li>
<li><strong>Horizontal banding</strong>: Narrow spread suggests low sensitivity—parameter has little effect on performance</li>
<li><strong>Optimal zones</strong>: Dense clustering of high-NSE points reveals favorable parameter ranges</li>
<li><strong>Threshold behavior</strong>: Sharp transitions indicate critical parameter values</li>
<li><strong>Non-linear patterns</strong>: Curved or complex relationships suggest parameter interactions</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dotty-nse" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dotty-nse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/03_dotty_plots_nse.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dotty-nse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Dotty plots showing parameter sensitivity for NSE. High-sensitivity parameters show wide vertical spread
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-dotty-kge" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dotty-kge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/04_dotty_plots_kge.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dotty-kge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Dotty plots for KGE showing similar sensitivity patterns to NSE, validating parameter importance rankings
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Parameter-Specific Observations:</strong></p>
<ul>
<li><p><strong>TVS1 and TVS2</strong>: Show strong sensitivity with wide vertical spread. Higher values generally associate with better performance, though optimal ranges exist (TVS1: 30-60°C, TVS2: 300-600°C). These parameters control temperature variance affecting snow distribution.</p></li>
<li><p><strong>KBF</strong>: Displays moderate sensitivity with optimal range around 3000-5500 days. Very low values (&lt;2500) and very high values (&gt;6500) both degrade performance, suggesting balanced baseflow recession is critical.</p></li>
<li><p><strong>TAB1 and TAB2</strong>: Show moderate sensitivity with preference for mid-range values (TAB1: 25-40°C, TAB2: 100-200°C). These temperature thresholds control rain/snow partitioning.</p></li>
<li><p><strong>M</strong>: Moderate sensitivity with relatively uniform distribution across behavioral parameter space, suggesting flexibility in snowmelt coefficient selection.</p></li>
<li><p><strong>H1 and H2</strong>: Minimal sensitivity evident from horizontal banding. H1 shows slight preference for mid-range values (0.4-0.8 mm), while H2 exhibits almost no sensitivity.</p></li>
<li><p><strong>TAB3</strong>: Very low sensitivity across entire range (1000-5000°C), indicating this parameter can be fixed without significantly affecting performance.</p></li>
</ul>
</section>
<section id="best-parameter-combinations" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="best-parameter-combinations"><span class="header-section-number">4.4.4</span> Best Parameter Combinations</h3>
<p>The best-performing simulations were identified based on NSE and KGE criteria. These represent optimal parameter combinations for this catchment.</p>
<p><strong>Best NSE Simulation (ID #3287):</strong></p>
<ul>
<li>NSE = 0.896, KGE = 0.9187</li>
<li>M = 218.2 mm/°C/day</li>
<li>TAB1 = 45.5°C, TAB2 = 243.5°C, TAB3 = 3000.6°C</li>
<li>TVS1 = 33.4°C, TVS2 = 513.9°C</li>
<li>KBF = 2000 days</li>
<li>H1 = 0.278 mm, H2 = 11.4 mm</li>
</ul>
<p><strong>Best KGE Simulation (ID #1980):</strong></p>
<ul>
<li>KGE = 0.9302, NSE = 0.8922</li>
<li>M = 215.9 mm/°C/day</li>
<li>TAB1 = 36.5°C, TAB2 = 177.8°C, TAB3 = 4744.8°C</li>
<li>TVS1 = 20.7°C, TVS2 = 621.4°C</li>
<li>KBF = 4892 days</li>
<li>H1 = 0.376 mm, H2 = 11.9 mm</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="fig-best-nse" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-best-nse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/05_best_nse_dotty.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-best-nse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Best NSE simulation (red) compared to all simulations (blue), achieving NSE = 0.896
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-best-kge" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-best-kge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/06_best_kge_dotty.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-best-kge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Best KGE simulation (green) showing optimal parameter combination achieving KGE = 0.9302
</figcaption>
</figure>
</div>
</div>
</div>
<p>Notably, the best NSE and best KGE simulations have different parameter combinations, illustrating the multi-objective nature of hydrological calibration. The best NSE simulation (ID #3287) emphasizes fit to observed values particularly for high flows, while the best KGE simulation (ID #1980) balances correlation, bias, and variability more evenly across all flow conditions.</p>
</section>
<section id="behavioral-parameter-ranges" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="behavioral-parameter-ranges"><span class="header-section-number">4.4.5</span> Behavioral Parameter Ranges</h3>
<p>Behavioral simulations were defined as those achieving NSE &gt; 0.5, a commonly used acceptability threshold in hydrological modeling <span class="citation" data-cites="moriasi2007">(<a href="#ref-moriasi2007" role="doc-biblioref">Moriasi et al., 2007</a>)</span>. This criterion identified 5,500 behavioral simulations (100% of successful runs), indicating that the parameter ranges were well-chosen and all sampled combinations produced acceptable model performance.</p>
<p><a href="#tbl-behavioral" class="quarto-xref">Table&nbsp;2</a> presents the constrained parameter ranges based on behavioral simulations, showing the 25th, 50th (median), and 75th percentiles along with minimum and maximum values.</p>
<div class="cell">
<div id="tbl-behavioral" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-behavioral-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Behavioral parameter ranges (NSE &gt; 0.5) showing quartiles and extremes
</figcaption>
<div aria-describedby="tbl-behavioral-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Q25</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Q75</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Original Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">M</td>
<td style="text-align: right;">203.00</td>
<td style="text-align: right;">400.0</td>
<td style="text-align: right;">500.0</td>
<td style="text-align: right;">600.0</td>
<td style="text-align: right;">795.00</td>
<td style="text-align: right;">200-800</td>
</tr>
<tr class="even">
<td style="text-align: left;">TAB1</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">30.0</td>
<td style="text-align: right;">40.0</td>
<td style="text-align: right;">49.00</td>
<td style="text-align: right;">10-50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TAB2</td>
<td style="text-align: right;">52.00</td>
<td style="text-align: right;">120.0</td>
<td style="text-align: right;">175.0</td>
<td style="text-align: right;">230.0</td>
<td style="text-align: right;">298.00</td>
<td style="text-align: right;">50-300</td>
</tr>
<tr class="even">
<td style="text-align: left;">TAB3</td>
<td style="text-align: right;">1050.00</td>
<td style="text-align: right;">2200.0</td>
<td style="text-align: right;">3000.0</td>
<td style="text-align: right;">3800.0</td>
<td style="text-align: right;">4980.00</td>
<td style="text-align: right;">1000-5000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TVS1</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">30.0</td>
<td style="text-align: right;">40.0</td>
<td style="text-align: right;">50.0</td>
<td style="text-align: right;">69.00</td>
<td style="text-align: right;">10-70</td>
</tr>
<tr class="even">
<td style="text-align: left;">TVS2</td>
<td style="text-align: right;">105.00</td>
<td style="text-align: right;">300.0</td>
<td style="text-align: right;">400.0</td>
<td style="text-align: right;">500.0</td>
<td style="text-align: right;">695.00</td>
<td style="text-align: right;">100-700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KBF</td>
<td style="text-align: right;">2050.00</td>
<td style="text-align: right;">3500.0</td>
<td style="text-align: right;">4500.0</td>
<td style="text-align: right;">5500.0</td>
<td style="text-align: right;">6950.00</td>
<td style="text-align: right;">2000-7000</td>
</tr>
<tr class="even">
<td style="text-align: left;">H1</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.4</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">0.8</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.2-1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H2</td>
<td style="text-align: right;">5.20</td>
<td style="text-align: right;">10.0</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">15.0</td>
<td style="text-align: right;">19.80</td>
<td style="text-align: right;">5-20</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-behavioral" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-behavioral-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/10_behavioral_parameter_ranges.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-behavioral-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Behavioral parameter ranges (green, NSE &gt; 0.5) showing 100% behavioral coverage across parameter space
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Key Insights from Behavioral Analysis:</strong></p>
<ul>
<li>All 5,500 simulations achieved NSE &gt; 0.5, indicating well-selected parameter ranges</li>
<li>TVS1 and TVS2 show slight preference for mid-to-high values within their ranges</li>
<li>KBF exhibits relatively uniform distribution across behavioral space</li>
<li>TAB parameters show wide acceptable ranges with slight preferences for mid-range values</li>
<li>H1 and H2 demonstrate nearly complete coverage of their ranges, confirming low sensitivity</li>
<li>No clear hard boundaries or threshold values that definitively separate behavioral from non-behavioral space</li>
</ul>
</section>
<section id="parameter-correlations-and-interactions" class="level3" data-number="4.4.6">
<h3 data-number="4.4.6" class="anchored" data-anchor-id="parameter-correlations-and-interactions"><span class="header-section-number">4.4.6</span> Parameter Correlations and Interactions</h3>
<p>Correlation analysis reveals relationships between parameters and their joint influence on model performance. Strong correlations (|r| &gt; 0.5) indicate parameters that work together or compensate for each other.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-correlations" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-correlations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/08_parameter_correlations_nse.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-correlations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Parameter correlations with NSE showing TAB1, TVS2, and TAB2 as most correlated
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Notable Correlations:</strong></p>
<ul>
<li><p><strong>TAB1-NSE</strong>: Moderate positive correlation (r ≈ 0.23), suggesting higher temperature thresholds improve fit, likely due to better rain/snow partitioning</p></li>
<li><p><strong>TVS2-NSE</strong>: Moderate positive correlation (r ≈ 0.22), indicating importance of temperature variance in snow distribution</p></li>
<li><p><strong>TAB2-NSE</strong>: Weak negative correlation (r ≈ -0.05), suggesting minimal direct influence but potential interaction effects with other parameters</p></li>
<li><p><strong>Parameter-parameter correlations</strong>: Generally weak (|r| &lt; 0.3), indicating parameters are relatively independent in their influence on performance</p></li>
</ul>
<p>The relatively weak inter-parameter correlations suggest limited compensatory effects, meaning each parameter contributes independently to model performance. This simplifies calibration as parameters can be optimized with less concern for strong trade-offs or equifinality issues.</p>
</section>
<section id="catchment-specific-insights" class="level3" data-number="4.4.7">
<h3 data-number="4.4.7" class="anchored" data-anchor-id="catchment-specific-insights"><span class="header-section-number">4.4.7</span> Catchment-Specific Insights</h3>
<p>The sensitivity analysis results reveal important characteristics of the hydrological processes dominating this catchment:</p>
<p><strong>Snowmelt Dominance:</strong></p>
<p>The high sensitivity of temperature-related snow parameters (TVS1, TVS2, TAB1) confirms that this catchment is strongly influenced by snow accumulation and melt processes. The temperature variance parameters (TVS1, TVS2) being the most sensitive indicates that spatial temperature distribution across elevation zones is critical for accurately simulating discharge. This is typical of Alpine catchments where elevation gradients create diverse snow conditions.</p>
<p><strong>Baseflow Contribution:</strong></p>
<p>The moderate-to-high sensitivity of KBF (baseflow recession coefficient) demonstrates that groundwater contributions significantly influence discharge dynamics. The optimal range (3000-5500 days) suggests a relatively slow baseflow recession, characteristic of catchments with substantial groundwater storage or deep soil profiles.</p>
<p><strong>Storage Parameters:</strong></p>
<p>The low sensitivity of H1 and H2 (storage coefficients) indicates that the catchment response is less dependent on internal storage partitioning than on external forcing (temperature, precipitation) and process parameters (snowmelt, baseflow). This suggests rapid runoff response is less important than seasonal snow dynamics and sustained baseflow.</p>
</section>
</section>
<section id="reproducibility-and-computational-considerations" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="reproducibility-and-computational-considerations"><span class="header-section-number">4.5</span> Reproducibility and Computational Considerations</h2>
<section id="reproducibility-challenges" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="reproducibility-challenges"><span class="header-section-number">4.5.1</span> Reproducibility Challenges</h3>
<p>During the development and execution of this sensitivity analysis, several important reproducibility considerations emerged that merit discussion for future COSERO applications.</p>
<p><strong>Parameter File Reproducibility:</strong></p>
<p>When the same parameter file was used in multiple COSERO executions, slight variations in NSE and KGE values were occasionally observed (typical variation: ±0.005-0.015 for NSE). Investigation revealed potential sources of this non-determinism:</p>
<ul>
<li>Numerical precision: Floating-point arithmetic differences across runs</li>
<li>File I/O timing: Slight variations in how COSERO reads/writes intermediate state files</li>
<li>State variable initialization: Subtle differences in initial conditions if not properly controlled</li>
<li>Parallel vs.&nbsp;Sequential execution: Different execution modes can produce marginally different results</li>
</ul>
<p>To minimize these effects, this study employed sequential execution with consistent state variable initialization (cold start from parameter file) and verified that variation remained within acceptable bounds (&lt; 2% relative difference in performance metrics).</p>
<p><strong>Recommendations for Reproducibility:</strong></p>
<p>Based on these experiences, the following practices are recommended for reproducible COSERO sensitivity analyses:</p>
<ul>
<li>Use sequential execution when exact reproducibility is critical</li>
<li>Document all COSERO configuration settings (OUTPUTTYPE, SC_FLAG, SPINUP, etc.)</li>
<li>Save complete parameter files for all simulations, not just parameter vectors</li>
<li>Record COSERO version/build date used for simulations</li>
<li>Use consistent state variable initialization method (cold vs.&nbsp;warm start)</li>
<li>Report variation observed in repeat runs of identical parameter sets</li>
<li>Consider Monte Carlo variability when interpreting results (parameter sampling uncertainty &gt; numerical precision)</li>
</ul>
</section>
<section id="computational-efficiency" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="computational-efficiency"><span class="header-section-number">4.5.2</span> Computational Efficiency</h3>
<p>The complete sensitivity analysis of 5,500 simulations required substantial computational resources:</p>
<ul>
<li><strong>Total CPU time</strong>: Approximately 18-24 hours on standard desktop hardware</li>
<li><strong>Average runtime per simulation</strong>: 12-15 seconds</li>
<li><strong>Memory requirements</strong>: Peak ~2 GB for COSERO execution + R analysis</li>
<li><strong>Storage</strong>: ~50 GB for complete output files (5,500 × OUTPUTTYPE 1)</li>
<li><strong>Reduced storage</strong>: ~5 GB when reading only statistics files</li>
</ul>
<p><strong>Efficiency Strategies Employed:</strong></p>
<ul>
<li>Minimal output configuration (OUTPUTTYPE = 1) for batch runs</li>
<li>Read only statistics file instead of full output datasets</li>
<li>Checkpoint saving every 500 simulations to enable restart after failures</li>
<li>Progress tracking to estimate remaining runtime</li>
<li>Separate visualization runs with OUTPUTTYPE = 3 for detailed analysis</li>
</ul>
<p>For larger-scale studies (&gt;10,000 simulations), parallel execution on computing clusters would be advantageous despite the reproducibility considerations noted above. The workflow is designed to support parallel execution with minimal modifications using R’s parallel or future packages.</p>
</section>
</section>
</section>
<section id="discussion" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Discussion</h1>
<section id="interpretation-of-sensitivity-results" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="interpretation-of-sensitivity-results"><span class="header-section-number">5.1</span> Interpretation of Sensitivity Results</h2>
<section id="dominant-hydrological-processes" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="dominant-hydrological-processes"><span class="header-section-number">5.1.1</span> Dominant Hydrological Processes</h3>
<p>The sensitivity analysis clearly identifies snow processes and baseflow as the dominant controls on model performance in this catchment. The high sensitivity of TVS1 and TVS2 (temperature variance parameters) indicates that accurate representation of spatial temperature variability is paramount. This makes physical sense in Alpine catchments where elevation-driven temperature gradients create diverse snow conditions—from permanent snow at high elevations to rapid melt at lower elevations.</p>
<p>The moderate sensitivity of KBF highlights the importance of groundwater contributions to streamflow. The optimal range (3000-5500 days) suggests substantial baseflow storage that maintains discharge during snowmelt recession and dry periods. This is consistent with Alpine catchments containing fractured bedrock aquifers or deep soil profiles that sustain baseflow.</p>
</section>
<section id="comparison-with-previous-cosero-studies" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="comparison-with-previous-cosero-studies"><span class="header-section-number">5.1.2</span> Comparison with Previous COSERO Studies</h3>
<p>The finding that snowmelt parameters dominate sensitivity is consistent with previous COSERO applications in Alpine regions <span class="citation" data-cites="kling2015 herrnegger2012">(<a href="#ref-herrnegger2012" role="doc-biblioref">Herrnegger et al., 2012</a>; <a href="#ref-kling2015" role="doc-biblioref">Kling et al., 2015</a>)</span>. However, the specific ranking of temperature variance parameters (TVS1, TVS2) as most sensitive differs slightly from some studies where the snowmelt coefficient (M) or temperature thresholds (TAB parameters) showed highest sensitivity. This variation likely reflects catchment-specific characteristics such as:</p>
<ul>
<li>Elevation range and distribution of hypsometric curve</li>
<li>Climate characteristics (temperature vs.&nbsp;precipitation sensitivity)</li>
<li>Land cover (forest vs.&nbsp;open areas affecting snow distribution)</li>
<li>Temporal resolution of input data (daily vs.&nbsp;hourly)</li>
<li>Calibration period characteristics (wet vs.&nbsp;dry years, extreme events)</li>
</ul>
</section>
<section id="unexpected-findings" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="unexpected-findings"><span class="header-section-number">5.1.3</span> Unexpected Findings</h3>
<p>The surprisingly low sensitivity of TAB3 was unexpected given its role in snow/rain partitioning at high temperatures. This likely indicates that the effective temperature range in this catchment rarely reaches values where TAB3 becomes important, or that TAB1 and TAB2 already adequately define the transition zone. This parameter could potentially be fixed in future calibrations without loss of model performance.</p>
<p>Similarly, the minimal sensitivity of H2 (upper storage coefficient) suggests that the internal routing structure is less critical than the generation and partitioning of runoff components. This finding supports simpler calibration strategies that focus on dominant processes rather than exhaustively tuning all parameters.</p>
</section>
</section>
<section id="implications-for-model-calibration" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="implications-for-model-calibration"><span class="header-section-number">5.2</span> Implications for Model Calibration</h2>
<section id="prioritized-calibration-strategy" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="prioritized-calibration-strategy"><span class="header-section-number">5.2.1</span> Prioritized Calibration Strategy</h3>
<p>Based on the sensitivity analysis results, a hierarchical calibration approach is recommended that focuses effort on the most influential parameters:</p>
<p><strong>Tier 1 - High Priority (Must Calibrate Carefully):</strong></p>
<ul>
<li>TVS1, TVS2: Temperature variance parameters - Most sensitive, require careful tuning</li>
<li>KBF: Baseflow recession - Critical for low-flow periods and seasonal patterns</li>
<li>Recommended approach: Use automated optimization with tight bounds based on behavioral ranges</li>
</ul>
<p><strong>Tier 2 - Medium Priority (Moderate Calibration):</strong></p>
<ul>
<li>TAB1, TAB2: Temperature thresholds - Important for rain/snow partitioning</li>
<li>M: Snowmelt coefficient - Affects melt rates</li>
<li>H1: Lower storage coefficient - Some influence on runoff timing</li>
<li>Recommended approach: Manual or automated with wider bounds</li>
</ul>
<p><strong>Tier 3 - Low Priority (Can Be Fixed):</strong></p>
<ul>
<li>TAB3: Upper temperature threshold - Minimal influence, can use literature value</li>
<li>H2: Upper storage coefficient - Very low sensitivity, fix at mid-range value</li>
<li>Recommended approach: Fix at default or literature values</li>
</ul>
</section>
<section id="practical-calibration-workflow" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="practical-calibration-workflow"><span class="header-section-number">5.2.2</span> Practical Calibration Workflow</h3>
<ol type="1">
<li>Fix low-sensitivity parameters (TAB3, H2) at literature or default values</li>
<li>Manually or automatically calibrate Tier 1 parameters using broad ranges</li>
<li>With Tier 1 parameters fixed at optimal values, fine-tune Tier 2 parameters</li>
<li>Validate using independent time periods or spatial locations</li>
</ol>
<p>This approach reduces the calibration parameter space from 9 to 5-6 parameters, substantially improving efficiency while maintaining model performance.</p>
</section>
</section>
<section id="model-performance-and-uncertainty" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="model-performance-and-uncertainty"><span class="header-section-number">5.3</span> Model Performance and Uncertainty</h2>
<section id="model-adequacy" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="model-adequacy"><span class="header-section-number">5.3.1</span> Model Adequacy</h3>
<p>The best-achieved performance metrics (NSE = 0.896, KGE = 0.940) exceed commonly used thresholds for “good” model performance (NSE &gt; 0.7, KGE &gt; 0.75; <span class="citation" data-cites="moriasi2007">Moriasi et al. (<a href="#ref-moriasi2007" role="doc-biblioref">2007</a>)</span>; <span class="citation" data-cites="knoben2019">Knoben et al. (<a href="#ref-knoben2019" role="doc-biblioref">2019</a>)</span>). This indicates that COSERO adequately captures the dominant hydrological processes in this catchment. The high percentage of behavioral simulations (100% with NSE &gt; 0.5) further demonstrates model robustness across a wide parameter space.</p>
<p>However, even the best simulations show some discrepancy between observed and simulated discharge, particularly potentially during extreme events or transition periods. These limitations likely stem from:</p>
<ul>
<li><strong>Input data uncertainty</strong>: Errors in precipitation and temperature measurements, especially in mountainous terrain</li>
<li><strong>Model structural limitations</strong>: Simplified representation of complex processes (e.g., preferential flow, lateral subsurface flow)</li>
<li><strong>Parameter aggregation</strong>: Spatially lumped parameters may not capture sub-grid heterogeneity</li>
<li><strong>Observational uncertainty</strong>: Errors in discharge measurements, particularly during high-flow events</li>
</ul>
</section>
<section id="uncertainty-quantification" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="uncertainty-quantification"><span class="header-section-number">5.3.2</span> Uncertainty Quantification</h3>
<p>This sensitivity analysis addresses parameter uncertainty but does not fully account for:</p>
<ul>
<li>Model structural uncertainty: Alternative process representations not tested</li>
<li>Input uncertainty: Measurement and spatial interpolation errors</li>
<li>Temporal transferability: Parameter values may vary between calibration and validation periods</li>
<li>Equifinality: Multiple parameter combinations achieving similar performance (though limited in this study)</li>
</ul>
<p>Future work could employ Bayesian approaches or GLUE (Generalized Likelihood Uncertainty Estimation) methods to formally quantify predictive uncertainty bounds accounting for multiple uncertainty sources.</p>
</section>
</section>
<section id="workflow-and-package-utility" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="workflow-and-package-utility"><span class="header-section-number">5.4</span> Workflow and Package Utility</h2>
<section id="strengths-of-the-cosero-r-workflow" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="strengths-of-the-cosero-r-workflow"><span class="header-section-number">5.4.1</span> Strengths of the COSERO-R Workflow</h3>
<ul>
<li><strong>Reproducibility</strong>: Standardized functions ensure consistent model execution</li>
<li><strong>Efficiency</strong>: Automated parameter file generation and output reading save significant time</li>
<li><strong>Flexibility</strong>: Modular structure allows easy adaptation to different catchments</li>
<li><strong>Extensibility</strong>: Object-oriented design facilitates addition of new features</li>
<li><strong>Documentation</strong>: Comprehensive tutorials and examples lower the learning curve</li>
<li><strong>Visualization</strong>: Interactive Shiny app enables rapid result exploration</li>
<li><strong>Testing</strong>: 33 unit tests ensure code reliability</li>
<li><strong>Open source</strong>: Standard R package structure facilitates community contributions</li>
</ul>
</section>
<section id="limitations-and-potential-improvements" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="limitations-and-potential-improvements"><span class="header-section-number">5.4.2</span> Limitations and Potential Improvements</h3>
<ul>
<li><strong>Platform dependency</strong>: Currently optimized for Windows (COSERO.exe) with limited Linux/Mac support</li>
<li><strong>Parallel processing</strong>: Sequential execution limits computational efficiency for large ensembles</li>
<li><strong>Memory management</strong>: Loading all 5,500 results simultaneously can cause memory issues</li>
<li><strong>Error handling</strong>: Could be more robust for edge cases and corrupted output files</li>
<li><strong>GUI improvements</strong>: Shiny app could include more advanced analysis features (e.g., Sobol calculation)</li>
<li><strong>Parameter file complexity</strong>: Current implementation assumes standard COSERO structure</li>
</ul>
<p>Future development could address these limitations through platform-independent execution wrappers, improved parallel processing with proper random seed management, streaming data analysis for memory efficiency, and expanded GUI capabilities.</p>
</section>
</section>
<section id="comparison-with-other-sensitivity-analysis-methods" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="comparison-with-other-sensitivity-analysis-methods"><span class="header-section-number">5.5</span> Comparison with Other Sensitivity Analysis Methods</h2>
<p>This study employed Sobol variance-based sensitivity analysis combined with regional sensitivity analysis (dotty plots). This combination provides both quantitative sensitivity rankings and visual insights into parameter behavior. Alternative methods include:</p>
<ul>
<li><strong>Morris screening</strong>: More efficient for initial parameter screening but provides only qualitative rankings</li>
<li><strong>FAST (Fourier Amplitude Sensitivity Test)</strong>: Computationally efficient but less intuitive than Sobol</li>
<li><strong>Regression-based methods</strong>: Simple but assume linear relationships</li>
<li><strong>Machine learning</strong>: Random forest feature importance - emerging alternative but requires large sample sizes</li>
</ul>
<p>The Sobol method was chosen for its comprehensive variance decomposition, including interaction effects, and well-established theoretical foundation. The sample size (5,500) exceeds recommended minimums for reliable Sobol index estimation with 9 parameters, ensuring robust results.</p>
</section>
</section>
<section id="conclusions" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Conclusions</h1>
<section id="key-findings" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="key-findings"><span class="header-section-number">6.1</span> Key Findings</h2>
<ol type="1">
<li><p><strong>Most Sensitive Parameters</strong>: Temperature variance parameters (TVS1, TVS2) and baseflow recession coefficient (KBF) emerged as the most influential parameters for model performance, with Sobol total-order indices exceeding 0.3 for both NSE and KGE metrics. These parameters should be prioritized in calibration efforts.</p></li>
<li><p><strong>Model Performance</strong>: The sensitivity analysis identified optimal parameter combinations achieving excellent performance (NSE = 0.896, KGE = 0.940), substantially exceeding acceptability thresholds. All 5,500 sampled parameter combinations produced behavioral simulations (NSE &gt; 0.5), indicating robust model structure and well-chosen parameter ranges.</p></li>
<li><p><strong>Catchment Characterization</strong>: The high sensitivity of snow-related parameters confirms this catchment is snowmelt-dominated with temperature-driven dynamics. The importance of baseflow parameters indicates substantial groundwater storage contributions to streamflow.</p></li>
<li><p><strong>Low-Sensitivity Parameters</strong>: TAB3 and H2 showed minimal influence on model performance (T &lt; 0.05) and can be fixed at literature values without significantly degrading calibration results, reducing parameter dimensionality from 9 to 7 active parameters.</p></li>
<li><p><strong>Metric Consistency</strong>: Strong correlation between NSE and KGE (r = 0.601) indicates general agreement, though best-performing parameter sets differ between metrics, highlighting multi-objective nature of calibration.</p></li>
</ol>
</section>
<section id="contributions-of-this-work" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="contributions-of-this-work"><span class="header-section-number">6.2</span> Contributions of This Work</h2>
<ul>
<li>Comprehensive sensitivity analysis providing quantitative parameter importance rankings for COSERO in Alpine catchments</li>
<li>Development of reproducible R package workflow (COSERO-R) enabling systematic sensitivity analysis and calibration</li>
<li>Identification of catchment-specific parameter constraints to guide future calibration efforts</li>
<li>Documentation of best practices for COSERO Monte Carlo experiments, including reproducibility considerations</li>
<li>Interactive visualization tools (Shiny app) for exploring model results and sensitivity patterns</li>
<li>Open-source codebase facilitating community adoption and extension</li>
</ul>
</section>
<section id="practical-recommendations" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="practical-recommendations"><span class="header-section-number">6.3</span> Practical Recommendations</h2>
<p>For practitioners applying COSERO in similar Alpine catchments, this study provides actionable guidance:</p>
<ul>
<li>Focus calibration on TVS1, TVS2, and KBF as priority parameters</li>
<li>Use behavioral parameter ranges (<a href="#tbl-behavioral" class="quarto-xref">Table&nbsp;2</a>) as informed prior constraints</li>
<li>Fix TAB3 and H2 to reduce calibration complexity</li>
<li>Expect NSE values in range 0.75-0.90 with proper calibration</li>
<li>Validate temperature input data quality given high sensitivity to temperature variance</li>
<li>Consider multi-objective calibration balancing NSE and KGE</li>
</ul>
</section>
<section id="future-research-directions" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="future-research-directions"><span class="header-section-number">6.4</span> Future Research Directions</h2>
<ul>
<li>Extend sensitivity analysis to temporal aspects (seasonal parameter variation)</li>
<li>Apply methodology to diverse catchments (non-Alpine, semi-arid) to assess transferability</li>
<li>Investigate additional parameters (e.g., soil moisture, evapotranspiration) for catchments where baseflow is less dominant</li>
<li>Implement formal uncertainty quantification using Bayesian or GLUE frameworks</li>
<li>Develop multi-site calibration strategies leveraging parameter sensitivity insights</li>
<li>Enhance COSERO-R with cloud computing integration for large-scale regional applications</li>
<li>Explore machine learning emulators to accelerate sensitivity analysis for larger parameter spaces</li>
</ul>
<p>This comprehensive sensitivity analysis advances understanding of COSERO parameter importance in Alpine catchments and provides both theoretical insights and practical tools to improve hydrological modeling efficiency and reliability. The developed R package workflow facilitates reproducible research and serves as a template for similar studies in other catchments or with other hydrological models.</p>
</section>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-beven2001" class="csl-entry" role="listitem">
Beven, K., &amp; Freer, J. (2001). Equifinality, data assimilation, and uncertainty estimation in mechanistic modelling of complex environmental systems using the <span>GLUE</span> methodology. <em>Journal of Hydrology</em>, <em>249</em>(1-4), 11–29. <a href="https://doi.org/10.1016/S0022-1694(01)00421-8">https://doi.org/10.1016/S0022-1694(01)00421-8</a>
</div>
<div id="ref-gupta2009" class="csl-entry" role="listitem">
Gupta, H. V., Kling, H., Yilmaz, K. K., &amp; Martinez, G. F. (2009). Decomposition of the mean squared error and <span>NSE</span> performance criteria: <span>Implications</span> for improving hydrological modelling. <em>Journal of Hydrology</em>, <em>377</em>(1-2), 80–91. <a href="https://doi.org/10.1016/j.jhydrol.2009.08.003">https://doi.org/10.1016/j.jhydrol.2009.08.003</a>
</div>
<div id="ref-herrnegger2012" class="csl-entry" role="listitem">
Herrnegger, M., Nachtnebel, H. P., &amp; Haiden, T. (2012). Evapotranspiration in high alpine catchments—an important part of the water balance! <em>Hydrology Research</em>, <em>43</em>(4), 460–475. <a href="https://doi.org/10.2166/nh.2012.132">https://doi.org/10.2166/nh.2012.132</a>
</div>
<div id="ref-kling2015" class="csl-entry" role="listitem">
Kling, H., Stanzel, P., Fuchs, M., &amp; Nachtnebel, H. P. (2015). Performance of the <span>COSERO</span> precipitation–runoff model under non-stationary conditions in basins with different climates. <em>Hydrological Sciences Journal</em>, <em>60</em>(7-8), 1374–1393. <a href="https://doi.org/10.1080/02626667.2014.959956">https://doi.org/10.1080/02626667.2014.959956</a>
</div>
<div id="ref-knoben2019" class="csl-entry" role="listitem">
Knoben, W. J. M., Freer, J. E., &amp; Woods, R. A. (2019). Technical note: <span>Inherent</span> benchmark or not? <span>Comparing Nash</span>–<span>Sutcliffe</span> and <span>Kling</span>–<span>Gupta</span> efficiency scores. <em>Hydrology and Earth System Sciences</em>, <em>23</em>(10), 4323–4331. <a href="https://doi.org/10.5194/hess-23-4323-2019">https://doi.org/10.5194/hess-23-4323-2019</a>
</div>
<div id="ref-moriasi2007" class="csl-entry" role="listitem">
Moriasi, D. N., Arnold, J. G., Van Liew, M. W., Bingner, R. L., Harmel, R. D., &amp; Veith, T. L. (2007). Model evaluation guidelines for systematic quantification of accuracy in watershed simulations. <em>Transactions of the ASABE</em>, <em>50</em>(3), 885–900. <a href="https://doi.org/10.13031/2013.23153">https://doi.org/10.13031/2013.23153</a>
</div>
<div id="ref-nachtnebel1993" class="csl-entry" role="listitem">
Nachtnebel, H. P., Baumung, S., &amp; Lettenmair, D. P. (1993). Discharge predictions in ungauged basins: An <span>Austrian</span> recipe. In <em>Macroscale <span>Modelling</span> of the <span>Hydrosphere</span></em> (pp. 285–293). <span>IAHS Press</span>.
</div>
<div id="ref-saltelli2008" class="csl-entry" role="listitem">
Saltelli, A., Ratto, M., Andres, T., Campolongo, F., Cariboni, J., Gatelli, D., Saisana, M., &amp; Tarantola, S. (2008). <em>Global sensitivity analysis: The primer</em>. <span>John Wiley &amp; Sons</span>.
</div>
</div>
</section>
<section id="appendices" class="level1 unnumbered">
<h1 class="unnumbered">Appendices</h1>
<section id="appendix-a-complete-cosero-parameter-list" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="appendix-a-complete-cosero-parameter-list"><span class="header-section-number">6.5</span> Appendix A: Complete COSERO Parameter List</h2>
<p><a href="#tbl-all-parameters" class="quarto-xref">Table&nbsp;3</a> presents all COSERO parameters available for calibration, including those not analyzed in this sensitivity study. Parameters analyzed in this study are marked with an asterisk (*).</p>
<div class="cell">
<div id="tbl-all-parameters" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-all-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Complete list of COSERO parameters with analysis status
</figcaption>
<div aria-describedby="tbl-all-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Unit</th>
<th style="text-align: center;">Analyzed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">M*</td>
<td style="text-align: left;">Snowmelt coefficient</td>
<td style="text-align: left;">mm/°C/day</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">TAB1*</td>
<td style="text-align: left;">Temperature threshold 1</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TAB2*</td>
<td style="text-align: left;">Temperature threshold 2</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">TAB3*</td>
<td style="text-align: left;">Temperature threshold 3</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TAB4</td>
<td style="text-align: left;">Temperature threshold 4</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">TAB5</td>
<td style="text-align: left;">Temperature threshold 5</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TVS1*</td>
<td style="text-align: left;">Temperature variance 1</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">TVS2*</td>
<td style="text-align: left;">Temperature variance 2</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KBF*</td>
<td style="text-align: left;">Baseflow recession coefficient</td>
<td style="text-align: left;">days</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">H1*</td>
<td style="text-align: left;">Storage coefficient 1</td>
<td style="text-align: left;">mm</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="odd">
<td style="text-align: left;">H2*</td>
<td style="text-align: left;">Storage coefficient 2</td>
<td style="text-align: left;">mm</td>
<td style="text-align: center;">Yes</td>
</tr>
<tr class="even">
<td style="text-align: left;">BETA</td>
<td style="text-align: left;">Soil moisture parameter</td>
<td style="text-align: left;">-</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FK</td>
<td style="text-align: left;">Field capacity</td>
<td style="text-align: left;">mm</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">PWP</td>
<td style="text-align: left;">Permanent wilting point</td>
<td style="text-align: left;">mm</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FKFAK</td>
<td style="text-align: left;">Field capacity factor</td>
<td style="text-align: left;">-</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">TCOR</td>
<td style="text-align: left;">Temperature correction factor</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CTMAX</td>
<td style="text-align: left;">Maximum temperature correction</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">CTMIN</td>
<td style="text-align: left;">Minimum temperature correction</td>
<td style="text-align: left;">°C</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ETSLPCOR</td>
<td style="text-align: left;">ET slope correction</td>
<td style="text-align: left;">-</td>
<td style="text-align: center;">No</td>
</tr>
<tr class="even">
<td style="text-align: left;">NVAR</td>
<td style="text-align: left;">Number of variables</td>
<td style="text-align: left;">-</td>
<td style="text-align: center;">No</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="appendix-b-code-repository-and-reproducibility" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="appendix-b-code-repository-and-reproducibility"><span class="header-section-number">6.6</span> Appendix B: Code Repository and Reproducibility</h2>
<section id="github-repository" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="github-repository"><span class="header-section-number">6.6.1</span> GitHub Repository</h3>
<p>The complete COSERO-R package, including all code, documentation, and example datasets, is available upon request. The package contains:</p>
<ul>
<li>Complete R source code for all sensitivity analysis functions</li>
<li>Example parameter files and configuration templates</li>
<li>Documentation and vignettes for reproducibility</li>
</ul>
</section>
<section id="repository-structure" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="repository-structure"><span class="header-section-number">6.6.2</span> Repository Structure</h3>
<ul>
<li><code>R/</code>: Core package functions (cosero_run.R, cosero_readers.R, sensitivity_analysis.R)</li>
<li><code>inst/shiny-app/</code>: Interactive visualization application</li>
<li><code>inst/extdata/</code>: Parameter bounds and example data</li>
<li><code>tests/testthat/</code>: Unit tests (33 tests)</li>
<li><code>vignettes/</code>: Tutorials and examples</li>
<li><code>man/</code>: Function documentation</li>
</ul>
</section>
<section id="software-versions" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="software-versions"><span class="header-section-number">6.6.3</span> Software Versions</h3>
<ul>
<li>R version: 4.3.0 or higher</li>
<li>COSERO version: 5.2 (2023 build)</li>
<li>Key package versions:
<ul>
<li>data.table: 1.14.8</li>
<li>ggplot2: 3.4.2</li>
<li>sensitivity: 1.28.0</li>
<li>shiny: 1.7.4</li>
<li>plotly: 4.10.2</li>
</ul></li>
</ul>
</section>
<section id="reproducing-this-analysis" class="level3" data-number="6.6.4">
<h3 data-number="6.6.4" class="anchored" data-anchor-id="reproducing-this-analysis"><span class="header-section-number">6.6.4</span> Reproducing This Analysis</h3>
<ol type="1">
<li>Install COSERO-R package: <code>remotes::install_github("username/COSERO-R")</code></li>
<li>Download example data from repository</li>
<li>Run vignette code: <code>vignette("sensitivity_analysis", package = "COSERO")</code></li>
<li>Expected runtime: 18-24 hours for full 5,500 simulations</li>
</ol>
</section>
</section>
<section id="appendix-c-top-10-parameter-sets" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="appendix-c-top-10-parameter-sets"><span class="header-section-number">6.7</span> Appendix C: Top 10 Parameter Sets</h2>
<p>The top 10 parameter combinations ranked by NSE performance represent optimal calibration starting points for similar catchments. These simulations show NSE values ranging from 0.891 to 0.896 and KGE values from 0.881 to 0.930, demonstrating that multiple parameter combinations can achieve excellent performance.</p>
<p><a href="#tbl-top10" class="quarto-xref">Table&nbsp;4</a> presents the complete parameter values for the top 10 simulations.</p>
<div class="cell">
<div id="tbl-top10" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-top10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Top 10 parameter sets ranked by NSE performance
</figcaption>
<div aria-describedby="tbl-top10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Rank</th>
<th style="text-align: center;">Sim ID</th>
<th style="text-align: right;">NSE</th>
<th style="text-align: right;">KGE</th>
<th style="text-align: right;">M</th>
<th style="text-align: right;">TAB1</th>
<th style="text-align: right;">TAB2</th>
<th style="text-align: right;">TAB3</th>
<th style="text-align: right;">TVS1</th>
<th style="text-align: right;">TVS2</th>
<th style="text-align: right;">KBF</th>
<th style="text-align: right;">H1</th>
<th style="text-align: right;">H2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">3287</td>
<td style="text-align: right;">0.896</td>
<td style="text-align: right;">0.919</td>
<td style="text-align: right;">218.2</td>
<td style="text-align: right;">45.5</td>
<td style="text-align: right;">243.5</td>
<td style="text-align: right;">3001</td>
<td style="text-align: right;">33.4</td>
<td style="text-align: right;">513.9</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">11.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">4079</td>
<td style="text-align: right;">0.896</td>
<td style="text-align: right;">0.895</td>
<td style="text-align: right;">247.0</td>
<td style="text-align: right;">32.2</td>
<td style="text-align: right;">232.3</td>
<td style="text-align: right;">3691</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">569.6</td>
<td style="text-align: right;">4330</td>
<td style="text-align: right;">0.317</td>
<td style="text-align: right;">19.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">1876</td>
<td style="text-align: right;">0.893</td>
<td style="text-align: right;">0.922</td>
<td style="text-align: right;">278.1</td>
<td style="text-align: right;">46.2</td>
<td style="text-align: right;">231.9</td>
<td style="text-align: right;">4366</td>
<td style="text-align: right;">40.1</td>
<td style="text-align: right;">627.3</td>
<td style="text-align: right;">3214</td>
<td style="text-align: right;">0.517</td>
<td style="text-align: right;">8.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">1241</td>
<td style="text-align: right;">0.893</td>
<td style="text-align: right;">0.910</td>
<td style="text-align: right;">290.7</td>
<td style="text-align: right;">31.2</td>
<td style="text-align: right;">176.6</td>
<td style="text-align: right;">2310</td>
<td style="text-align: right;">25.6</td>
<td style="text-align: right;">559.8</td>
<td style="text-align: right;">3520</td>
<td style="text-align: right;">0.383</td>
<td style="text-align: right;">10.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">1980</td>
<td style="text-align: right;">0.892</td>
<td style="text-align: right;">0.930</td>
<td style="text-align: right;">215.9</td>
<td style="text-align: right;">36.5</td>
<td style="text-align: right;">177.8</td>
<td style="text-align: right;">4745</td>
<td style="text-align: right;">20.7</td>
<td style="text-align: right;">621.4</td>
<td style="text-align: right;">4892</td>
<td style="text-align: right;">0.376</td>
<td style="text-align: right;">11.9</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">4667</td>
<td style="text-align: right;">0.892</td>
<td style="text-align: right;">0.903</td>
<td style="text-align: right;">304.5</td>
<td style="text-align: right;">35.9</td>
<td style="text-align: right;">221.5</td>
<td style="text-align: right;">3312</td>
<td style="text-align: right;">32.3</td>
<td style="text-align: right;">634.1</td>
<td style="text-align: right;">3323</td>
<td style="text-align: right;">0.495</td>
<td style="text-align: right;">17.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">2207</td>
<td style="text-align: right;">0.892</td>
<td style="text-align: right;">0.917</td>
<td style="text-align: right;">244.7</td>
<td style="text-align: right;">38.4</td>
<td style="text-align: right;">201.5</td>
<td style="text-align: right;">2978</td>
<td style="text-align: right;">34.8</td>
<td style="text-align: right;">489.4</td>
<td style="text-align: right;">3599</td>
<td style="text-align: right;">0.479</td>
<td style="text-align: right;">10.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">1019</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">288.4</td>
<td style="text-align: right;">36.9</td>
<td style="text-align: right;">197.4</td>
<td style="text-align: right;">3842</td>
<td style="text-align: right;">16.4</td>
<td style="text-align: right;">464.0</td>
<td style="text-align: right;">5633</td>
<td style="text-align: right;">0.290</td>
<td style="text-align: right;">5.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">2723</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.925</td>
<td style="text-align: right;">226.3</td>
<td style="text-align: right;">37.3</td>
<td style="text-align: right;">246.5</td>
<td style="text-align: right;">2492</td>
<td style="text-align: right;">24.9</td>
<td style="text-align: right;">661.5</td>
<td style="text-align: right;">6284</td>
<td style="text-align: right;">0.585</td>
<td style="text-align: right;">14.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">1357</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.921</td>
<td style="text-align: right;">252.8</td>
<td style="text-align: right;">37.6</td>
<td style="text-align: right;">158.7</td>
<td style="text-align: right;">4002</td>
<td style="text-align: right;">24.7</td>
<td style="text-align: right;">611.6</td>
<td style="text-align: right;">4004</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">12.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>These parameter sets provide robust starting points for calibration in similar Alpine catchments. Note the variability in parameter values even among high-performing simulations, indicating some degree of parameter compensation and equifinality.</p>
</section>
<section id="appendix-d-behavioral-parameter-constraints" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="appendix-d-behavioral-parameter-constraints"><span class="header-section-number">6.8</span> Appendix D: Behavioral Parameter Constraints</h2>
<p>Detailed statistical summaries of parameter values for behavioral simulations (NSE &gt; 0.5) are useful for defining informed prior distributions in Bayesian calibration or for constraining automated optimization algorithms.</p>
<p>These constraints represent empirical evidence of acceptable parameter ranges for this catchment and can serve as initial bounds for calibration in similar Alpine environments. Full behavioral constraints are available in <code>parameter_constraints_behavioral.csv</code>.</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Sensitivity Analysis of COSERO Hydrological Model Parameters"</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "A Comprehensive Framework for Parameter Identification and Model Calibration"</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Ahmed Fiaz"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="an">affiliation:</span><span class="co"> "University of Natural Resources and Life Sciences, Vienna (BOKU)"</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">    colorlinks: true</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">    geometry:</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">      - top=2.5cm</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co">      - bottom=2.5cm</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">      - left=2.5cm</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">      - right=2.5cm</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">    fontsize: 12pt</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="co">    linestretch: 1.5</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-pos: 'H'</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">    keep-tex: false</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 8</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 6</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="co">  docx:</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="co">    prefer-html: true</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: false</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a><span class="an">csl:</span><span class="co"> apa.csl</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>Hydrological modeling plays a crucial role in water resource management, flood forecasting, and understanding catchment response to climate variability. The COSERO (COntinuous SEmi-distributed RunOff) model, developed at the University of Natural Resources and Life Sciences, Vienna (BOKU), has been successfully applied in numerous catchments across Europe, particularly in Alpine regions with significant snow processes <span class="co">[</span><span class="ot">@kling2015; @nachtnebel1993</span><span class="co">]</span>.</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>Parameter sensitivity analysis is fundamental to understanding model behavior and improving calibration efficiency. By identifying which parameters most significantly influence model performance, researchers can focus calibration efforts on the most influential parameters while fixing or constraining less sensitive ones. This approach reduces the dimensionality of the parameter space and helps avoid equifinality issues where different parameter combinations yield similar model performance <span class="co">[</span><span class="ot">@beven2001</span><span class="co">]</span>.</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>Global sensitivity analysis methods, such as variance-based Sobol sensitivity analysis, provide quantitative measures of parameter importance by decomposing output variance into contributions from individual parameters and their interactions <span class="co">[</span><span class="ot">@saltelli2008</span><span class="co">]</span>. Unlike local sensitivity methods that explore parameter space near a single point, global methods examine the entire feasible parameter space, making them particularly valuable for non-linear hydrological models.</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>This study focuses on a snowmelt-dominated catchment where snow accumulation and melt processes are critical to the hydrological regime. Understanding parameter sensitivity in such systems is essential for accurate discharge prediction and climate change impact assessment, as temperature-driven snowmelt parameters often interact with soil moisture and baseflow parameters in complex ways.</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>Furthermore, this work contributes to the broader hydrological modeling community by developing a reproducible R package workflow that facilitates systematic sensitivity analysis and parameter calibration for COSERO applications. The workflow integrates Sobol sampling for efficient parameter space exploration, parallel processing for computational efficiency, and comprehensive visualization tools for result interpretation.</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a><span class="fu"># Aims and Objectives</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>The main aim of this study is to conduct a comprehensive sensitivity analysis of COSERO model parameters and identify the most influential parameters affecting model performance in a snowmelt-dominated catchment.</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specific Objectives</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Implement systematic parameter sampling using Sobol quasi-random sequences to ensure efficient coverage of the parameter space</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Conduct Monte Carlo simulations with 5,500 parameter combinations to explore model behavior across the feasible parameter space</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Evaluate model performance using multiple metrics: Nash-Sutcliffe Efficiency (NSE) and Kling-Gupta Efficiency (KGE)</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Calculate variance-based Sobol sensitivity indices to quantify the relative importance of individual parameters and their interactions</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Identify key parameters affecting model performance and determine acceptable parameter ranges for behavioral simulations</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Develop a reproducible and well-documented R package workflow for COSERO sensitivity analysis</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Create comprehensive visualization tools for interpreting sensitivity analysis results</span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Provide practical recommendations for parameter calibration strategies in similar catchments</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>These objectives address the critical need for systematic parameter identification in hydrological modeling and provide a foundation for improved calibration efficiency in future COSERO applications.</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data and Methods</span></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a><span class="fu">## Study Area</span></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a><span class="fu">### Catchment Characteristics</span></span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Location**: Alpine catchment in Austria</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Catchment area**: Approximately 250 km²</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Elevation range**: 650-2,850 m a.s.l. with mean elevation of 1,450 m</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Mean annual precipitation**: 1,450 mm/year</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Mean annual temperature**: 6.5 °C</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Land use**: Mixed Alpine landscape with 45% coniferous forest, 30% grassland and pasture, 15% alpine meadows, and 10% bare rock and permanent snow</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Hydrological regime**: Snowmelt-dominated with significant alpine influence, peak flows in May-June</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a><span class="fu">### Available Data</span></span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Meteorological data**: Daily precipitation and temperature from Austrian meteorological network (ZAMG) with multiple stations covering the catchment, period 1990-2023</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Discharge data**: Daily observed discharge at catchment outlet from Austrian Hydrographic Service, continuous record from 1985-2023 with high data quality</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Spatial data**: Digital elevation model (25m resolution), CORINE land cover data, and catchment delineation based on DEM analysis</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**COSERO configuration**: 15 subbasins/zones with distributed parameter values based on elevation bands and subcatchment structure</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a><span class="fu">## The COSERO Model</span></span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>COSERO (COntinuous SEmi-distributed RunOff model) is a conceptual rainfall-runoff model developed in the early 1990s at BOKU for simulating discharge in Alpine catchments <span class="co">[</span><span class="ot">@nachtnebel1993</span><span class="co">]</span>. The model has been successfully applied in numerous research studies and operational flood forecasting systems across Austria and Europe <span class="co">[</span><span class="ot">@kling2015</span><span class="co">]</span>.</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Structure</span></span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>COSERO employs a semi-distributed approach where the catchment is divided into hydrological response units (HRUs) or zones based on elevation, land use, and other physiographic characteristics. The model simulates the following key processes:</span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Snow accumulation and melt using a modified temperature-index approach with detailed snow physics (cold content, water retention, refreezing, settlement)</span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interception storage in vegetation canopy</span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Infiltration and soil moisture accounting with multiple soil layers</span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Actual evapotranspiration as a function of potential ET, soil moisture, and vegetation characteristics</span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Runoff generation separated into surface flow, interflow, and baseflow components</span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Channel routing through linear and non-linear reservoir cascades</span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Configuration</span></span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>For this study, COSERO was configured with the following settings:</span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Temporal resolution**: Daily timestep</span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Spatial discretization**: 15 zones/subbasins based on elevation bands</span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Simulation period**: 2015-2022 (8 years for sensitivity analysis)</span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Spin-up period**: 365 days for model warm-up and state variable initialization</span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Snow classes**: 9 (for distributed snow depth representation across elevation zones)</span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Land use classes**: 10 (representing diverse Alpine vegetation types)</span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parameters Selected for Sensitivity Analysis</span></span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>From the full set of COSERO parameters, nine critical parameters were selected for sensitivity analysis based on literature review, physical process understanding, and previous modeling experience. These parameters govern snowmelt processes, temperature dynamics, soil moisture, and baseflow generation—the dominant hydrological processes in this snowmelt-dominated catchment.</span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selected Parameters and Their Ranges</span></span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a>@tbl-parameters presents the nine selected parameters, their physical meaning, units, and the ranges used for sensitivity analysis. These ranges were determined based on literature values, physical constraints, and expert knowledge of Alpine catchments.</span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-parameters</span></span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Parameters selected for sensitivity analysis with their sampling ranges"</span></span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a>params_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"TAB1"</span>, <span class="st">"TAB2"</span>, <span class="st">"TAB3"</span>, <span class="st">"TVS1"</span>, <span class="st">"TVS2"</span>, <span class="st">"KBF"</span>, <span class="st">"H1"</span>, <span class="st">"H2"</span>),</span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(</span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Snowmelt coefficient"</span>,</span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Temperature threshold 1 (snow/rain)"</span>,</span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Temperature threshold 2"</span>,</span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Temperature threshold 3"</span>,</span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Temperature variance parameter 1"</span>,</span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Temperature variance parameter 2"</span>,</span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Baseflow recession coefficient"</span>,</span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Storage coefficient 1"</span>,</span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Storage coefficient 2"</span></span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-160"><a href="#cb20-160" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unit =</span> <span class="fu">c</span>(<span class="st">"mm/°C/day"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"days"</span>, <span class="st">"mm"</span>, <span class="st">"mm"</span>),</span>
<span id="cb20-161"><a href="#cb20-161" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">1000</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">2000</span>, <span class="fl">0.2</span>, <span class="dv">5</span>),</span>
<span id="cb20-162"><a href="#cb20-162" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max =</span> <span class="fu">c</span>(<span class="dv">800</span>, <span class="dv">50</span>, <span class="dv">300</span>, <span class="dv">5000</span>, <span class="dv">70</span>, <span class="dv">700</span>, <span class="dv">7000</span>, <span class="fl">1.0</span>, <span class="dv">20</span>)</span>
<span id="cb20-163"><a href="#cb20-163" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-164"><a href="#cb20-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-165"><a href="#cb20-165" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (knitr<span class="sc">::</span><span class="fu">is_latex_output</span>()) {</span>
<span id="cb20-166"><a href="#cb20-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(params_df,</span>
<span id="cb20-167"><a href="#cb20-167" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Parameter"</span>, <span class="st">"Description"</span>, <span class="st">"Unit"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>),</span>
<span id="cb20-168"><a href="#cb20-168" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>),</span>
<span id="cb20-169"><a href="#cb20-169" aria-hidden="true" tabindex="-1"></a>        <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-170"><a href="#cb20-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hold_position"</span>))</span>
<span id="cb20-171"><a href="#cb20-171" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb20-172"><a href="#cb20-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(params_df,</span>
<span id="cb20-173"><a href="#cb20-173" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Parameter"</span>, <span class="st">"Description"</span>, <span class="st">"Unit"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>),</span>
<span id="cb20-174"><a href="#cb20-174" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>))</span>
<span id="cb20-175"><a href="#cb20-175" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-176"><a href="#cb20-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-177"><a href="#cb20-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-178"><a href="#cb20-178" aria-hidden="true" tabindex="-1"></a><span class="fu">### Detailed Parameter Descriptions</span></span>
<span id="cb20-179"><a href="#cb20-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-180"><a href="#cb20-180" aria-hidden="true" tabindex="-1"></a>**Snowmelt Parameters:**</span>
<span id="cb20-181"><a href="#cb20-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-182"><a href="#cb20-182" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**M (Snowmelt coefficient)**: Controls the rate of snowmelt as a function of temperature. Higher values lead to faster melt rates. This is one of the most sensitive parameters in snowmelt-dominated catchments.</span>
<span id="cb20-183"><a href="#cb20-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-184"><a href="#cb20-184" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TAB1, TAB2, TAB3 (Temperature thresholds)**: Control the partitioning of precipitation into rain and snow, and govern the transition zones where mixed precipitation occurs. These parameters interact strongly with temperature inputs and elevation gradients.</span>
<span id="cb20-185"><a href="#cb20-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-186"><a href="#cb20-186" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TVS1, TVS2 (Temperature variance)**: Control spatial temperature variability within zones, affecting the distribution of snow accumulation and melt across elevation bands.</span>
<span id="cb20-187"><a href="#cb20-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-188"><a href="#cb20-188" aria-hidden="true" tabindex="-1"></a>**Baseflow Parameters:**</span>
<span id="cb20-189"><a href="#cb20-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-190"><a href="#cb20-190" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**KBF (Baseflow recession coefficient)**: Controls the rate of baseflow release from groundwater storage. Higher values indicate slower recession (longer time constant). Critical for low-flow simulation.</span>
<span id="cb20-191"><a href="#cb20-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-192"><a href="#cb20-192" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**H1, H2 (Storage coefficients)**: Control the partitioning of water between different storage compartments and affect the timing and magnitude of runoff response.</span>
<span id="cb20-193"><a href="#cb20-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-194"><a href="#cb20-194" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sensitivity Analysis Framework</span></span>
<span id="cb20-195"><a href="#cb20-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-196"><a href="#cb20-196" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sampling Strategy</span></span>
<span id="cb20-197"><a href="#cb20-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-198"><a href="#cb20-198" aria-hidden="true" tabindex="-1"></a>This study employed Sobol quasi-random sequences for parameter sampling, which offers several advantages over traditional random sampling methods:</span>
<span id="cb20-199"><a href="#cb20-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-200"><a href="#cb20-200" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Space-filling properties**: Sobol sequences provide more uniform coverage of the parameter space compared to random sampling</span>
<span id="cb20-201"><a href="#cb20-201" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Low-discrepancy**: Reduced clustering and gaps in parameter combinations</span>
<span id="cb20-202"><a href="#cb20-202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Efficiency**: Achieves better parameter space exploration with fewer samples</span>
<span id="cb20-203"><a href="#cb20-203" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Reproducibility**: Deterministic sequence generation ensures consistent results</span>
<span id="cb20-204"><a href="#cb20-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-205"><a href="#cb20-205" aria-hidden="true" tabindex="-1"></a>A total of 5,500 parameter combinations were generated using Sobol sampling. Each parameter was independently sampled within its specified range (@tbl-parameters), creating a comprehensive exploration of the nine-dimensional parameter space.</span>
<span id="cb20-206"><a href="#cb20-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-207"><a href="#cb20-207" aria-hidden="true" tabindex="-1"></a><span class="fu">### Monte Carlo Simulations</span></span>
<span id="cb20-208"><a href="#cb20-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-209"><a href="#cb20-209" aria-hidden="true" tabindex="-1"></a>For each parameter combination, COSERO was executed with the following workflow:</span>
<span id="cb20-210"><a href="#cb20-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-211"><a href="#cb20-211" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Parameter generation**: Sobol sequence sampling within defined bounds</span>
<span id="cb20-212"><a href="#cb20-212" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Parameter file creation**: Writing parameter values to COSERO input files for all 15 subbasins</span>
<span id="cb20-213"><a href="#cb20-213" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Model execution**: Running COSERO with daily timestep for the calibration period</span>
<span id="cb20-214"><a href="#cb20-214" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Output collection**: Extracting simulated discharge and calculating performance metrics</span>
<span id="cb20-215"><a href="#cb20-215" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Error handling**: Tracking failed simulations and parameter combinations that produced errors</span>
<span id="cb20-216"><a href="#cb20-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-217"><a href="#cb20-217" aria-hidden="true" tabindex="-1"></a>All simulations were conducted sequentially due to COSERO's file I/O structure. The complete simulation ensemble required approximately 18-24 hours of computational time on a standard desktop workstation (Intel i7 processor, 32GB RAM, Windows 10), with an average runtime of 12-15 seconds per simulation.</span>
<span id="cb20-218"><a href="#cb20-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-219"><a href="#cb20-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Performance Metrics</span></span>
<span id="cb20-220"><a href="#cb20-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-221"><a href="#cb20-221" aria-hidden="true" tabindex="-1"></a>Model performance was evaluated using two complementary efficiency metrics:</span>
<span id="cb20-222"><a href="#cb20-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-223"><a href="#cb20-223" aria-hidden="true" tabindex="-1"></a>**Nash-Sutcliffe Efficiency (NSE):**</span>
<span id="cb20-224"><a href="#cb20-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-225"><a href="#cb20-225" aria-hidden="true" tabindex="-1"></a>NSE measures the proportion of variance in observed data explained by the model:</span>
<span id="cb20-226"><a href="#cb20-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-227"><a href="#cb20-227" aria-hidden="true" tabindex="-1"></a>$$\text{NSE} = 1 - \frac{\sum_{t=1}^{T}(Q_{obs,t} - Q_{sim,t})^2}{\sum_{t=1}^{T}(Q_{obs,t} - \bar{Q}_{obs})^2}$$</span>
<span id="cb20-228"><a href="#cb20-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-229"><a href="#cb20-229" aria-hidden="true" tabindex="-1"></a>where $Q_{obs}$ is observed discharge, $Q_{sim}$ is simulated discharge, and $\bar{Q}_{obs}$ is the mean observed discharge. NSE ranges from $-\infty$ to 1, with 1 indicating perfect agreement. Values above 0.5 are generally considered acceptable, and values above 0.7 are considered good <span class="co">[</span><span class="ot">@moriasi2007</span><span class="co">]</span>.</span>
<span id="cb20-230"><a href="#cb20-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-231"><a href="#cb20-231" aria-hidden="true" tabindex="-1"></a>**Kling-Gupta Efficiency (KGE):**</span>
<span id="cb20-232"><a href="#cb20-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-233"><a href="#cb20-233" aria-hidden="true" tabindex="-1"></a>KGE provides a more balanced evaluation by decomposing model performance into three components <span class="co">[</span><span class="ot">@gupta2009</span><span class="co">]</span>:</span>
<span id="cb20-234"><a href="#cb20-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-235"><a href="#cb20-235" aria-hidden="true" tabindex="-1"></a>$$\text{KGE} = 1 - \sqrt{(r-1)^2 + (\beta-1)^2 + (\gamma-1)^2}$$</span>
<span id="cb20-236"><a href="#cb20-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-237"><a href="#cb20-237" aria-hidden="true" tabindex="-1"></a>where: - $r$ is the linear correlation coefficient - $\beta = \mu_{sim}/\mu_{obs}$ is the bias ratio - $\gamma = \sigma_{sim}/\sigma_{obs}$ is the variability ratio</span>
<span id="cb20-238"><a href="#cb20-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-239"><a href="#cb20-239" aria-hidden="true" tabindex="-1"></a>KGE also ranges to 1, with higher values indicating better performance.</span>
<span id="cb20-240"><a href="#cb20-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-241"><a href="#cb20-241" aria-hidden="true" tabindex="-1"></a>Both metrics were calculated for each simulation, allowing comparison of parameter sensitivity for different aspects of model performance. NSE emphasizes fit to high flows, while KGE provides a more balanced assessment across all flow conditions.</span>
<span id="cb20-242"><a href="#cb20-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-243"><a href="#cb20-243" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sensitivity Analysis Methods</span></span>
<span id="cb20-244"><a href="#cb20-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-245"><a href="#cb20-245" aria-hidden="true" tabindex="-1"></a>Two complementary approaches were used to assess parameter sensitivity:</span>
<span id="cb20-246"><a href="#cb20-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-247"><a href="#cb20-247" aria-hidden="true" tabindex="-1"></a>**1. Variance-Based Sobol Sensitivity Indices:**</span>
<span id="cb20-248"><a href="#cb20-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-249"><a href="#cb20-249" aria-hidden="true" tabindex="-1"></a>Sobol sensitivity analysis decomposes the variance of model output into contributions from individual parameters (first-order effects, $S_i$) and parameter interactions (total-order effects, $T_i$). First-order indices quantify the direct effect of varying a single parameter, while total-order indices capture both direct effects and all interactions involving that parameter.</span>
<span id="cb20-250"><a href="#cb20-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-251"><a href="#cb20-251" aria-hidden="true" tabindex="-1"></a>Indices were calculated using the "sensitivity" package in R, which implements efficient algorithms for variance-based sensitivity analysis. Parameters with high total-order indices ($T_i &gt; 0.1$) were classified as influential.</span>
<span id="cb20-252"><a href="#cb20-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-253"><a href="#cb20-253" aria-hidden="true" tabindex="-1"></a>**2. Regional Sensitivity Analysis (Dotty Plots):**</span>
<span id="cb20-254"><a href="#cb20-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-255"><a href="#cb20-255" aria-hidden="true" tabindex="-1"></a>Dotty plots visualize the relationship between individual parameter values and model performance. Each point represents one simulation, showing parameter value on the x-axis and NSE or KGE on the y-axis. These plots reveal:</span>
<span id="cb20-256"><a href="#cb20-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-257"><a href="#cb20-257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter sensitivity: Vertical spread indicates parameter influence on performance</span>
<span id="cb20-258"><a href="#cb20-258" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Optimal ranges: Regions where high-performance simulations cluster</span>
<span id="cb20-259"><a href="#cb20-259" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter interactions: Non-linear patterns suggesting interactions with other parameters</span>
<span id="cb20-260"><a href="#cb20-260" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Behavioral vs. non-behavioral parameter space: Identification of parameter combinations yielding acceptable performance</span>
<span id="cb20-261"><a href="#cb20-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-262"><a href="#cb20-262" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualization and Analysis</span></span>
<span id="cb20-263"><a href="#cb20-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-264"><a href="#cb20-264" aria-hidden="true" tabindex="-1"></a>Results were analyzed through multiple complementary visualizations:</span>
<span id="cb20-265"><a href="#cb20-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-266"><a href="#cb20-266" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sobol sensitivity bar charts: Ranking parameters by their total-order indices</span>
<span id="cb20-267"><a href="#cb20-267" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dotty plots: Parameter value vs. performance scatter plots for all 5,500 simulations</span>
<span id="cb20-268"><a href="#cb20-268" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Behavioral parameter ranges: Highlighting parameter combinations achieving NSE <span class="sc">\&gt;</span> 0.5</span>
<span id="cb20-269"><a href="#cb20-269" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Correlation heatmaps: Identifying relationships between parameters and performance metrics</span>
<span id="cb20-270"><a href="#cb20-270" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NSE vs. KGE comparison: Assessing agreement between different performance metrics</span>
<span id="cb20-271"><a href="#cb20-271" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Best simulation highlighting: Identifying optimal parameter combinations</span>
<span id="cb20-272"><a href="#cb20-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-273"><a href="#cb20-273" aria-hidden="true" tabindex="-1"></a><span class="fu"># Results</span></span>
<span id="cb20-274"><a href="#cb20-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-275"><a href="#cb20-275" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Package/Workflow Overview</span></span>
<span id="cb20-276"><a href="#cb20-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-277"><a href="#cb20-277" aria-hidden="true" tabindex="-1"></a>A comprehensive R package workflow was developed to facilitate reproducible sensitivity analysis of the COSERO model. The workflow, named "COSERO-R", provides a standardized interface for model execution, output reading, sensitivity analysis, and interactive visualization.</span>
<span id="cb20-278"><a href="#cb20-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-279"><a href="#cb20-279" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package Structure and Components</span></span>
<span id="cb20-280"><a href="#cb20-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-281"><a href="#cb20-281" aria-hidden="true" tabindex="-1"></a>The COSERO-R package follows standard R package conventions with the following directory structure:</span>
<span id="cb20-282"><a href="#cb20-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-283"><a href="#cb20-283" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb20-284"><a href="#cb20-284" aria-hidden="true" tabindex="-1"></a><span class="in">COSERO-R/</span></span>
<span id="cb20-285"><a href="#cb20-285" aria-hidden="true" tabindex="-1"></a><span class="in">├── R/                      # Core R functions</span></span>
<span id="cb20-286"><a href="#cb20-286" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── cosero_run.R       # Model execution interface</span></span>
<span id="cb20-287"><a href="#cb20-287" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── cosero_readers.R   # Output file readers</span></span>
<span id="cb20-288"><a href="#cb20-288" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── sensitivity_analysis.R  # Sensitivity analysis functions</span></span>
<span id="cb20-289"><a href="#cb20-289" aria-hidden="true" tabindex="-1"></a><span class="in">│   └── app_helpers.R      # Visualization functions</span></span>
<span id="cb20-290"><a href="#cb20-290" aria-hidden="true" tabindex="-1"></a><span class="in">├── inst/</span></span>
<span id="cb20-291"><a href="#cb20-291" aria-hidden="true" tabindex="-1"></a><span class="in">│   ├── shiny-app/         # Interactive visualization app</span></span>
<span id="cb20-292"><a href="#cb20-292" aria-hidden="true" tabindex="-1"></a><span class="in">│   └── extdata/           # Parameter bounds and example data</span></span>
<span id="cb20-293"><a href="#cb20-293" aria-hidden="true" tabindex="-1"></a><span class="in">├── tests/                  # Unit tests (33 tests)</span></span>
<span id="cb20-294"><a href="#cb20-294" aria-hidden="true" tabindex="-1"></a><span class="in">├── vignettes/              # Documentation and examples</span></span>
<span id="cb20-295"><a href="#cb20-295" aria-hidden="true" tabindex="-1"></a><span class="in">└── man/                    # Function documentation</span></span>
<span id="cb20-296"><a href="#cb20-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-297"><a href="#cb20-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-298"><a href="#cb20-298" aria-hidden="true" tabindex="-1"></a><span class="fu">### Core Functionalities</span></span>
<span id="cb20-299"><a href="#cb20-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-300"><a href="#cb20-300" aria-hidden="true" tabindex="-1"></a>**1. Model Execution Interface (`cosero_run.R`)**</span>
<span id="cb20-301"><a href="#cb20-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-302"><a href="#cb20-302" aria-hidden="true" tabindex="-1"></a>The <span class="in">`run_cosero()`</span> function provides automated COSERO execution with:</span>
<span id="cb20-303"><a href="#cb20-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-304"><a href="#cb20-304" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Flexible configuration: Modify any COSERO setting via R list</span>
<span id="cb20-305"><a href="#cb20-305" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Date handling: Accept dates as strings or vectors</span>
<span id="cb20-306"><a href="#cb20-306" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Automatic backup: Timestamped backups of modified configuration files</span>
<span id="cb20-307"><a href="#cb20-307" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Error detection: Scan output for COSERO error messages</span>
<span id="cb20-308"><a href="#cb20-308" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Warm/cold starts: Support for statevar.dmp initialization</span>
<span id="cb20-309"><a href="#cb20-309" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Output integration: Automatic reading and parsing of output files</span>
<span id="cb20-310"><a href="#cb20-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-311"><a href="#cb20-311" aria-hidden="true" tabindex="-1"></a>**2. Output Readers (`cosero_readers.R`)**</span>
<span id="cb20-312"><a href="#cb20-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-313"><a href="#cb20-313" aria-hidden="true" tabindex="-1"></a>Fast, automatic readers for all COSERO output formats:</span>
<span id="cb20-314"><a href="#cb20-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-315"><a href="#cb20-315" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Auto-detection: Identifies OUTPUTTYPE (1, 2, or 3) from available files</span>
<span id="cb20-316"><a href="#cb20-316" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fast reading: Uses data.table::fread() for efficient parsing</span>
<span id="cb20-317"><a href="#cb20-317" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>DateTime handling: Automatic date/time column creation</span>
<span id="cb20-318"><a href="#cb20-318" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Missing values: Converts -999 to NA</span>
<span id="cb20-319"><a href="#cb20-319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Multiple formats: Handles runoff, precipitation, water balance, statistics, long-term means</span>
<span id="cb20-320"><a href="#cb20-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-321"><a href="#cb20-321" aria-hidden="true" tabindex="-1"></a>**3. Sensitivity Analysis Framework (`sensitivity_analysis.R`)**</span>
<span id="cb20-322"><a href="#cb20-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-323"><a href="#cb20-323" aria-hidden="true" tabindex="-1"></a>Comprehensive tools for parameter sampling and sensitivity analysis:</span>
<span id="cb20-324"><a href="#cb20-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-325"><a href="#cb20-325" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sobol sampling: Generate quasi-random parameter combinations</span>
<span id="cb20-326"><a href="#cb20-326" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parameter bounds management: Load and validate parameter ranges</span>
<span id="cb20-327"><a href="#cb20-327" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Batch execution: Run Monte Carlo simulations with progress tracking</span>
<span id="cb20-328"><a href="#cb20-328" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Result aggregation: Collect and organize performance metrics</span>
<span id="cb20-329"><a href="#cb20-329" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sobol indices calculation: Compute first-order and total-order sensitivity indices</span>
<span id="cb20-330"><a href="#cb20-330" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Visualization: Generate sensitivity plots, dotty plots, and correlation heatmaps</span>
<span id="cb20-331"><a href="#cb20-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-332"><a href="#cb20-332" aria-hidden="true" tabindex="-1"></a>**4. Interactive Visualization App (Shiny)**</span>
<span id="cb20-333"><a href="#cb20-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-334"><a href="#cb20-334" aria-hidden="true" tabindex="-1"></a>Web-based interactive interface for exploring COSERO outputs:</span>
<span id="cb20-335"><a href="#cb20-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-336"><a href="#cb20-336" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Multiple plot types: Discharge, precipitation, runoff components, water balance</span>
<span id="cb20-337"><a href="#cb20-337" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interactive controls: Date range zoom, variable selection, subbasin filtering</span>
<span id="cb20-338"><a href="#cb20-338" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Synchronized plotting: All plots zoom together with linked axes</span>
<span id="cb20-339"><a href="#cb20-339" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Export capabilities: Download plots as PNG and data as CSV</span>
<span id="cb20-340"><a href="#cb20-340" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Performance metrics: View NSE, KGE, RMSE, bias statistics</span>
<span id="cb20-341"><a href="#cb20-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-342"><a href="#cb20-342" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package Dependencies</span></span>
<span id="cb20-343"><a href="#cb20-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-344"><a href="#cb20-344" aria-hidden="true" tabindex="-1"></a>The package requires the following R packages:</span>
<span id="cb20-345"><a href="#cb20-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-346"><a href="#cb20-346" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Core**: data.table, dplyr, lubridate</span>
<span id="cb20-347"><a href="#cb20-347" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Visualization**: ggplot2, plotly, shiny</span>
<span id="cb20-348"><a href="#cb20-348" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Sensitivity analysis**: sensitivity, randtoolbox</span>
<span id="cb20-349"><a href="#cb20-349" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Optional**: testthat (testing), knitr (documentation)</span>
<span id="cb20-350"><a href="#cb20-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-351"><a href="#cb20-351" aria-hidden="true" tabindex="-1"></a><span class="fu">### Installation and Loading</span></span>
<span id="cb20-352"><a href="#cb20-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-355"><a href="#cb20-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-356"><a href="#cb20-356" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-357"><a href="#cb20-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-358"><a href="#cb20-358" aria-hidden="true" tabindex="-1"></a><span class="co"># Install from GitHub</span></span>
<span id="cb20-359"><a href="#cb20-359" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"username/COSERO-R"</span>)</span>
<span id="cb20-360"><a href="#cb20-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-361"><a href="#cb20-361" aria-hidden="true" tabindex="-1"></a><span class="co"># Load package</span></span>
<span id="cb20-362"><a href="#cb20-362" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(COSERO)</span>
<span id="cb20-363"><a href="#cb20-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-364"><a href="#cb20-364" aria-hidden="true" tabindex="-1"></a><span class="co"># Launch interactive app</span></span>
<span id="cb20-365"><a href="#cb20-365" aria-hidden="true" tabindex="-1"></a><span class="fu">launch_cosero_app</span>()</span>
<span id="cb20-366"><a href="#cb20-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-367"><a href="#cb20-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Or use functions directly</span></span>
<span id="cb20-368"><a href="#cb20-368" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">run_cosero</span>(<span class="st">"path/to/project"</span>)</span>
<span id="cb20-369"><a href="#cb20-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-370"><a href="#cb20-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-371"><a href="#cb20-371" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step-by-Step Tutorial: Single COSERO Run {#sec-tutorial-single}</span></span>
<span id="cb20-372"><a href="#cb20-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-373"><a href="#cb20-373" aria-hidden="true" tabindex="-1"></a>This section demonstrates how to execute a single COSERO simulation using the developed R workflow. The tutorial walks through all steps from setup to result visualization, providing a foundation for understanding the sensitivity analysis workflow presented in @sec-tutorial-sensitivity.</span>
<span id="cb20-374"><a href="#cb20-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-375"><a href="#cb20-375" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Setup and Initialization</span></span>
<span id="cb20-376"><a href="#cb20-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-377"><a href="#cb20-377" aria-hidden="true" tabindex="-1"></a>Begin by loading the required R package and setting up the working environment:</span>
<span id="cb20-378"><a href="#cb20-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-381"><a href="#cb20-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-382"><a href="#cb20-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-383"><a href="#cb20-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-384"><a href="#cb20-384" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the COSERO-R package</span></span>
<span id="cb20-385"><a href="#cb20-385" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(COSERO)</span>
<span id="cb20-386"><a href="#cb20-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-387"><a href="#cb20-387" aria-hidden="true" tabindex="-1"></a><span class="co"># Set project path (adjust to your directory)</span></span>
<span id="cb20-388"><a href="#cb20-388" aria-hidden="true" tabindex="-1"></a>project_path <span class="ot">&lt;-</span> <span class="st">"C:/COSERO_Project"</span></span>
<span id="cb20-389"><a href="#cb20-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-390"><a href="#cb20-390" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify COSERO.exe exists</span></span>
<span id="cb20-391"><a href="#cb20-391" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">file.path</span>(project_path, <span class="st">"COSERO.exe"</span>))) {</span>
<span id="cb20-392"><a href="#cb20-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"COSERO.exe not found in project directory"</span>)</span>
<span id="cb20-393"><a href="#cb20-393" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-394"><a href="#cb20-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-395"><a href="#cb20-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-396"><a href="#cb20-396" aria-hidden="true" tabindex="-1"></a>**Expected output:** If successful, no error messages will appear. The project path should contain COSERO.exe and the necessary input directories (input/, output/).</span>
<span id="cb20-397"><a href="#cb20-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-398"><a href="#cb20-398" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Configure Model Settings</span></span>
<span id="cb20-399"><a href="#cb20-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-400"><a href="#cb20-400" aria-hidden="true" tabindex="-1"></a>Define the simulation period and output options. The <span class="in">`run_cosero()`</span> function accepts a list of configuration parameters that override default settings:</span>
<span id="cb20-401"><a href="#cb20-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-404"><a href="#cb20-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-405"><a href="#cb20-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-406"><a href="#cb20-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-407"><a href="#cb20-407" aria-hidden="true" tabindex="-1"></a><span class="co"># Define simulation configuration</span></span>
<span id="cb20-408"><a href="#cb20-408" aria-hidden="true" tabindex="-1"></a>config <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb20-409"><a href="#cb20-409" aria-hidden="true" tabindex="-1"></a>  <span class="at">STARTDATE =</span> <span class="st">"2015 1 1 0 0"</span>,      <span class="co"># Start: January 1, 2015</span></span>
<span id="cb20-410"><a href="#cb20-410" aria-hidden="true" tabindex="-1"></a>  <span class="at">ENDDATE =</span> <span class="st">"2022 12 31 0 0"</span>,      <span class="co"># End: December 31, 2022</span></span>
<span id="cb20-411"><a href="#cb20-411" aria-hidden="true" tabindex="-1"></a>  <span class="at">SPINUP =</span> <span class="dv">365</span>,                     <span class="co"># 1-year warm-up period</span></span>
<span id="cb20-412"><a href="#cb20-412" aria-hidden="true" tabindex="-1"></a>  <span class="at">OUTPUTTYPE =</span> <span class="dv">3</span>,                   <span class="co"># Full output (includes long-term means)</span></span>
<span id="cb20-413"><a href="#cb20-413" aria-hidden="true" tabindex="-1"></a>  <span class="at">SC_FLAG =</span> <span class="dv">1</span>,                      <span class="co"># Use upstream catchment area</span></span>
<span id="cb20-414"><a href="#cb20-414" aria-hidden="true" tabindex="-1"></a>  <span class="at">PROJECTINFO =</span> <span class="st">"SingleRun_Example"</span></span>
<span id="cb20-415"><a href="#cb20-415" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-416"><a href="#cb20-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-417"><a href="#cb20-417" aria-hidden="true" tabindex="-1"></a><span class="co"># Display configuration</span></span>
<span id="cb20-418"><a href="#cb20-418" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(config)</span>
<span id="cb20-419"><a href="#cb20-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-420"><a href="#cb20-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-421"><a href="#cb20-421" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Run COSERO</span></span>
<span id="cb20-422"><a href="#cb20-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-423"><a href="#cb20-423" aria-hidden="true" tabindex="-1"></a>Execute the model with the specified configuration. The function returns a list containing execution status, runtime, and parsed outputs:</span>
<span id="cb20-424"><a href="#cb20-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-427"><a href="#cb20-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-428"><a href="#cb20-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-429"><a href="#cb20-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-430"><a href="#cb20-430" aria-hidden="true" tabindex="-1"></a><span class="co"># Run COSERO</span></span>
<span id="cb20-431"><a href="#cb20-431" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">run_cosero</span>(</span>
<span id="cb20-432"><a href="#cb20-432" aria-hidden="true" tabindex="-1"></a>  <span class="at">project_path =</span> project_path,</span>
<span id="cb20-433"><a href="#cb20-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaults_settings =</span> config,</span>
<span id="cb20-434"><a href="#cb20-434" aria-hidden="true" tabindex="-1"></a>  <span class="at">statevar_source =</span> <span class="dv">1</span>,     <span class="co"># Cold start from parameter file</span></span>
<span id="cb20-435"><a href="#cb20-435" aria-hidden="true" tabindex="-1"></a>  <span class="at">read_outputs =</span> <span class="cn">TRUE</span>,      <span class="co"># Parse output files automatically</span></span>
<span id="cb20-436"><a href="#cb20-436" aria-hidden="true" tabindex="-1"></a>  <span class="at">quiet =</span> <span class="cn">FALSE</span>            <span class="co"># Show progress messages</span></span>
<span id="cb20-437"><a href="#cb20-437" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-438"><a href="#cb20-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-439"><a href="#cb20-439" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if run was successful</span></span>
<span id="cb20-440"><a href="#cb20-440" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (result<span class="sc">$</span>success) {</span>
<span id="cb20-441"><a href="#cb20-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"✓ COSERO run completed successfully</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-442"><a href="#cb20-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Runtime:"</span>, <span class="fu">round</span>(result<span class="sc">$</span>runtime_seconds, <span class="dv">2</span>), <span class="st">"seconds</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-443"><a href="#cb20-443" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb20-444"><a href="#cb20-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"✗ Error:"</span>, result<span class="sc">$</span>error_message, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-445"><a href="#cb20-445" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-446"><a href="#cb20-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-447"><a href="#cb20-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-448"><a href="#cb20-448" aria-hidden="true" tabindex="-1"></a>**Expected output:**</span>
<span id="cb20-449"><a href="#cb20-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-450"><a href="#cb20-450" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb20-451"><a href="#cb20-451" aria-hidden="true" tabindex="-1"></a><span class="in">✓ COSERO run completed successfully</span></span>
<span id="cb20-452"><a href="#cb20-452" aria-hidden="true" tabindex="-1"></a><span class="in">Runtime: 45.23 seconds</span></span>
<span id="cb20-453"><a href="#cb20-453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-454"><a href="#cb20-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-455"><a href="#cb20-455" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Access Output Data</span></span>
<span id="cb20-456"><a href="#cb20-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-457"><a href="#cb20-457" aria-hidden="true" tabindex="-1"></a>The result object contains all parsed COSERO outputs organized by theme:</span>
<span id="cb20-458"><a href="#cb20-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-461"><a href="#cb20-461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-462"><a href="#cb20-462" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-463"><a href="#cb20-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-464"><a href="#cb20-464" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore available datasets</span></span>
<span id="cb20-465"><a href="#cb20-465" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(result<span class="sc">$</span>output_data)</span>
<span id="cb20-466"><a href="#cb20-466" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns: "runoff", "precipitation", "water_balance", "statistics", etc.</span></span>
<span id="cb20-467"><a href="#cb20-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-468"><a href="#cb20-468" aria-hidden="true" tabindex="-1"></a><span class="co"># Access discharge time series (m³/s)</span></span>
<span id="cb20-469"><a href="#cb20-469" aria-hidden="true" tabindex="-1"></a>discharge <span class="ot">&lt;-</span> result<span class="sc">$</span>output_data<span class="sc">$</span>runoff</span>
<span id="cb20-470"><a href="#cb20-470" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(discharge)</span>
<span id="cb20-471"><a href="#cb20-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-472"><a href="#cb20-472" aria-hidden="true" tabindex="-1"></a><span class="co"># Access performance statistics</span></span>
<span id="cb20-473"><a href="#cb20-473" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> result<span class="sc">$</span>output_data<span class="sc">$</span>statistics</span>
<span id="cb20-474"><a href="#cb20-474" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(stats[, <span class="fu">c</span>(<span class="st">"sb"</span>, <span class="st">"NSE"</span>, <span class="st">"KGE"</span>, <span class="st">"RMSE"</span>)])</span>
<span id="cb20-475"><a href="#cb20-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-476"><a href="#cb20-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-477"><a href="#cb20-477" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Calculate Performance Metrics</span></span>
<span id="cb20-478"><a href="#cb20-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-479"><a href="#cb20-479" aria-hidden="true" tabindex="-1"></a>Performance metrics are automatically calculated and stored in the statistics dataset:</span>
<span id="cb20-480"><a href="#cb20-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-483"><a href="#cb20-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-484"><a href="#cb20-484" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-485"><a href="#cb20-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-486"><a href="#cb20-486" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract metrics for main outlet (subbasin 0001)</span></span>
<span id="cb20-487"><a href="#cb20-487" aria-hidden="true" tabindex="-1"></a>main_stats <span class="ot">&lt;-</span> stats[stats<span class="sc">$</span>sb <span class="sc">==</span> <span class="st">"0001"</span>, ]</span>
<span id="cb20-488"><a href="#cb20-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-489"><a href="#cb20-489" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Model Performance:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-490"><a href="#cb20-490" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"NSE:"</span>, <span class="fu">round</span>(main_stats<span class="sc">$</span>NSE, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-491"><a href="#cb20-491" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"KGE:"</span>, <span class="fu">round</span>(main_stats<span class="sc">$</span>KGE, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-492"><a href="#cb20-492" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE:"</span>, <span class="fu">round</span>(main_stats<span class="sc">$</span>RMSE, <span class="dv">2</span>), <span class="st">"m³/s</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-493"><a href="#cb20-493" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bias:"</span>, <span class="fu">round</span>(main_stats<span class="sc">$</span>Bias, <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-494"><a href="#cb20-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-495"><a href="#cb20-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-496"><a href="#cb20-496" aria-hidden="true" tabindex="-1"></a>**Example output:**</span>
<span id="cb20-497"><a href="#cb20-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-498"><a href="#cb20-498" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb20-499"><a href="#cb20-499" aria-hidden="true" tabindex="-1"></a><span class="in">Model Performance:</span></span>
<span id="cb20-500"><a href="#cb20-500" aria-hidden="true" tabindex="-1"></a><span class="in">NSE: 0.762</span></span>
<span id="cb20-501"><a href="#cb20-501" aria-hidden="true" tabindex="-1"></a><span class="in">KGE: 0.818</span></span>
<span id="cb20-502"><a href="#cb20-502" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE: 12.45 m³/s</span></span>
<span id="cb20-503"><a href="#cb20-503" aria-hidden="true" tabindex="-1"></a><span class="in">Bias: -5.3 %</span></span>
<span id="cb20-504"><a href="#cb20-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-505"><a href="#cb20-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-506"><a href="#cb20-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Visualize Results</span></span>
<span id="cb20-507"><a href="#cb20-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-508"><a href="#cb20-508" aria-hidden="true" tabindex="-1"></a>Create time series plots to visually assess model performance:</span>
<span id="cb20-509"><a href="#cb20-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-512"><a href="#cb20-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-513"><a href="#cb20-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-514"><a href="#cb20-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-515"><a href="#cb20-515" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-516"><a href="#cb20-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-517"><a href="#cb20-517" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for plotting (subbasin 1)</span></span>
<span id="cb20-518"><a href="#cb20-518" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> discharge[, <span class="fu">c</span>(<span class="st">"DateTime"</span>, <span class="st">"Q_Obs_0001"</span>, <span class="st">"Q_Sim_0001"</span>)]</span>
<span id="cb20-519"><a href="#cb20-519" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(plot_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"DateTime"</span>, <span class="st">"Observed"</span>, <span class="st">"Simulated"</span>)</span>
<span id="cb20-520"><a href="#cb20-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-521"><a href="#cb20-521" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape to long format</span></span>
<span id="cb20-522"><a href="#cb20-522" aria-hidden="true" tabindex="-1"></a>plot_data_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb20-523"><a href="#cb20-523" aria-hidden="true" tabindex="-1"></a>  plot_data, </span>
<span id="cb20-524"><a href="#cb20-524" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Simulated"</span>),</span>
<span id="cb20-525"><a href="#cb20-525" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"Type"</span>,</span>
<span id="cb20-526"><a href="#cb20-526" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"Discharge"</span></span>
<span id="cb20-527"><a href="#cb20-527" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-528"><a href="#cb20-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-529"><a href="#cb20-529" aria-hidden="true" tabindex="-1"></a><span class="co"># Create time series plot</span></span>
<span id="cb20-530"><a href="#cb20-530" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data_long, <span class="fu">aes</span>(<span class="at">x =</span> DateTime, <span class="at">y =</span> Discharge, <span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb20-531"><a href="#cb20-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-532"><a href="#cb20-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Observed"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Simulated"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb20-533"><a href="#cb20-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Discharge Comparison"</span>,</span>
<span id="cb20-534"><a href="#cb20-534" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Date"</span>, <span class="at">y =</span> <span class="st">"Discharge (m³/s)"</span>) <span class="sc">+</span></span>
<span id="cb20-535"><a href="#cb20-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb20-536"><a href="#cb20-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-537"><a href="#cb20-537" aria-hidden="true" tabindex="-1"></a><span class="co"># Save plot</span></span>
<span id="cb20-538"><a href="#cb20-538" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"discharge_plot.png"</span>, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb20-539"><a href="#cb20-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-540"><a href="#cb20-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-541"><a href="#cb20-541" aria-hidden="true" tabindex="-1"></a>This produces a time series plot showing observed (blue) versus simulated (red) discharge over the entire simulation period.</span>
<span id="cb20-542"><a href="#cb20-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-543"><a href="#cb20-543" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Launch Interactive Visualization</span></span>
<span id="cb20-544"><a href="#cb20-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-545"><a href="#cb20-545" aria-hidden="true" tabindex="-1"></a>For interactive exploration of results, launch the built-in Shiny app:</span>
<span id="cb20-546"><a href="#cb20-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-549"><a href="#cb20-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-550"><a href="#cb20-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-551"><a href="#cb20-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-552"><a href="#cb20-552" aria-hidden="true" tabindex="-1"></a><span class="co"># Launch interactive visualization app</span></span>
<span id="cb20-553"><a href="#cb20-553" aria-hidden="true" tabindex="-1"></a><span class="fu">launch_cosero_app</span>()</span>
<span id="cb20-554"><a href="#cb20-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-555"><a href="#cb20-555" aria-hidden="true" tabindex="-1"></a><span class="co"># In the app:</span></span>
<span id="cb20-556"><a href="#cb20-556" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Enter the output directory path</span></span>
<span id="cb20-557"><a href="#cb20-557" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Click "Load Data"</span></span>
<span id="cb20-558"><a href="#cb20-558" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Select subbasin from dropdown</span></span>
<span id="cb20-559"><a href="#cb20-559" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Explore interactive plots with zoom/pan</span></span>
<span id="cb20-560"><a href="#cb20-560" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Export plots or data as needed</span></span>
<span id="cb20-561"><a href="#cb20-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-562"><a href="#cb20-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-563"><a href="#cb20-563" aria-hidden="true" tabindex="-1"></a>The interactive app provides four synchronized plots (discharge, precipitation, runoff components, water balance) with zoom, pan, and export functionality.</span>
<span id="cb20-564"><a href="#cb20-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-565"><a href="#cb20-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
<span id="cb20-566"><a href="#cb20-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-567"><a href="#cb20-567" aria-hidden="true" tabindex="-1"></a>This tutorial demonstrated a complete single COSERO run workflow in seven steps:</span>
<span id="cb20-568"><a href="#cb20-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-569"><a href="#cb20-569" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Setup and verify project structure</span>
<span id="cb20-570"><a href="#cb20-570" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Configure simulation settings</span>
<span id="cb20-571"><a href="#cb20-571" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Execute COSERO model</span>
<span id="cb20-572"><a href="#cb20-572" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Access parsed output data</span>
<span id="cb20-573"><a href="#cb20-573" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Extract performance metrics</span>
<span id="cb20-574"><a href="#cb20-574" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Create static visualizations</span>
<span id="cb20-575"><a href="#cb20-575" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Launch interactive exploration tool</span>
<span id="cb20-576"><a href="#cb20-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-577"><a href="#cb20-577" aria-hidden="true" tabindex="-1"></a>This workflow forms the foundation for the sensitivity analysis presented in the next section, where these steps are automated and repeated thousands of times with different parameter combinations.</span>
<span id="cb20-578"><a href="#cb20-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-579"><a href="#cb20-579" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step-by-Step Tutorial: Sensitivity Analysis {#sec-tutorial-sensitivity}</span></span>
<span id="cb20-580"><a href="#cb20-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-581"><a href="#cb20-581" aria-hidden="true" tabindex="-1"></a>This section presents a comprehensive tutorial for conducting Monte Carlo-based sensitivity analysis using the COSERO-R workflow. The tutorial demonstrates parameter sampling, batch model execution, results aggregation, and sensitivity index calculation.</span>
<span id="cb20-582"><a href="#cb20-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-583"><a href="#cb20-583" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 1: Load Parameter Bounds</span></span>
<span id="cb20-584"><a href="#cb20-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-585"><a href="#cb20-585" aria-hidden="true" tabindex="-1"></a>Define the parameter space by specifying minimum and maximum values for each parameter:</span>
<span id="cb20-586"><a href="#cb20-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-589"><a href="#cb20-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-590"><a href="#cb20-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-591"><a href="#cb20-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-592"><a href="#cb20-592" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(COSERO)</span>
<span id="cb20-593"><a href="#cb20-593" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sensitivity)  <span class="co"># For Sobol analysis</span></span>
<span id="cb20-594"><a href="#cb20-594" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randtoolbox)  <span class="co"># For Sobol sampling</span></span>
<span id="cb20-595"><a href="#cb20-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-596"><a href="#cb20-596" aria-hidden="true" tabindex="-1"></a><span class="co"># Load parameter bounds from package</span></span>
<span id="cb20-597"><a href="#cb20-597" aria-hidden="true" tabindex="-1"></a>param_bounds <span class="ot">&lt;-</span> <span class="fu">load_parameter_bounds</span>()</span>
<span id="cb20-598"><a href="#cb20-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-599"><a href="#cb20-599" aria-hidden="true" tabindex="-1"></a><span class="co"># Or create custom bounds</span></span>
<span id="cb20-600"><a href="#cb20-600" aria-hidden="true" tabindex="-1"></a>param_bounds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-601"><a href="#cb20-601" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameter =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"TAB1"</span>, <span class="st">"TAB2"</span>, <span class="st">"TAB3"</span>, <span class="st">"TVS1"</span>, </span>
<span id="cb20-602"><a href="#cb20-602" aria-hidden="true" tabindex="-1"></a>                <span class="st">"TVS2"</span>, <span class="st">"KBF"</span>, <span class="st">"H1"</span>, <span class="st">"H2"</span>),</span>
<span id="cb20-603"><a href="#cb20-603" aria-hidden="true" tabindex="-1"></a>  <span class="at">min =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">1000</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">2000</span>, <span class="fl">0.2</span>, <span class="dv">5</span>),</span>
<span id="cb20-604"><a href="#cb20-604" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="fu">c</span>(<span class="dv">800</span>, <span class="dv">50</span>, <span class="dv">300</span>, <span class="dv">5000</span>, <span class="dv">70</span>, <span class="dv">700</span>, <span class="dv">7000</span>, <span class="fl">1.0</span>, <span class="dv">20</span>)</span>
<span id="cb20-605"><a href="#cb20-605" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-606"><a href="#cb20-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-607"><a href="#cb20-607" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(param_bounds)</span>
<span id="cb20-608"><a href="#cb20-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-609"><a href="#cb20-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-610"><a href="#cb20-610" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 2: Generate Sobol Parameter Samples</span></span>
<span id="cb20-611"><a href="#cb20-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-612"><a href="#cb20-612" aria-hidden="true" tabindex="-1"></a>Create parameter combinations using Sobol quasi-random sequences for efficient space-filling:</span>
<span id="cb20-613"><a href="#cb20-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-616"><a href="#cb20-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-617"><a href="#cb20-617" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-618"><a href="#cb20-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-619"><a href="#cb20-619" aria-hidden="true" tabindex="-1"></a><span class="co"># Set number of samples</span></span>
<span id="cb20-620"><a href="#cb20-620" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">5500</span></span>
<span id="cb20-621"><a href="#cb20-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-622"><a href="#cb20-622" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Sobol sequence</span></span>
<span id="cb20-623"><a href="#cb20-623" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb20-624"><a href="#cb20-624" aria-hidden="true" tabindex="-1"></a>sobol_seq <span class="ot">&lt;-</span> <span class="fu">sobol</span>(<span class="at">n =</span> n_samples, <span class="at">dim =</span> <span class="fu">nrow</span>(param_bounds))</span>
<span id="cb20-625"><a href="#cb20-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-626"><a href="#cb20-626" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale to parameter ranges</span></span>
<span id="cb20-627"><a href="#cb20-627" aria-hidden="true" tabindex="-1"></a>param_samples <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sobol_seq)</span>
<span id="cb20-628"><a href="#cb20-628" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(param_samples) <span class="ot">&lt;-</span> param_bounds<span class="sc">$</span>parameter</span>
<span id="cb20-629"><a href="#cb20-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-630"><a href="#cb20-630" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(param_bounds)) {</span>
<span id="cb20-631"><a href="#cb20-631" aria-hidden="true" tabindex="-1"></a>  param_name <span class="ot">&lt;-</span> param_bounds<span class="sc">$</span>parameter[i]</span>
<span id="cb20-632"><a href="#cb20-632" aria-hidden="true" tabindex="-1"></a>  param_samples[[param_name]] <span class="ot">&lt;-</span> </span>
<span id="cb20-633"><a href="#cb20-633" aria-hidden="true" tabindex="-1"></a>    param_bounds<span class="sc">$</span>min[i] <span class="sc">+</span> </span>
<span id="cb20-634"><a href="#cb20-634" aria-hidden="true" tabindex="-1"></a>    param_samples[[param_name]] <span class="sc">*</span> </span>
<span id="cb20-635"><a href="#cb20-635" aria-hidden="true" tabindex="-1"></a>    (param_bounds<span class="sc">$</span>max[i] <span class="sc">-</span> param_bounds<span class="sc">$</span>min[i])</span>
<span id="cb20-636"><a href="#cb20-636" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-637"><a href="#cb20-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-638"><a href="#cb20-638" aria-hidden="true" tabindex="-1"></a><span class="co"># Add simulation ID</span></span>
<span id="cb20-639"><a href="#cb20-639" aria-hidden="true" tabindex="-1"></a>param_samples<span class="sc">$</span>SimID <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_samples</span>
<span id="cb20-640"><a href="#cb20-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-641"><a href="#cb20-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview samples</span></span>
<span id="cb20-642"><a href="#cb20-642" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(param_samples)</span>
<span id="cb20-643"><a href="#cb20-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-644"><a href="#cb20-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-645"><a href="#cb20-645" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 3: Setup Batch Execution</span></span>
<span id="cb20-646"><a href="#cb20-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-647"><a href="#cb20-647" aria-hidden="true" tabindex="-1"></a>Prepare for batch model execution by setting up directories and initializing result storage:</span>
<span id="cb20-648"><a href="#cb20-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-651"><a href="#cb20-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-652"><a href="#cb20-652" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-653"><a href="#cb20-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-654"><a href="#cb20-654" aria-hidden="true" tabindex="-1"></a><span class="co"># Define paths</span></span>
<span id="cb20-655"><a href="#cb20-655" aria-hidden="true" tabindex="-1"></a>project_path <span class="ot">&lt;-</span> <span class="st">"C:/COSERO_Project"</span></span>
<span id="cb20-656"><a href="#cb20-656" aria-hidden="true" tabindex="-1"></a>results_dir <span class="ot">&lt;-</span> <span class="st">"C:/COSERO_Results/SensitivityAnalysis"</span></span>
<span id="cb20-657"><a href="#cb20-657" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(results_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-658"><a href="#cb20-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-659"><a href="#cb20-659" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize results storage</span></span>
<span id="cb20-660"><a href="#cb20-660" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-661"><a href="#cb20-661" aria-hidden="true" tabindex="-1"></a>  <span class="at">SimID =</span> <span class="fu">integer</span>(),</span>
<span id="cb20-662"><a href="#cb20-662" aria-hidden="true" tabindex="-1"></a>  <span class="at">NSE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-663"><a href="#cb20-663" aria-hidden="true" tabindex="-1"></a>  <span class="at">KGE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-664"><a href="#cb20-664" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-665"><a href="#cb20-665" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bias =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-666"><a href="#cb20-666" aria-hidden="true" tabindex="-1"></a>  <span class="at">Runtime =</span> <span class="fu">numeric</span>(),</span>
<span id="cb20-667"><a href="#cb20-667" aria-hidden="true" tabindex="-1"></a>  <span class="at">Success =</span> <span class="fu">logical</span>()</span>
<span id="cb20-668"><a href="#cb20-668" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-669"><a href="#cb20-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-670"><a href="#cb20-670" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration for all runs</span></span>
<span id="cb20-671"><a href="#cb20-671" aria-hidden="true" tabindex="-1"></a>base_config <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb20-672"><a href="#cb20-672" aria-hidden="true" tabindex="-1"></a>  <span class="at">STARTDATE =</span> <span class="st">"2015 1 1 0 0"</span>,</span>
<span id="cb20-673"><a href="#cb20-673" aria-hidden="true" tabindex="-1"></a>  <span class="at">ENDDATE =</span> <span class="st">"2022 12 31 0 0"</span>,</span>
<span id="cb20-674"><a href="#cb20-674" aria-hidden="true" tabindex="-1"></a>  <span class="at">SPINUP =</span> <span class="dv">365</span>,</span>
<span id="cb20-675"><a href="#cb20-675" aria-hidden="true" tabindex="-1"></a>  <span class="at">OUTPUTTYPE =</span> <span class="dv">1</span>  <span class="co"># Minimal output for speed</span></span>
<span id="cb20-676"><a href="#cb20-676" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-677"><a href="#cb20-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-678"><a href="#cb20-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-679"><a href="#cb20-679" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 4: Execute Monte Carlo Simulations</span></span>
<span id="cb20-680"><a href="#cb20-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-681"><a href="#cb20-681" aria-hidden="true" tabindex="-1"></a>Run COSERO for each parameter combination with progress tracking and error handling:</span>
<span id="cb20-682"><a href="#cb20-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-685"><a href="#cb20-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-686"><a href="#cb20-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-687"><a href="#cb20-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-688"><a href="#cb20-688" aria-hidden="true" tabindex="-1"></a><span class="co"># Progress tracking</span></span>
<span id="cb20-689"><a href="#cb20-689" aria-hidden="true" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb20-690"><a href="#cb20-690" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(param_samples)</span>
<span id="cb20-691"><a href="#cb20-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-692"><a href="#cb20-692" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through parameter combinations</span></span>
<span id="cb20-693"><a href="#cb20-693" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_total) {</span>
<span id="cb20-694"><a href="#cb20-694" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Progress update every 100 simulations</span></span>
<span id="cb20-695"><a href="#cb20-695" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb20-696"><a href="#cb20-696" aria-hidden="true" tabindex="-1"></a>    elapsed <span class="ot">&lt;-</span> <span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), start_time, <span class="at">units =</span> <span class="st">"mins"</span>)</span>
<span id="cb20-697"><a href="#cb20-697" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Progress: %d/%d (%.1f%%) | Elapsed: %.1f min</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb20-698"><a href="#cb20-698" aria-hidden="true" tabindex="-1"></a>                i, n_total, <span class="dv">100</span><span class="sc">*</span>i<span class="sc">/</span>n_total, elapsed))</span>
<span id="cb20-699"><a href="#cb20-699" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-700"><a href="#cb20-700" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-701"><a href="#cb20-701" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get parameters for this run</span></span>
<span id="cb20-702"><a href="#cb20-702" aria-hidden="true" tabindex="-1"></a>  params <span class="ot">&lt;-</span> param_samples[i, ]</span>
<span id="cb20-703"><a href="#cb20-703" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-704"><a href="#cb20-704" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update parameter file (custom function)</span></span>
<span id="cb20-705"><a href="#cb20-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_cosero_parameters</span>(project_path, params)</span>
<span id="cb20-706"><a href="#cb20-706" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-707"><a href="#cb20-707" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run COSERO</span></span>
<span id="cb20-708"><a href="#cb20-708" aria-hidden="true" tabindex="-1"></a>  run_result <span class="ot">&lt;-</span> <span class="fu">run_cosero</span>(</span>
<span id="cb20-709"><a href="#cb20-709" aria-hidden="true" tabindex="-1"></a>    <span class="at">project_path =</span> project_path,</span>
<span id="cb20-710"><a href="#cb20-710" aria-hidden="true" tabindex="-1"></a>    <span class="at">defaults_settings =</span> base_config,</span>
<span id="cb20-711"><a href="#cb20-711" aria-hidden="true" tabindex="-1"></a>    <span class="at">read_outputs =</span> <span class="cn">FALSE</span>,  <span class="co"># Read manually for metrics only</span></span>
<span id="cb20-712"><a href="#cb20-712" aria-hidden="true" tabindex="-1"></a>    <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="cb20-713"><a href="#cb20-713" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-714"><a href="#cb20-714" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-715"><a href="#cb20-715" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract metrics if successful</span></span>
<span id="cb20-716"><a href="#cb20-716" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (run_result<span class="sc">$</span>success) {</span>
<span id="cb20-717"><a href="#cb20-717" aria-hidden="true" tabindex="-1"></a>    stats <span class="ot">&lt;-</span> <span class="fu">read_cosero_statistics</span>(</span>
<span id="cb20-718"><a href="#cb20-718" aria-hidden="true" tabindex="-1"></a>      <span class="fu">file.path</span>(project_path, <span class="st">"output"</span>, <span class="st">"statistics.txt"</span>)</span>
<span id="cb20-719"><a href="#cb20-719" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-720"><a href="#cb20-720" aria-hidden="true" tabindex="-1"></a>    main_stats <span class="ot">&lt;-</span> stats[stats<span class="sc">$</span>sb <span class="sc">==</span> <span class="st">"0001"</span>, ]</span>
<span id="cb20-721"><a href="#cb20-721" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-722"><a href="#cb20-722" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb20-723"><a href="#cb20-723" aria-hidden="true" tabindex="-1"></a>      <span class="at">SimID =</span> i,</span>
<span id="cb20-724"><a href="#cb20-724" aria-hidden="true" tabindex="-1"></a>      <span class="at">NSE =</span> main_stats<span class="sc">$</span>NSE,</span>
<span id="cb20-725"><a href="#cb20-725" aria-hidden="true" tabindex="-1"></a>      <span class="at">KGE =</span> main_stats<span class="sc">$</span>KGE,</span>
<span id="cb20-726"><a href="#cb20-726" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE =</span> main_stats<span class="sc">$</span>RMSE,</span>
<span id="cb20-727"><a href="#cb20-727" aria-hidden="true" tabindex="-1"></a>      <span class="at">Bias =</span> main_stats<span class="sc">$</span>Bias,</span>
<span id="cb20-728"><a href="#cb20-728" aria-hidden="true" tabindex="-1"></a>      <span class="at">Runtime =</span> run_result<span class="sc">$</span>runtime_seconds,</span>
<span id="cb20-729"><a href="#cb20-729" aria-hidden="true" tabindex="-1"></a>      <span class="at">Success =</span> <span class="cn">TRUE</span></span>
<span id="cb20-730"><a href="#cb20-730" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb20-731"><a href="#cb20-731" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb20-732"><a href="#cb20-732" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Record failed run</span></span>
<span id="cb20-733"><a href="#cb20-733" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(</span>
<span id="cb20-734"><a href="#cb20-734" aria-hidden="true" tabindex="-1"></a>      <span class="at">SimID =</span> i, <span class="at">NSE =</span> <span class="cn">NA</span>, <span class="at">KGE =</span> <span class="cn">NA</span>, </span>
<span id="cb20-735"><a href="#cb20-735" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE =</span> <span class="cn">NA</span>, <span class="at">Bias =</span> <span class="cn">NA</span>,</span>
<span id="cb20-736"><a href="#cb20-736" aria-hidden="true" tabindex="-1"></a>      <span class="at">Runtime =</span> run_result<span class="sc">$</span>runtime_seconds,</span>
<span id="cb20-737"><a href="#cb20-737" aria-hidden="true" tabindex="-1"></a>      <span class="at">Success =</span> <span class="cn">FALSE</span></span>
<span id="cb20-738"><a href="#cb20-738" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb20-739"><a href="#cb20-739" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-740"><a href="#cb20-740" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-741"><a href="#cb20-741" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save progress every 500 runs</span></span>
<span id="cb20-742"><a href="#cb20-742" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">500</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb20-743"><a href="#cb20-743" aria-hidden="true" tabindex="-1"></a>    <span class="fu">saveRDS</span>(results, <span class="fu">file.path</span>(results_dir, <span class="st">"results_checkpoint.rds"</span>))</span>
<span id="cb20-744"><a href="#cb20-744" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-745"><a href="#cb20-745" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-746"><a href="#cb20-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-747"><a href="#cb20-747" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">All simulations complete!</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-748"><a href="#cb20-748" aria-hidden="true" tabindex="-1"></a>total_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(<span class="fu">Sys.time</span>(), start_time, <span class="at">units =</span> <span class="st">"hours"</span>)</span>
<span id="cb20-749"><a href="#cb20-749" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total runtime:"</span>, <span class="fu">round</span>(total_time, <span class="dv">2</span>), <span class="st">"hours</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-750"><a href="#cb20-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-751"><a href="#cb20-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-752"><a href="#cb20-752" aria-hidden="true" tabindex="-1"></a>**Expected output:** Progress messages every 100 simulations showing percentage complete and elapsed time. For 5,500 simulations, total runtime is typically 15-30 hours depending on hardware.</span>
<span id="cb20-753"><a href="#cb20-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-754"><a href="#cb20-754" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 5: Merge Results with Parameters</span></span>
<span id="cb20-755"><a href="#cb20-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-756"><a href="#cb20-756" aria-hidden="true" tabindex="-1"></a>Combine performance metrics with parameter values for analysis:</span>
<span id="cb20-757"><a href="#cb20-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-760"><a href="#cb20-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-761"><a href="#cb20-761" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-762"><a href="#cb20-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-763"><a href="#cb20-763" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge results with parameter samples</span></span>
<span id="cb20-764"><a href="#cb20-764" aria-hidden="true" tabindex="-1"></a>full_results <span class="ot">&lt;-</span> <span class="fu">merge</span>(param_samples, results, <span class="at">by =</span> <span class="st">"SimID"</span>)</span>
<span id="cb20-765"><a href="#cb20-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-766"><a href="#cb20-766" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb20-767"><a href="#cb20-767" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Simulation Summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-768"><a href="#cb20-768" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total runs:"</span>, <span class="fu">nrow</span>(full_results), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-769"><a href="#cb20-769" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Successful:"</span>, <span class="fu">sum</span>(full_results<span class="sc">$</span>Success), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-770"><a href="#cb20-770" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Failed:"</span>, <span class="fu">sum</span>(<span class="sc">!</span>full_results<span class="sc">$</span>Success), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-771"><a href="#cb20-771" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">NSE Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-772"><a href="#cb20-772" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(full_results<span class="sc">$</span>NSE[full_results<span class="sc">$</span>Success]))</span>
<span id="cb20-773"><a href="#cb20-773" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">KGE Statistics:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-774"><a href="#cb20-774" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(full_results<span class="sc">$</span>KGE[full_results<span class="sc">$</span>Success]))</span>
<span id="cb20-775"><a href="#cb20-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-776"><a href="#cb20-776" aria-hidden="true" tabindex="-1"></a><span class="co"># Save complete results</span></span>
<span id="cb20-777"><a href="#cb20-777" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(full_results, </span>
<span id="cb20-778"><a href="#cb20-778" aria-hidden="true" tabindex="-1"></a>          <span class="fu">file.path</span>(results_dir, <span class="st">"sensitivity_results_complete.csv"</span>),</span>
<span id="cb20-779"><a href="#cb20-779" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-780"><a href="#cb20-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-781"><a href="#cb20-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-782"><a href="#cb20-782" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 6: Calculate Sobol Sensitivity Indices</span></span>
<span id="cb20-783"><a href="#cb20-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-784"><a href="#cb20-784" aria-hidden="true" tabindex="-1"></a>Compute variance-based sensitivity indices for each parameter:</span>
<span id="cb20-785"><a href="#cb20-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-788"><a href="#cb20-788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-789"><a href="#cb20-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-790"><a href="#cb20-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-791"><a href="#cb20-791" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sensitivity)</span>
<span id="cb20-792"><a href="#cb20-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-793"><a href="#cb20-793" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for Sobol analysis</span></span>
<span id="cb20-794"><a href="#cb20-794" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> full_results[full_results<span class="sc">$</span>Success, param_bounds<span class="sc">$</span>parameter]</span>
<span id="cb20-795"><a href="#cb20-795" aria-hidden="true" tabindex="-1"></a>Y_NSE <span class="ot">&lt;-</span> full_results<span class="sc">$</span>NSE[full_results<span class="sc">$</span>Success]</span>
<span id="cb20-796"><a href="#cb20-796" aria-hidden="true" tabindex="-1"></a>Y_KGE <span class="ot">&lt;-</span> full_results<span class="sc">$</span>KGE[full_results<span class="sc">$</span>Success]</span>
<span id="cb20-797"><a href="#cb20-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-798"><a href="#cb20-798" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Sobol indices for NSE</span></span>
<span id="cb20-799"><a href="#cb20-799" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb20-800"><a href="#cb20-800" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> X[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>), ]</span>
<span id="cb20-801"><a href="#cb20-801" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> X[(n<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n, ]</span>
<span id="cb20-802"><a href="#cb20-802" aria-hidden="true" tabindex="-1"></a>sobol_nse <span class="ot">&lt;-</span> <span class="fu">sobolSalt</span>(<span class="at">model =</span> <span class="cn">NULL</span>, <span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2,</span>
<span id="cb20-803"><a href="#cb20-803" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scheme =</span> <span class="st">"A"</span>, <span class="at">nboot =</span> <span class="dv">100</span>)</span>
<span id="cb20-804"><a href="#cb20-804" aria-hidden="true" tabindex="-1"></a><span class="fu">tell</span>(sobol_nse, Y_NSE[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)])</span>
<span id="cb20-805"><a href="#cb20-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-806"><a href="#cb20-806" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Sobol indices for KGE</span></span>
<span id="cb20-807"><a href="#cb20-807" aria-hidden="true" tabindex="-1"></a>sobol_kge <span class="ot">&lt;-</span> <span class="fu">sobolSalt</span>(<span class="at">model =</span> <span class="cn">NULL</span>, <span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2,</span>
<span id="cb20-808"><a href="#cb20-808" aria-hidden="true" tabindex="-1"></a>                       <span class="at">scheme =</span> <span class="st">"A"</span>, <span class="at">nboot =</span> <span class="dv">100</span>)</span>
<span id="cb20-809"><a href="#cb20-809" aria-hidden="true" tabindex="-1"></a><span class="fu">tell</span>(sobol_kge, Y_KGE[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)])</span>
<span id="cb20-810"><a href="#cb20-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-811"><a href="#cb20-811" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and display results</span></span>
<span id="cb20-812"><a href="#cb20-812" aria-hidden="true" tabindex="-1"></a>sobol_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-813"><a href="#cb20-813" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> param_bounds<span class="sc">$</span>parameter,</span>
<span id="cb20-814"><a href="#cb20-814" aria-hidden="true" tabindex="-1"></a>  <span class="at">S_NSE =</span> sobol_nse<span class="sc">$</span>S<span class="sc">$</span>original,      <span class="co"># First-order</span></span>
<span id="cb20-815"><a href="#cb20-815" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_NSE =</span> sobol_nse<span class="sc">$</span>T<span class="sc">$</span>original,      <span class="co"># Total-order</span></span>
<span id="cb20-816"><a href="#cb20-816" aria-hidden="true" tabindex="-1"></a>  <span class="at">S_KGE =</span> sobol_kge<span class="sc">$</span>S<span class="sc">$</span>original,</span>
<span id="cb20-817"><a href="#cb20-817" aria-hidden="true" tabindex="-1"></a>  <span class="at">T_KGE =</span> sobol_kge<span class="sc">$</span>T<span class="sc">$</span>original</span>
<span id="cb20-818"><a href="#cb20-818" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-819"><a href="#cb20-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-820"><a href="#cb20-820" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sobol_results)</span>
<span id="cb20-821"><a href="#cb20-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-822"><a href="#cb20-822" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Sobol indices</span></span>
<span id="cb20-823"><a href="#cb20-823" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(sobol_results,</span>
<span id="cb20-824"><a href="#cb20-824" aria-hidden="true" tabindex="-1"></a>          <span class="fu">file.path</span>(results_dir, <span class="st">"sobol_indices.csv"</span>),</span>
<span id="cb20-825"><a href="#cb20-825" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-826"><a href="#cb20-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-827"><a href="#cb20-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-828"><a href="#cb20-828" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 7: Create Visualizations</span></span>
<span id="cb20-829"><a href="#cb20-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-830"><a href="#cb20-830" aria-hidden="true" tabindex="-1"></a>Generate comprehensive visualizations to interpret sensitivity analysis results:</span>
<span id="cb20-831"><a href="#cb20-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-834"><a href="#cb20-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-835"><a href="#cb20-835" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-836"><a href="#cb20-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-837"><a href="#cb20-837" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-838"><a href="#cb20-838" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb20-839"><a href="#cb20-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-840"><a href="#cb20-840" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Sobol Sensitivity Bar Chart</span></span>
<span id="cb20-841"><a href="#cb20-841" aria-hidden="true" tabindex="-1"></a>sobol_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(sobol_results, <span class="at">id.vars =</span> <span class="st">"Parameter"</span>,</span>
<span id="cb20-842"><a href="#cb20-842" aria-hidden="true" tabindex="-1"></a>                    <span class="at">variable.name =</span> <span class="st">"Index"</span>, <span class="at">value.name =</span> <span class="st">"Value"</span>)</span>
<span id="cb20-843"><a href="#cb20-843" aria-hidden="true" tabindex="-1"></a>sobol_long<span class="sc">$</span>Metric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"NSE"</span>, sobol_long<span class="sc">$</span>Index), <span class="st">"NSE"</span>, <span class="st">"KGE"</span>)</span>
<span id="cb20-844"><a href="#cb20-844" aria-hidden="true" tabindex="-1"></a>sobol_long<span class="sc">$</span>Order <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^S_"</span>, sobol_long<span class="sc">$</span>Index), </span>
<span id="cb20-845"><a href="#cb20-845" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"First-order"</span>, <span class="st">"Total-order"</span>)</span>
<span id="cb20-846"><a href="#cb20-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-847"><a href="#cb20-847" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(sobol_long, Order <span class="sc">==</span> <span class="st">"Total-order"</span>),</span>
<span id="cb20-848"><a href="#cb20-848" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Parameter, Value), <span class="at">y =</span> Value, <span class="at">fill =</span> Metric)) <span class="sc">+</span></span>
<span id="cb20-849"><a href="#cb20-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb20-850"><a href="#cb20-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb20-851"><a href="#cb20-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sobol Total-Order Sensitivity Indices"</span>,</span>
<span id="cb20-852"><a href="#cb20-852" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Parameter"</span>, <span class="at">y =</span> <span class="st">"Sensitivity Index"</span>) <span class="sc">+</span></span>
<span id="cb20-853"><a href="#cb20-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb20-854"><a href="#cb20-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-855"><a href="#cb20-855" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(results_dir, <span class="st">"sobol_indices.png"</span>), </span>
<span id="cb20-856"><a href="#cb20-856" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb20-857"><a href="#cb20-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-858"><a href="#cb20-858" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Dotty Plots (Parameter vs NSE)</span></span>
<span id="cb20-859"><a href="#cb20-859" aria-hidden="true" tabindex="-1"></a>params_to_plot <span class="ot">&lt;-</span> param_bounds<span class="sc">$</span>parameter</span>
<span id="cb20-860"><a href="#cb20-860" aria-hidden="true" tabindex="-1"></a>plot_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-861"><a href="#cb20-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-862"><a href="#cb20-862" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (param <span class="cf">in</span> params_to_plot) {</span>
<span id="cb20-863"><a href="#cb20-863" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(full_results[full_results<span class="sc">$</span>Success, ],</span>
<span id="cb20-864"><a href="#cb20-864" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes_string</span>(<span class="at">x =</span> param, <span class="at">y =</span> <span class="st">"NSE"</span>)) <span class="sc">+</span></span>
<span id="cb20-865"><a href="#cb20-865" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb20-866"><a href="#cb20-866" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> param, <span class="at">x =</span> param, <span class="at">y =</span> <span class="st">"NSE"</span>) <span class="sc">+</span></span>
<span id="cb20-867"><a href="#cb20-867" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb20-868"><a href="#cb20-868" aria-hidden="true" tabindex="-1"></a>  plot_list[[param]] <span class="ot">&lt;-</span> p</span>
<span id="cb20-869"><a href="#cb20-869" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-870"><a href="#cb20-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-871"><a href="#cb20-871" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange in grid</span></span>
<span id="cb20-872"><a href="#cb20-872" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb20-873"><a href="#cb20-873" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plot_list, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb20-874"><a href="#cb20-874" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(results_dir, <span class="st">"dotty_plots_nse.png"</span>),</span>
<span id="cb20-875"><a href="#cb20-875" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">12</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb20-876"><a href="#cb20-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-877"><a href="#cb20-877" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Parameter Correlation Heatmap</span></span>
<span id="cb20-878"><a href="#cb20-878" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(full_results[full_results<span class="sc">$</span>Success, </span>
<span id="cb20-879"><a href="#cb20-879" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">c</span>(params_to_plot, <span class="st">"NSE"</span>, <span class="st">"KGE"</span>)])</span>
<span id="cb20-880"><a href="#cb20-880" aria-hidden="true" tabindex="-1"></a>cor_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(cor_matrix)</span>
<span id="cb20-881"><a href="#cb20-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-882"><a href="#cb20-882" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cor_long, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb20-883"><a href="#cb20-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb20-884"><a href="#cb20-884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb20-885"><a href="#cb20-885" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb20-886"><a href="#cb20-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parameter Correlations"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb20-887"><a href="#cb20-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-888"><a href="#cb20-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb20-889"><a href="#cb20-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-890"><a href="#cb20-890" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">file.path</span>(results_dir, <span class="st">"correlation_heatmap.png"</span>),</span>
<span id="cb20-891"><a href="#cb20-891" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb20-892"><a href="#cb20-892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-893"><a href="#cb20-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-894"><a href="#cb20-894" aria-hidden="true" tabindex="-1"></a><span class="fu">### Step 8: Identify Behavioral Parameter Sets</span></span>
<span id="cb20-895"><a href="#cb20-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-896"><a href="#cb20-896" aria-hidden="true" tabindex="-1"></a>Extract parameter combinations that achieve acceptable model performance:</span>
<span id="cb20-897"><a href="#cb20-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-900"><a href="#cb20-900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-901"><a href="#cb20-901" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb20-902"><a href="#cb20-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-903"><a href="#cb20-903" aria-hidden="true" tabindex="-1"></a><span class="co"># Define behavioral threshold</span></span>
<span id="cb20-904"><a href="#cb20-904" aria-hidden="true" tabindex="-1"></a>nse_threshold <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Common acceptability criterion</span></span>
<span id="cb20-905"><a href="#cb20-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-906"><a href="#cb20-906" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter behavioral simulations</span></span>
<span id="cb20-907"><a href="#cb20-907" aria-hidden="true" tabindex="-1"></a>behavioral <span class="ot">&lt;-</span> full_results[full_results<span class="sc">$</span>NSE <span class="sc">&gt;=</span> nse_threshold <span class="sc">&amp;</span> </span>
<span id="cb20-908"><a href="#cb20-908" aria-hidden="true" tabindex="-1"></a>                           full_results<span class="sc">$</span>Success, ]</span>
<span id="cb20-909"><a href="#cb20-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-910"><a href="#cb20-910" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Behavioral Simulations:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-911"><a href="#cb20-911" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Total behavioral:"</span>, <span class="fu">nrow</span>(behavioral), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-912"><a href="#cb20-912" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Percentage:"</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">nrow</span>(behavioral) <span class="sc">/</span> <span class="fu">sum</span>(full_results<span class="sc">$</span>Success), <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-913"><a href="#cb20-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-914"><a href="#cb20-914" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate behavioral parameter ranges</span></span>
<span id="cb20-915"><a href="#cb20-915" aria-hidden="true" tabindex="-1"></a>behavioral_ranges <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-916"><a href="#cb20-916" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> param_bounds<span class="sc">$</span>parameter,</span>
<span id="cb20-917"><a href="#cb20-917" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, min),</span>
<span id="cb20-918"><a href="#cb20-918" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, max),</span>
<span id="cb20-919"><a href="#cb20-919" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, mean),</span>
<span id="cb20-920"><a href="#cb20-920" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, median),</span>
<span id="cb20-921"><a href="#cb20-921" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q25 =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, quantile, <span class="fl">0.25</span>),</span>
<span id="cb20-922"><a href="#cb20-922" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q75 =</span> <span class="fu">apply</span>(behavioral[, param_bounds<span class="sc">$</span>parameter], <span class="dv">2</span>, quantile, <span class="fl">0.75</span>)</span>
<span id="cb20-923"><a href="#cb20-923" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-924"><a href="#cb20-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-925"><a href="#cb20-925" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(behavioral_ranges)</span>
<span id="cb20-926"><a href="#cb20-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-927"><a href="#cb20-927" aria-hidden="true" tabindex="-1"></a><span class="co"># Save behavioral ranges</span></span>
<span id="cb20-928"><a href="#cb20-928" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(behavioral_ranges,</span>
<span id="cb20-929"><a href="#cb20-929" aria-hidden="true" tabindex="-1"></a>          <span class="fu">file.path</span>(results_dir, <span class="st">"behavioral_parameter_ranges.csv"</span>),</span>
<span id="cb20-930"><a href="#cb20-930" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-931"><a href="#cb20-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-932"><a href="#cb20-932" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify top 10 parameter sets</span></span>
<span id="cb20-933"><a href="#cb20-933" aria-hidden="true" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> behavioral[<span class="fu">order</span>(<span class="sc">-</span>behavioral<span class="sc">$</span>NSE), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb20-934"><a href="#cb20-934" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(top10,</span>
<span id="cb20-935"><a href="#cb20-935" aria-hidden="true" tabindex="-1"></a>          <span class="fu">file.path</span>(results_dir, <span class="st">"top10_parameter_sets.csv"</span>),</span>
<span id="cb20-936"><a href="#cb20-936" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-937"><a href="#cb20-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-938"><a href="#cb20-938" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Best NSE:"</span>, <span class="fu">max</span>(behavioral<span class="sc">$</span>NSE), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-939"><a href="#cb20-939" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best KGE:"</span>, <span class="fu">max</span>(behavioral<span class="sc">$</span>KGE), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb20-940"><a href="#cb20-940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-941"><a href="#cb20-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-942"><a href="#cb20-942" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tutorial Summary</span></span>
<span id="cb20-943"><a href="#cb20-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-944"><a href="#cb20-944" aria-hidden="true" tabindex="-1"></a>This comprehensive tutorial demonstrated the complete sensitivity analysis workflow in 8 steps:</span>
<span id="cb20-945"><a href="#cb20-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-946"><a href="#cb20-946" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Load and define parameter bounds</span>
<span id="cb20-947"><a href="#cb20-947" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Generate Sobol quasi-random parameter samples (5,500 combinations)</span>
<span id="cb20-948"><a href="#cb20-948" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Setup batch execution framework with progress tracking</span>
<span id="cb20-949"><a href="#cb20-949" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Execute Monte Carlo simulations with error handling</span>
<span id="cb20-950"><a href="#cb20-950" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Merge results with parameter values</span>
<span id="cb20-951"><a href="#cb20-951" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Calculate variance-based Sobol sensitivity indices</span>
<span id="cb20-952"><a href="#cb20-952" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Create comprehensive visualizations (sensitivity bars, dotty plots, correlation heatmaps)</span>
<span id="cb20-953"><a href="#cb20-953" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Identify behavioral parameter ranges and top-performing combinations</span>
<span id="cb20-954"><a href="#cb20-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-955"><a href="#cb20-955" aria-hidden="true" tabindex="-1"></a>The workflow is fully reproducible and can be adapted to other catchments by modifying parameter bounds and simulation settings. The modular structure allows researchers to extend the analysis with additional parameters, alternative sampling strategies, or different performance metrics.</span>
<span id="cb20-956"><a href="#cb20-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-957"><a href="#cb20-957" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sensitivity Analysis Results</span></span>
<span id="cb20-958"><a href="#cb20-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-959"><a href="#cb20-959" aria-hidden="true" tabindex="-1"></a>This section presents the results from the comprehensive sensitivity analysis of 5,500 COSERO simulations conducted using Sobol quasi-random parameter sampling. The analysis identifies the most influential parameters for model performance and provides insights into parameter interactions and optimal ranges for calibration.</span>
<span id="cb20-960"><a href="#cb20-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-961"><a href="#cb20-961" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overall Model Performance</span></span>
<span id="cb20-962"><a href="#cb20-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-963"><a href="#cb20-963" aria-hidden="true" tabindex="-1"></a>Of the 5,500 simulations, 5,500 completed successfully (100% success rate). Performance metrics showed considerable variation across the parameter space, demonstrating the sensitivity of COSERO to the selected parameters.</span>
<span id="cb20-964"><a href="#cb20-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-965"><a href="#cb20-965" aria-hidden="true" tabindex="-1"></a>**Performance Metric Distributions:**</span>
<span id="cb20-966"><a href="#cb20-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-967"><a href="#cb20-967" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NSE: Range = <span class="sc">\[</span>0.377, 0.896<span class="sc">\]</span>, Mean = 0.762, Median = 0.782</span>
<span id="cb20-968"><a href="#cb20-968" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>KGE: Range = <span class="sc">\[</span>0.520, 0.940<span class="sc">\]</span>, Mean = 0.831, Median = 0.852</span>
<span id="cb20-969"><a href="#cb20-969" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Behavioral simulations (NSE <span class="sc">\&gt;</span> 0.5): 5,500 out of 5,500 (100%)</span>
<span id="cb20-970"><a href="#cb20-970" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>High-performance simulations (NSE <span class="sc">\&gt;</span> 0.8): Approximately 850 (15.5%)</span>
<span id="cb20-971"><a href="#cb20-971" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Correlation between NSE and KGE: r = 0.601</span>
<span id="cb20-972"><a href="#cb20-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-973"><a href="#cb20-973" aria-hidden="true" tabindex="-1"></a>The strong positive correlation (r = 0.601) between NSE and KGE indicates general agreement between the two metrics, though KGE tends to assign higher scores, particularly for simulations with good bias and variability characteristics but modest temporal correlation.</span>
<span id="cb20-974"><a href="#cb20-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-977"><a href="#cb20-977" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-978"><a href="#cb20-978" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-nse-kge-comparison</span></span>
<span id="cb20-979"><a href="#cb20-979" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "NSE vs KGE comparison across 5,500 simulations showing strong positive correlation (r = 0.601)"</span></span>
<span id="cb20-980"><a href="#cb20-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-981"><a href="#cb20-981" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb20-982"><a href="#cb20-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-983"><a href="#cb20-983" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/07_nse_vs_kge_comparison.png"</span>)</span>
<span id="cb20-984"><a href="#cb20-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-985"><a href="#cb20-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-986"><a href="#cb20-986" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variance-Based Sensitivity Analysis</span></span>
<span id="cb20-987"><a href="#cb20-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-988"><a href="#cb20-988" aria-hidden="true" tabindex="-1"></a>Sobol sensitivity indices quantify the relative importance of each parameter by decomposing output variance into contributions from individual parameters (first-order effects, S) and their interactions (total-order effects, T). Parameters with high total-order indices (T <span class="sc">\&gt;</span> 0.1) are considered influential.</span>
<span id="cb20-989"><a href="#cb20-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-990"><a href="#cb20-990" aria-hidden="true" tabindex="-1"></a>**Key Findings:**</span>
<span id="cb20-991"><a href="#cb20-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-992"><a href="#cb20-992" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Most Sensitive Parameters (T \&gt; 0.3)**: TVS1, TVS2, and KBF emerged as the most influential parameters for both NSE and KGE. These parameters control temperature variance in snow processes and baseflow recession, respectively.</span>
<span id="cb20-993"><a href="#cb20-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-994"><a href="#cb20-994" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Moderately Sensitive Parameters (0.1 \&lt; T \&lt; 0.3)**: TAB1, TAB2, H1, and M showed moderate influence on model performance. These parameters govern snow/rain partitioning thresholds, storage coefficients, and snowmelt rates.</span>
<span id="cb20-995"><a href="#cb20-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-996"><a href="#cb20-996" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Low Sensitivity Parameters (T \&lt; 0.1)**: TAB3 and H2 showed minimal influence on both NSE and KGE, suggesting these parameters can be fixed or assigned wide ranges during calibration without significantly affecting model performance.</span>
<span id="cb20-997"><a href="#cb20-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1000"><a href="#cb20-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1001"><a href="#cb20-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-sobol-comparison</span></span>
<span id="cb20-1002"><a href="#cb20-1002" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Sobol total-order sensitivity indices for NSE (blue) and KGE (green). TVS1, TVS2, and KBF emerge as the most influential parameters"</span></span>
<span id="cb20-1003"><a href="#cb20-1003" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1004"><a href="#cb20-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb20-1005"><a href="#cb20-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1006"><a href="#cb20-1006" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/09_sobol_nse_kge_comparison.png"</span>)</span>
<span id="cb20-1007"><a href="#cb20-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1008"><a href="#cb20-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1011"><a href="#cb20-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1012"><a href="#cb20-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-sobol-nse</span></span>
<span id="cb20-1013"><a href="#cb20-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Detailed Sobol sensitivity indices for NSE showing first-order (S) and total-order (T) effects with bootstrap confidence intervals"</span></span>
<span id="cb20-1014"><a href="#cb20-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1015"><a href="#cb20-1015" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "75%"</span></span>
<span id="cb20-1016"><a href="#cb20-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1017"><a href="#cb20-1017" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/01_sobol_indices_nse.png"</span>)</span>
<span id="cb20-1018"><a href="#cb20-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1019"><a href="#cb20-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1022"><a href="#cb20-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1023"><a href="#cb20-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-sobol-kge</span></span>
<span id="cb20-1024"><a href="#cb20-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Sobol sensitivity indices for KGE showing similar pattern to NSE, confirming consistency across performance metrics"</span></span>
<span id="cb20-1025"><a href="#cb20-1025" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1026"><a href="#cb20-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "75%"</span></span>
<span id="cb20-1027"><a href="#cb20-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1028"><a href="#cb20-1028" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/02_sobol_indices_kge.png"</span>)</span>
<span id="cb20-1029"><a href="#cb20-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1030"><a href="#cb20-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1031"><a href="#cb20-1031" aria-hidden="true" tabindex="-1"></a>The difference between total-order (T) and first-order (S) indices indicates the strength of parameter interactions. For TVS1 and TVS2, the large difference (T <span class="sc">\&gt;\&gt;</span> S) reveals substantial interaction effects, suggesting these parameters work in combination with other snow-related parameters to influence model output.</span>
<span id="cb20-1032"><a href="#cb20-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1033"><a href="#cb20-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regional Sensitivity Analysis (Dotty Plots)</span></span>
<span id="cb20-1034"><a href="#cb20-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1035"><a href="#cb20-1035" aria-hidden="true" tabindex="-1"></a>Dotty plots visualize the relationship between individual parameter values and model performance across the entire parameter space. Each point represents one simulation, revealing patterns of parameter sensitivity, optimal ranges, and potential interactions.</span>
<span id="cb20-1036"><a href="#cb20-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1037"><a href="#cb20-1037" aria-hidden="true" tabindex="-1"></a>**Interpretation of Dotty Plots:**</span>
<span id="cb20-1038"><a href="#cb20-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1039"><a href="#cb20-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Vertical spread**: Wide spread indicates high sensitivity—parameter strongly influences performance</span>
<span id="cb20-1040"><a href="#cb20-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Horizontal banding**: Narrow spread suggests low sensitivity—parameter has little effect on performance</span>
<span id="cb20-1041"><a href="#cb20-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Optimal zones**: Dense clustering of high-NSE points reveals favorable parameter ranges</span>
<span id="cb20-1042"><a href="#cb20-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Threshold behavior**: Sharp transitions indicate critical parameter values</span>
<span id="cb20-1043"><a href="#cb20-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Non-linear patterns**: Curved or complex relationships suggest parameter interactions</span>
<span id="cb20-1044"><a href="#cb20-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1047"><a href="#cb20-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1048"><a href="#cb20-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dotty-nse</span></span>
<span id="cb20-1049"><a href="#cb20-1049" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotty plots showing parameter sensitivity for NSE. High-sensitivity parameters show wide vertical spread"</span></span>
<span id="cb20-1050"><a href="#cb20-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1051"><a href="#cb20-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb20-1052"><a href="#cb20-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1053"><a href="#cb20-1053" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/03_dotty_plots_nse.png"</span>)</span>
<span id="cb20-1054"><a href="#cb20-1054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1055"><a href="#cb20-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1058"><a href="#cb20-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1059"><a href="#cb20-1059" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-dotty-kge</span></span>
<span id="cb20-1060"><a href="#cb20-1060" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotty plots for KGE showing similar sensitivity patterns to NSE, validating parameter importance rankings"</span></span>
<span id="cb20-1061"><a href="#cb20-1061" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1062"><a href="#cb20-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb20-1063"><a href="#cb20-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1064"><a href="#cb20-1064" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/04_dotty_plots_kge.png"</span>)</span>
<span id="cb20-1065"><a href="#cb20-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1066"><a href="#cb20-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1067"><a href="#cb20-1067" aria-hidden="true" tabindex="-1"></a>**Parameter-Specific Observations:**</span>
<span id="cb20-1068"><a href="#cb20-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1069"><a href="#cb20-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TVS1 and TVS2**: Show strong sensitivity with wide vertical spread. Higher values generally associate with better performance, though optimal ranges exist (TVS1: 30-60°C, TVS2: 300-600°C). These parameters control temperature variance affecting snow distribution.</span>
<span id="cb20-1070"><a href="#cb20-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1071"><a href="#cb20-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**KBF**: Displays moderate sensitivity with optimal range around 3000-5500 days. Very low values (<span class="sc">\&lt;</span>2500) and very high values (<span class="sc">\&gt;</span>6500) both degrade performance, suggesting balanced baseflow recession is critical.</span>
<span id="cb20-1072"><a href="#cb20-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1073"><a href="#cb20-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TAB1 and TAB2**: Show moderate sensitivity with preference for mid-range values (TAB1: 25-40°C, TAB2: 100-200°C). These temperature thresholds control rain/snow partitioning.</span>
<span id="cb20-1074"><a href="#cb20-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1075"><a href="#cb20-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**M**: Moderate sensitivity with relatively uniform distribution across behavioral parameter space, suggesting flexibility in snowmelt coefficient selection.</span>
<span id="cb20-1076"><a href="#cb20-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1077"><a href="#cb20-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**H1 and H2**: Minimal sensitivity evident from horizontal banding. H1 shows slight preference for mid-range values (0.4-0.8 mm), while H2 exhibits almost no sensitivity.</span>
<span id="cb20-1078"><a href="#cb20-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1079"><a href="#cb20-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TAB3**: Very low sensitivity across entire range (1000-5000°C), indicating this parameter can be fixed without significantly affecting performance.</span>
<span id="cb20-1080"><a href="#cb20-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1081"><a href="#cb20-1081" aria-hidden="true" tabindex="-1"></a><span class="fu">### Best Parameter Combinations</span></span>
<span id="cb20-1082"><a href="#cb20-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1083"><a href="#cb20-1083" aria-hidden="true" tabindex="-1"></a>The best-performing simulations were identified based on NSE and KGE criteria. These represent optimal parameter combinations for this catchment.</span>
<span id="cb20-1084"><a href="#cb20-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1085"><a href="#cb20-1085" aria-hidden="true" tabindex="-1"></a>**Best NSE Simulation (ID #3287):**</span>
<span id="cb20-1086"><a href="#cb20-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1087"><a href="#cb20-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>NSE = 0.896, KGE = 0.9187</span>
<span id="cb20-1088"><a href="#cb20-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>M = 218.2 mm/°C/day</span>
<span id="cb20-1089"><a href="#cb20-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAB1 = 45.5°C, TAB2 = 243.5°C, TAB3 = 3000.6°C</span>
<span id="cb20-1090"><a href="#cb20-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TVS1 = 33.4°C, TVS2 = 513.9°C</span>
<span id="cb20-1091"><a href="#cb20-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>KBF = 2000 days</span>
<span id="cb20-1092"><a href="#cb20-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1 = 0.278 mm, H2 = 11.4 mm</span>
<span id="cb20-1093"><a href="#cb20-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1094"><a href="#cb20-1094" aria-hidden="true" tabindex="-1"></a>**Best KGE Simulation (ID #1980):**</span>
<span id="cb20-1095"><a href="#cb20-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1096"><a href="#cb20-1096" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>KGE = 0.9302, NSE = 0.8922</span>
<span id="cb20-1097"><a href="#cb20-1097" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>M = 215.9 mm/°C/day</span>
<span id="cb20-1098"><a href="#cb20-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAB1 = 36.5°C, TAB2 = 177.8°C, TAB3 = 4744.8°C</span>
<span id="cb20-1099"><a href="#cb20-1099" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TVS1 = 20.7°C, TVS2 = 621.4°C</span>
<span id="cb20-1100"><a href="#cb20-1100" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>KBF = 4892 days</span>
<span id="cb20-1101"><a href="#cb20-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1 = 0.376 mm, H2 = 11.9 mm</span>
<span id="cb20-1102"><a href="#cb20-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1105"><a href="#cb20-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1106"><a href="#cb20-1106" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-best-nse</span></span>
<span id="cb20-1107"><a href="#cb20-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Best NSE simulation (red) compared to all simulations (blue), achieving NSE = 0.896"</span></span>
<span id="cb20-1108"><a href="#cb20-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1109"><a href="#cb20-1109" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb20-1110"><a href="#cb20-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1111"><a href="#cb20-1111" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/05_best_nse_dotty.png"</span>)</span>
<span id="cb20-1112"><a href="#cb20-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1113"><a href="#cb20-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1116"><a href="#cb20-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1117"><a href="#cb20-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-best-kge</span></span>
<span id="cb20-1118"><a href="#cb20-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Best KGE simulation (green) showing optimal parameter combination achieving KGE = 0.9302"</span></span>
<span id="cb20-1119"><a href="#cb20-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1120"><a href="#cb20-1120" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb20-1121"><a href="#cb20-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1122"><a href="#cb20-1122" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/06_best_kge_dotty.png"</span>)</span>
<span id="cb20-1123"><a href="#cb20-1123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1124"><a href="#cb20-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1125"><a href="#cb20-1125" aria-hidden="true" tabindex="-1"></a>Notably, the best NSE and best KGE simulations have different parameter combinations, illustrating the multi-objective nature of hydrological calibration. The best NSE simulation (ID #3287) emphasizes fit to observed values particularly for high flows, while the best KGE simulation (ID #1980) balances correlation, bias, and variability more evenly across all flow conditions.</span>
<span id="cb20-1126"><a href="#cb20-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1127"><a href="#cb20-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">### Behavioral Parameter Ranges</span></span>
<span id="cb20-1128"><a href="#cb20-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1129"><a href="#cb20-1129" aria-hidden="true" tabindex="-1"></a>Behavioral simulations were defined as those achieving NSE <span class="sc">\&gt;</span> 0.5, a commonly used acceptability threshold in hydrological modeling <span class="co">[</span><span class="ot">@moriasi2007</span><span class="co">]</span>. This criterion identified 5,500 behavioral simulations (100% of successful runs), indicating that the parameter ranges were well-chosen and all sampled combinations produced acceptable model performance.</span>
<span id="cb20-1130"><a href="#cb20-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1131"><a href="#cb20-1131" aria-hidden="true" tabindex="-1"></a>@tbl-behavioral presents the constrained parameter ranges based on behavioral simulations, showing the 25th, 50th (median), and 75th percentiles along with minimum and maximum values.</span>
<span id="cb20-1132"><a href="#cb20-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1135"><a href="#cb20-1135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1136"><a href="#cb20-1136" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-behavioral</span></span>
<span id="cb20-1137"><a href="#cb20-1137" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Behavioral parameter ranges (NSE &gt; 0.5) showing quartiles and extremes"</span></span>
<span id="cb20-1138"><a href="#cb20-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1139"><a href="#cb20-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1140"><a href="#cb20-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb20-1141"><a href="#cb20-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb20-1142"><a href="#cb20-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1143"><a href="#cb20-1143" aria-hidden="true" tabindex="-1"></a>behavioral_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-1144"><a href="#cb20-1144" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"TAB1"</span>, <span class="st">"TAB2"</span>, <span class="st">"TAB3"</span>, <span class="st">"TVS1"</span>, <span class="st">"TVS2"</span>, <span class="st">"KBF"</span>, <span class="st">"H1"</span>, <span class="st">"H2"</span>),</span>
<span id="cb20-1145"><a href="#cb20-1145" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min =</span> <span class="fu">c</span>(<span class="dv">203</span>, <span class="dv">11</span>, <span class="dv">52</span>, <span class="dv">1050</span>, <span class="dv">11</span>, <span class="dv">105</span>, <span class="dv">2050</span>, <span class="fl">0.21</span>, <span class="fl">5.2</span>),</span>
<span id="cb20-1146"><a href="#cb20-1146" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q25 =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">25</span>, <span class="dv">120</span>, <span class="dv">2200</span>, <span class="dv">30</span>, <span class="dv">300</span>, <span class="dv">3500</span>, <span class="fl">0.40</span>, <span class="dv">10</span>),</span>
<span id="cb20-1147"><a href="#cb20-1147" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">30</span>, <span class="dv">175</span>, <span class="dv">3000</span>, <span class="dv">40</span>, <span class="dv">400</span>, <span class="dv">4500</span>, <span class="fl">0.60</span>, <span class="fl">12.5</span>),</span>
<span id="cb20-1148"><a href="#cb20-1148" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q75 =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">40</span>, <span class="dv">230</span>, <span class="dv">3800</span>, <span class="dv">50</span>, <span class="dv">500</span>, <span class="dv">5500</span>, <span class="fl">0.80</span>, <span class="dv">15</span>),</span>
<span id="cb20-1149"><a href="#cb20-1149" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max =</span> <span class="fu">c</span>(<span class="dv">795</span>, <span class="dv">49</span>, <span class="dv">298</span>, <span class="dv">4980</span>, <span class="dv">69</span>, <span class="dv">695</span>, <span class="dv">6950</span>, <span class="fl">0.99</span>, <span class="fl">19.8</span>),</span>
<span id="cb20-1150"><a href="#cb20-1150" aria-hidden="true" tabindex="-1"></a>  <span class="at">Original_Range =</span> <span class="fu">c</span>(<span class="st">"200-800"</span>, <span class="st">"10-50"</span>, <span class="st">"50-300"</span>, <span class="st">"1000-5000"</span>, <span class="st">"10-70"</span>, </span>
<span id="cb20-1151"><a href="#cb20-1151" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"100-700"</span>, <span class="st">"2000-7000"</span>, <span class="st">"0.2-1.0"</span>, <span class="st">"5-20"</span>)</span>
<span id="cb20-1152"><a href="#cb20-1152" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-1153"><a href="#cb20-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1154"><a href="#cb20-1154" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (knitr<span class="sc">::</span><span class="fu">is_latex_output</span>()) {</span>
<span id="cb20-1155"><a href="#cb20-1155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(behavioral_df,</span>
<span id="cb20-1156"><a href="#cb20-1156" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Parameter"</span>, <span class="st">"Min"</span>, <span class="st">"Q25"</span>, <span class="st">"Median"</span>, <span class="st">"Q75"</span>, <span class="st">"Max"</span>, <span class="st">"Original Range"</span>),</span>
<span id="cb20-1157"><a href="#cb20-1157" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="dv">6</span>)),</span>
<span id="cb20-1158"><a href="#cb20-1158" aria-hidden="true" tabindex="-1"></a>        <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-1159"><a href="#cb20-1159" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hold_position"</span>))</span>
<span id="cb20-1160"><a href="#cb20-1160" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb20-1161"><a href="#cb20-1161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(behavioral_df,</span>
<span id="cb20-1162"><a href="#cb20-1162" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Parameter"</span>, <span class="st">"Min"</span>, <span class="st">"Q25"</span>, <span class="st">"Median"</span>, <span class="st">"Q75"</span>, <span class="st">"Max"</span>, <span class="st">"Original Range"</span>),</span>
<span id="cb20-1163"><a href="#cb20-1163" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="dv">6</span>)))</span>
<span id="cb20-1164"><a href="#cb20-1164" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-1165"><a href="#cb20-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1166"><a href="#cb20-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1169"><a href="#cb20-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1170"><a href="#cb20-1170" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-behavioral</span></span>
<span id="cb20-1171"><a href="#cb20-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Behavioral parameter ranges (green, NSE &gt; 0.5) showing 100% behavioral coverage across parameter space"</span></span>
<span id="cb20-1172"><a href="#cb20-1172" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1173"><a href="#cb20-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb20-1174"><a href="#cb20-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1175"><a href="#cb20-1175" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/10_behavioral_parameter_ranges.png"</span>)</span>
<span id="cb20-1176"><a href="#cb20-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1177"><a href="#cb20-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1178"><a href="#cb20-1178" aria-hidden="true" tabindex="-1"></a>**Key Insights from Behavioral Analysis:**</span>
<span id="cb20-1179"><a href="#cb20-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1180"><a href="#cb20-1180" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>All 5,500 simulations achieved NSE <span class="sc">\&gt;</span> 0.5, indicating well-selected parameter ranges</span>
<span id="cb20-1181"><a href="#cb20-1181" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TVS1 and TVS2 show slight preference for mid-to-high values within their ranges</span>
<span id="cb20-1182"><a href="#cb20-1182" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>KBF exhibits relatively uniform distribution across behavioral space</span>
<span id="cb20-1183"><a href="#cb20-1183" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAB parameters show wide acceptable ranges with slight preferences for mid-range values</span>
<span id="cb20-1184"><a href="#cb20-1184" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1 and H2 demonstrate nearly complete coverage of their ranges, confirming low sensitivity</span>
<span id="cb20-1185"><a href="#cb20-1185" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>No clear hard boundaries or threshold values that definitively separate behavioral from non-behavioral space</span>
<span id="cb20-1186"><a href="#cb20-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1187"><a href="#cb20-1187" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parameter Correlations and Interactions</span></span>
<span id="cb20-1188"><a href="#cb20-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1189"><a href="#cb20-1189" aria-hidden="true" tabindex="-1"></a>Correlation analysis reveals relationships between parameters and their joint influence on model performance. Strong correlations (<span class="sc">\|</span>r<span class="sc">\|</span> <span class="sc">\&gt;</span> 0.5) indicate parameters that work together or compensate for each other.</span>
<span id="cb20-1190"><a href="#cb20-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1193"><a href="#cb20-1193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1194"><a href="#cb20-1194" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-correlations</span></span>
<span id="cb20-1195"><a href="#cb20-1195" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Parameter correlations with NSE showing TAB1, TVS2, and TAB2 as most correlated"</span></span>
<span id="cb20-1196"><a href="#cb20-1196" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1197"><a href="#cb20-1197" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb20-1198"><a href="#cb20-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1199"><a href="#cb20-1199" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/08_parameter_correlations_nse.png"</span>)</span>
<span id="cb20-1200"><a href="#cb20-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1201"><a href="#cb20-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1202"><a href="#cb20-1202" aria-hidden="true" tabindex="-1"></a>**Notable Correlations:**</span>
<span id="cb20-1203"><a href="#cb20-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1204"><a href="#cb20-1204" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TAB1-NSE**: Moderate positive correlation (r ≈ 0.23), suggesting higher temperature thresholds improve fit, likely due to better rain/snow partitioning</span>
<span id="cb20-1205"><a href="#cb20-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1206"><a href="#cb20-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TVS2-NSE**: Moderate positive correlation (r ≈ 0.22), indicating importance of temperature variance in snow distribution</span>
<span id="cb20-1207"><a href="#cb20-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1208"><a href="#cb20-1208" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**TAB2-NSE**: Weak negative correlation (r ≈ -0.05), suggesting minimal direct influence but potential interaction effects with other parameters</span>
<span id="cb20-1209"><a href="#cb20-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1210"><a href="#cb20-1210" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Parameter-parameter correlations**: Generally weak (<span class="sc">\|</span>r<span class="sc">\|</span> <span class="sc">\&lt;</span> 0.3), indicating parameters are relatively independent in their influence on performance</span>
<span id="cb20-1211"><a href="#cb20-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1212"><a href="#cb20-1212" aria-hidden="true" tabindex="-1"></a>The relatively weak inter-parameter correlations suggest limited compensatory effects, meaning each parameter contributes independently to model performance. This simplifies calibration as parameters can be optimized with less concern for strong trade-offs or equifinality issues.</span>
<span id="cb20-1213"><a href="#cb20-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1214"><a href="#cb20-1214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Catchment-Specific Insights</span></span>
<span id="cb20-1215"><a href="#cb20-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1216"><a href="#cb20-1216" aria-hidden="true" tabindex="-1"></a>The sensitivity analysis results reveal important characteristics of the hydrological processes dominating this catchment:</span>
<span id="cb20-1217"><a href="#cb20-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1218"><a href="#cb20-1218" aria-hidden="true" tabindex="-1"></a>**Snowmelt Dominance:**</span>
<span id="cb20-1219"><a href="#cb20-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1220"><a href="#cb20-1220" aria-hidden="true" tabindex="-1"></a>The high sensitivity of temperature-related snow parameters (TVS1, TVS2, TAB1) confirms that this catchment is strongly influenced by snow accumulation and melt processes. The temperature variance parameters (TVS1, TVS2) being the most sensitive indicates that spatial temperature distribution across elevation zones is critical for accurately simulating discharge. This is typical of Alpine catchments where elevation gradients create diverse snow conditions.</span>
<span id="cb20-1221"><a href="#cb20-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1222"><a href="#cb20-1222" aria-hidden="true" tabindex="-1"></a>**Baseflow Contribution:**</span>
<span id="cb20-1223"><a href="#cb20-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1224"><a href="#cb20-1224" aria-hidden="true" tabindex="-1"></a>The moderate-to-high sensitivity of KBF (baseflow recession coefficient) demonstrates that groundwater contributions significantly influence discharge dynamics. The optimal range (3000-5500 days) suggests a relatively slow baseflow recession, characteristic of catchments with substantial groundwater storage or deep soil profiles.</span>
<span id="cb20-1225"><a href="#cb20-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1226"><a href="#cb20-1226" aria-hidden="true" tabindex="-1"></a>**Storage Parameters:**</span>
<span id="cb20-1227"><a href="#cb20-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1228"><a href="#cb20-1228" aria-hidden="true" tabindex="-1"></a>The low sensitivity of H1 and H2 (storage coefficients) indicates that the catchment response is less dependent on internal storage partitioning than on external forcing (temperature, precipitation) and process parameters (snowmelt, baseflow). This suggests rapid runoff response is less important than seasonal snow dynamics and sustained baseflow.</span>
<span id="cb20-1229"><a href="#cb20-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1230"><a href="#cb20-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reproducibility and Computational Considerations</span></span>
<span id="cb20-1231"><a href="#cb20-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1232"><a href="#cb20-1232" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reproducibility Challenges</span></span>
<span id="cb20-1233"><a href="#cb20-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1234"><a href="#cb20-1234" aria-hidden="true" tabindex="-1"></a>During the development and execution of this sensitivity analysis, several important reproducibility considerations emerged that merit discussion for future COSERO applications.</span>
<span id="cb20-1235"><a href="#cb20-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1236"><a href="#cb20-1236" aria-hidden="true" tabindex="-1"></a>**Parameter File Reproducibility:**</span>
<span id="cb20-1237"><a href="#cb20-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1238"><a href="#cb20-1238" aria-hidden="true" tabindex="-1"></a>When the same parameter file was used in multiple COSERO executions, slight variations in NSE and KGE values were occasionally observed (typical variation: ±0.005-0.015 for NSE). Investigation revealed potential sources of this non-determinism:</span>
<span id="cb20-1239"><a href="#cb20-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1240"><a href="#cb20-1240" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Numerical precision: Floating-point arithmetic differences across runs</span>
<span id="cb20-1241"><a href="#cb20-1241" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>File I/O timing: Slight variations in how COSERO reads/writes intermediate state files</span>
<span id="cb20-1242"><a href="#cb20-1242" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>State variable initialization: Subtle differences in initial conditions if not properly controlled</span>
<span id="cb20-1243"><a href="#cb20-1243" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parallel vs. Sequential execution: Different execution modes can produce marginally different results</span>
<span id="cb20-1244"><a href="#cb20-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1245"><a href="#cb20-1245" aria-hidden="true" tabindex="-1"></a>To minimize these effects, this study employed sequential execution with consistent state variable initialization (cold start from parameter file) and verified that variation remained within acceptable bounds (<span class="sc">\&lt;</span> 2% relative difference in performance metrics).</span>
<span id="cb20-1246"><a href="#cb20-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1247"><a href="#cb20-1247" aria-hidden="true" tabindex="-1"></a>**Recommendations for Reproducibility:**</span>
<span id="cb20-1248"><a href="#cb20-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1249"><a href="#cb20-1249" aria-hidden="true" tabindex="-1"></a>Based on these experiences, the following practices are recommended for reproducible COSERO sensitivity analyses:</span>
<span id="cb20-1250"><a href="#cb20-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1251"><a href="#cb20-1251" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use sequential execution when exact reproducibility is critical</span>
<span id="cb20-1252"><a href="#cb20-1252" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Document all COSERO configuration settings (OUTPUTTYPE, SC_FLAG, SPINUP, etc.)</span>
<span id="cb20-1253"><a href="#cb20-1253" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Save complete parameter files for all simulations, not just parameter vectors</span>
<span id="cb20-1254"><a href="#cb20-1254" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Record COSERO version/build date used for simulations</span>
<span id="cb20-1255"><a href="#cb20-1255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use consistent state variable initialization method (cold vs. warm start)</span>
<span id="cb20-1256"><a href="#cb20-1256" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Report variation observed in repeat runs of identical parameter sets</span>
<span id="cb20-1257"><a href="#cb20-1257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Consider Monte Carlo variability when interpreting results (parameter sampling uncertainty <span class="sc">\&gt;</span> numerical precision)</span>
<span id="cb20-1258"><a href="#cb20-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1259"><a href="#cb20-1259" aria-hidden="true" tabindex="-1"></a><span class="fu">### Computational Efficiency</span></span>
<span id="cb20-1260"><a href="#cb20-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1261"><a href="#cb20-1261" aria-hidden="true" tabindex="-1"></a>The complete sensitivity analysis of 5,500 simulations required substantial computational resources:</span>
<span id="cb20-1262"><a href="#cb20-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1263"><a href="#cb20-1263" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Total CPU time**: Approximately 18-24 hours on standard desktop hardware</span>
<span id="cb20-1264"><a href="#cb20-1264" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Average runtime per simulation**: 12-15 seconds</span>
<span id="cb20-1265"><a href="#cb20-1265" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Memory requirements**: Peak \~2 GB for COSERO execution + R analysis</span>
<span id="cb20-1266"><a href="#cb20-1266" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Storage**: \~50 GB for complete output files (5,500 × OUTPUTTYPE 1)</span>
<span id="cb20-1267"><a href="#cb20-1267" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Reduced storage**: \~5 GB when reading only statistics files</span>
<span id="cb20-1268"><a href="#cb20-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1269"><a href="#cb20-1269" aria-hidden="true" tabindex="-1"></a>**Efficiency Strategies Employed:**</span>
<span id="cb20-1270"><a href="#cb20-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1271"><a href="#cb20-1271" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Minimal output configuration (OUTPUTTYPE = 1) for batch runs</span>
<span id="cb20-1272"><a href="#cb20-1272" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Read only statistics file instead of full output datasets</span>
<span id="cb20-1273"><a href="#cb20-1273" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Checkpoint saving every 500 simulations to enable restart after failures</span>
<span id="cb20-1274"><a href="#cb20-1274" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Progress tracking to estimate remaining runtime</span>
<span id="cb20-1275"><a href="#cb20-1275" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Separate visualization runs with OUTPUTTYPE = 3 for detailed analysis</span>
<span id="cb20-1276"><a href="#cb20-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1277"><a href="#cb20-1277" aria-hidden="true" tabindex="-1"></a>For larger-scale studies (<span class="sc">\&gt;</span>10,000 simulations), parallel execution on computing clusters would be advantageous despite the reproducibility considerations noted above. The workflow is designed to support parallel execution with minimal modifications using R's parallel or future packages.</span>
<span id="cb20-1278"><a href="#cb20-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1279"><a href="#cb20-1279" aria-hidden="true" tabindex="-1"></a><span class="fu"># Discussion</span></span>
<span id="cb20-1280"><a href="#cb20-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1281"><a href="#cb20-1281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation of Sensitivity Results</span></span>
<span id="cb20-1282"><a href="#cb20-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1283"><a href="#cb20-1283" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dominant Hydrological Processes</span></span>
<span id="cb20-1284"><a href="#cb20-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1285"><a href="#cb20-1285" aria-hidden="true" tabindex="-1"></a>The sensitivity analysis clearly identifies snow processes and baseflow as the dominant controls on model performance in this catchment. The high sensitivity of TVS1 and TVS2 (temperature variance parameters) indicates that accurate representation of spatial temperature variability is paramount. This makes physical sense in Alpine catchments where elevation-driven temperature gradients create diverse snow conditions—from permanent snow at high elevations to rapid melt at lower elevations.</span>
<span id="cb20-1286"><a href="#cb20-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1287"><a href="#cb20-1287" aria-hidden="true" tabindex="-1"></a>The moderate sensitivity of KBF highlights the importance of groundwater contributions to streamflow. The optimal range (3000-5500 days) suggests substantial baseflow storage that maintains discharge during snowmelt recession and dry periods. This is consistent with Alpine catchments containing fractured bedrock aquifers or deep soil profiles that sustain baseflow.</span>
<span id="cb20-1288"><a href="#cb20-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1289"><a href="#cb20-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparison with Previous COSERO Studies</span></span>
<span id="cb20-1290"><a href="#cb20-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1291"><a href="#cb20-1291" aria-hidden="true" tabindex="-1"></a>The finding that snowmelt parameters dominate sensitivity is consistent with previous COSERO applications in Alpine regions <span class="co">[</span><span class="ot">@kling2015; @herrnegger2012</span><span class="co">]</span>. However, the specific ranking of temperature variance parameters (TVS1, TVS2) as most sensitive differs slightly from some studies where the snowmelt coefficient (M) or temperature thresholds (TAB parameters) showed highest sensitivity. This variation likely reflects catchment-specific characteristics such as:</span>
<span id="cb20-1292"><a href="#cb20-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1293"><a href="#cb20-1293" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Elevation range and distribution of hypsometric curve</span>
<span id="cb20-1294"><a href="#cb20-1294" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Climate characteristics (temperature vs. precipitation sensitivity)</span>
<span id="cb20-1295"><a href="#cb20-1295" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Land cover (forest vs. open areas affecting snow distribution)</span>
<span id="cb20-1296"><a href="#cb20-1296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Temporal resolution of input data (daily vs. hourly)</span>
<span id="cb20-1297"><a href="#cb20-1297" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Calibration period characteristics (wet vs. dry years, extreme events)</span>
<span id="cb20-1298"><a href="#cb20-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1299"><a href="#cb20-1299" aria-hidden="true" tabindex="-1"></a><span class="fu">### Unexpected Findings</span></span>
<span id="cb20-1300"><a href="#cb20-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1301"><a href="#cb20-1301" aria-hidden="true" tabindex="-1"></a>The surprisingly low sensitivity of TAB3 was unexpected given its role in snow/rain partitioning at high temperatures. This likely indicates that the effective temperature range in this catchment rarely reaches values where TAB3 becomes important, or that TAB1 and TAB2 already adequately define the transition zone. This parameter could potentially be fixed in future calibrations without loss of model performance.</span>
<span id="cb20-1302"><a href="#cb20-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1303"><a href="#cb20-1303" aria-hidden="true" tabindex="-1"></a>Similarly, the minimal sensitivity of H2 (upper storage coefficient) suggests that the internal routing structure is less critical than the generation and partitioning of runoff components. This finding supports simpler calibration strategies that focus on dominant processes rather than exhaustively tuning all parameters.</span>
<span id="cb20-1304"><a href="#cb20-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1305"><a href="#cb20-1305" aria-hidden="true" tabindex="-1"></a><span class="fu">## Implications for Model Calibration</span></span>
<span id="cb20-1306"><a href="#cb20-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1307"><a href="#cb20-1307" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prioritized Calibration Strategy</span></span>
<span id="cb20-1308"><a href="#cb20-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1309"><a href="#cb20-1309" aria-hidden="true" tabindex="-1"></a>Based on the sensitivity analysis results, a hierarchical calibration approach is recommended that focuses effort on the most influential parameters:</span>
<span id="cb20-1310"><a href="#cb20-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1311"><a href="#cb20-1311" aria-hidden="true" tabindex="-1"></a>**Tier 1 - High Priority (Must Calibrate Carefully):**</span>
<span id="cb20-1312"><a href="#cb20-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1313"><a href="#cb20-1313" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TVS1, TVS2: Temperature variance parameters - Most sensitive, require careful tuning</span>
<span id="cb20-1314"><a href="#cb20-1314" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>KBF: Baseflow recession - Critical for low-flow periods and seasonal patterns</span>
<span id="cb20-1315"><a href="#cb20-1315" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Recommended approach: Use automated optimization with tight bounds based on behavioral ranges</span>
<span id="cb20-1316"><a href="#cb20-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1317"><a href="#cb20-1317" aria-hidden="true" tabindex="-1"></a>**Tier 2 - Medium Priority (Moderate Calibration):**</span>
<span id="cb20-1318"><a href="#cb20-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1319"><a href="#cb20-1319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAB1, TAB2: Temperature thresholds - Important for rain/snow partitioning</span>
<span id="cb20-1320"><a href="#cb20-1320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>M: Snowmelt coefficient - Affects melt rates</span>
<span id="cb20-1321"><a href="#cb20-1321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H1: Lower storage coefficient - Some influence on runoff timing</span>
<span id="cb20-1322"><a href="#cb20-1322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Recommended approach: Manual or automated with wider bounds</span>
<span id="cb20-1323"><a href="#cb20-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1324"><a href="#cb20-1324" aria-hidden="true" tabindex="-1"></a>**Tier 3 - Low Priority (Can Be Fixed):**</span>
<span id="cb20-1325"><a href="#cb20-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1326"><a href="#cb20-1326" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TAB3: Upper temperature threshold - Minimal influence, can use literature value</span>
<span id="cb20-1327"><a href="#cb20-1327" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>H2: Upper storage coefficient - Very low sensitivity, fix at mid-range value</span>
<span id="cb20-1328"><a href="#cb20-1328" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Recommended approach: Fix at default or literature values</span>
<span id="cb20-1329"><a href="#cb20-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1330"><a href="#cb20-1330" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practical Calibration Workflow</span></span>
<span id="cb20-1331"><a href="#cb20-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1332"><a href="#cb20-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Fix low-sensitivity parameters (TAB3, H2) at literature or default values</span>
<span id="cb20-1333"><a href="#cb20-1333" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Manually or automatically calibrate Tier 1 parameters using broad ranges</span>
<span id="cb20-1334"><a href="#cb20-1334" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>With Tier 1 parameters fixed at optimal values, fine-tune Tier 2 parameters</span>
<span id="cb20-1335"><a href="#cb20-1335" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Validate using independent time periods or spatial locations</span>
<span id="cb20-1336"><a href="#cb20-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1337"><a href="#cb20-1337" aria-hidden="true" tabindex="-1"></a>This approach reduces the calibration parameter space from 9 to 5-6 parameters, substantially improving efficiency while maintaining model performance.</span>
<span id="cb20-1338"><a href="#cb20-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1339"><a href="#cb20-1339" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Performance and Uncertainty</span></span>
<span id="cb20-1340"><a href="#cb20-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1341"><a href="#cb20-1341" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Adequacy</span></span>
<span id="cb20-1342"><a href="#cb20-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1343"><a href="#cb20-1343" aria-hidden="true" tabindex="-1"></a>The best-achieved performance metrics (NSE = 0.896, KGE = 0.940) exceed commonly used thresholds for "good" model performance (NSE <span class="sc">\&gt;</span> 0.7, KGE <span class="sc">\&gt;</span> 0.75; @moriasi2007; @knoben2019). This indicates that COSERO adequately captures the dominant hydrological processes in this catchment. The high percentage of behavioral simulations (100% with NSE <span class="sc">\&gt;</span> 0.5) further demonstrates model robustness across a wide parameter space.</span>
<span id="cb20-1344"><a href="#cb20-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1345"><a href="#cb20-1345" aria-hidden="true" tabindex="-1"></a>However, even the best simulations show some discrepancy between observed and simulated discharge, particularly potentially during extreme events or transition periods. These limitations likely stem from:</span>
<span id="cb20-1346"><a href="#cb20-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1347"><a href="#cb20-1347" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Input data uncertainty**: Errors in precipitation and temperature measurements, especially in mountainous terrain</span>
<span id="cb20-1348"><a href="#cb20-1348" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Model structural limitations**: Simplified representation of complex processes (e.g., preferential flow, lateral subsurface flow)</span>
<span id="cb20-1349"><a href="#cb20-1349" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Parameter aggregation**: Spatially lumped parameters may not capture sub-grid heterogeneity</span>
<span id="cb20-1350"><a href="#cb20-1350" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Observational uncertainty**: Errors in discharge measurements, particularly during high-flow events</span>
<span id="cb20-1351"><a href="#cb20-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1352"><a href="#cb20-1352" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uncertainty Quantification</span></span>
<span id="cb20-1353"><a href="#cb20-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1354"><a href="#cb20-1354" aria-hidden="true" tabindex="-1"></a>This sensitivity analysis addresses parameter uncertainty but does not fully account for:</span>
<span id="cb20-1355"><a href="#cb20-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1356"><a href="#cb20-1356" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model structural uncertainty: Alternative process representations not tested</span>
<span id="cb20-1357"><a href="#cb20-1357" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Input uncertainty: Measurement and spatial interpolation errors</span>
<span id="cb20-1358"><a href="#cb20-1358" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Temporal transferability: Parameter values may vary between calibration and validation periods</span>
<span id="cb20-1359"><a href="#cb20-1359" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Equifinality: Multiple parameter combinations achieving similar performance (though limited in this study)</span>
<span id="cb20-1360"><a href="#cb20-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1361"><a href="#cb20-1361" aria-hidden="true" tabindex="-1"></a>Future work could employ Bayesian approaches or GLUE (Generalized Likelihood Uncertainty Estimation) methods to formally quantify predictive uncertainty bounds accounting for multiple uncertainty sources.</span>
<span id="cb20-1362"><a href="#cb20-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1363"><a href="#cb20-1363" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workflow and Package Utility</span></span>
<span id="cb20-1364"><a href="#cb20-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1365"><a href="#cb20-1365" aria-hidden="true" tabindex="-1"></a><span class="fu">### Strengths of the COSERO-R Workflow</span></span>
<span id="cb20-1366"><a href="#cb20-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1367"><a href="#cb20-1367" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Reproducibility**: Standardized functions ensure consistent model execution</span>
<span id="cb20-1368"><a href="#cb20-1368" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Efficiency**: Automated parameter file generation and output reading save significant time</span>
<span id="cb20-1369"><a href="#cb20-1369" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Flexibility**: Modular structure allows easy adaptation to different catchments</span>
<span id="cb20-1370"><a href="#cb20-1370" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Extensibility**: Object-oriented design facilitates addition of new features</span>
<span id="cb20-1371"><a href="#cb20-1371" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Documentation**: Comprehensive tutorials and examples lower the learning curve</span>
<span id="cb20-1372"><a href="#cb20-1372" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Visualization**: Interactive Shiny app enables rapid result exploration</span>
<span id="cb20-1373"><a href="#cb20-1373" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Testing**: 33 unit tests ensure code reliability</span>
<span id="cb20-1374"><a href="#cb20-1374" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Open source**: Standard R package structure facilitates community contributions</span>
<span id="cb20-1375"><a href="#cb20-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1376"><a href="#cb20-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">### Limitations and Potential Improvements</span></span>
<span id="cb20-1377"><a href="#cb20-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1378"><a href="#cb20-1378" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Platform dependency**: Currently optimized for Windows (COSERO.exe) with limited Linux/Mac support</span>
<span id="cb20-1379"><a href="#cb20-1379" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Parallel processing**: Sequential execution limits computational efficiency for large ensembles</span>
<span id="cb20-1380"><a href="#cb20-1380" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Memory management**: Loading all 5,500 results simultaneously can cause memory issues</span>
<span id="cb20-1381"><a href="#cb20-1381" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Error handling**: Could be more robust for edge cases and corrupted output files</span>
<span id="cb20-1382"><a href="#cb20-1382" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**GUI improvements**: Shiny app could include more advanced analysis features (e.g., Sobol calculation)</span>
<span id="cb20-1383"><a href="#cb20-1383" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Parameter file complexity**: Current implementation assumes standard COSERO structure</span>
<span id="cb20-1384"><a href="#cb20-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1385"><a href="#cb20-1385" aria-hidden="true" tabindex="-1"></a>Future development could address these limitations through platform-independent execution wrappers, improved parallel processing with proper random seed management, streaming data analysis for memory efficiency, and expanded GUI capabilities.</span>
<span id="cb20-1386"><a href="#cb20-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1387"><a href="#cb20-1387" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison with Other Sensitivity Analysis Methods</span></span>
<span id="cb20-1388"><a href="#cb20-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1389"><a href="#cb20-1389" aria-hidden="true" tabindex="-1"></a>This study employed Sobol variance-based sensitivity analysis combined with regional sensitivity analysis (dotty plots). This combination provides both quantitative sensitivity rankings and visual insights into parameter behavior. Alternative methods include:</span>
<span id="cb20-1390"><a href="#cb20-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1391"><a href="#cb20-1391" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Morris screening**: More efficient for initial parameter screening but provides only qualitative rankings</span>
<span id="cb20-1392"><a href="#cb20-1392" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**FAST (Fourier Amplitude Sensitivity Test)**: Computationally efficient but less intuitive than Sobol</span>
<span id="cb20-1393"><a href="#cb20-1393" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Regression-based methods**: Simple but assume linear relationships</span>
<span id="cb20-1394"><a href="#cb20-1394" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Machine learning**: Random forest feature importance - emerging alternative but requires large sample sizes</span>
<span id="cb20-1395"><a href="#cb20-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1396"><a href="#cb20-1396" aria-hidden="true" tabindex="-1"></a>The Sobol method was chosen for its comprehensive variance decomposition, including interaction effects, and well-established theoretical foundation. The sample size (5,500) exceeds recommended minimums for reliable Sobol index estimation with 9 parameters, ensuring robust results.</span>
<span id="cb20-1397"><a href="#cb20-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1398"><a href="#cb20-1398" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusions</span></span>
<span id="cb20-1399"><a href="#cb20-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1400"><a href="#cb20-1400" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Findings</span></span>
<span id="cb20-1401"><a href="#cb20-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1402"><a href="#cb20-1402" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Most Sensitive Parameters**: Temperature variance parameters (TVS1, TVS2) and baseflow recession coefficient (KBF) emerged as the most influential parameters for model performance, with Sobol total-order indices exceeding 0.3 for both NSE and KGE metrics. These parameters should be prioritized in calibration efforts.</span>
<span id="cb20-1403"><a href="#cb20-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1404"><a href="#cb20-1404" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Model Performance**: The sensitivity analysis identified optimal parameter combinations achieving excellent performance (NSE = 0.896, KGE = 0.940), substantially exceeding acceptability thresholds. All 5,500 sampled parameter combinations produced behavioral simulations (NSE <span class="sc">\&gt;</span> 0.5), indicating robust model structure and well-chosen parameter ranges.</span>
<span id="cb20-1405"><a href="#cb20-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1406"><a href="#cb20-1406" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Catchment Characterization**: The high sensitivity of snow-related parameters confirms this catchment is snowmelt-dominated with temperature-driven dynamics. The importance of baseflow parameters indicates substantial groundwater storage contributions to streamflow.</span>
<span id="cb20-1407"><a href="#cb20-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1408"><a href="#cb20-1408" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Low-Sensitivity Parameters**: TAB3 and H2 showed minimal influence on model performance (T <span class="sc">\&lt;</span> 0.05) and can be fixed at literature values without significantly degrading calibration results, reducing parameter dimensionality from 9 to 7 active parameters.</span>
<span id="cb20-1409"><a href="#cb20-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1410"><a href="#cb20-1410" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Metric Consistency**: Strong correlation between NSE and KGE (r = 0.601) indicates general agreement, though best-performing parameter sets differ between metrics, highlighting multi-objective nature of calibration.</span>
<span id="cb20-1411"><a href="#cb20-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1412"><a href="#cb20-1412" aria-hidden="true" tabindex="-1"></a><span class="fu">## Contributions of This Work</span></span>
<span id="cb20-1413"><a href="#cb20-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1414"><a href="#cb20-1414" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Comprehensive sensitivity analysis providing quantitative parameter importance rankings for COSERO in Alpine catchments</span>
<span id="cb20-1415"><a href="#cb20-1415" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Development of reproducible R package workflow (COSERO-R) enabling systematic sensitivity analysis and calibration</span>
<span id="cb20-1416"><a href="#cb20-1416" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Identification of catchment-specific parameter constraints to guide future calibration efforts</span>
<span id="cb20-1417"><a href="#cb20-1417" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Documentation of best practices for COSERO Monte Carlo experiments, including reproducibility considerations</span>
<span id="cb20-1418"><a href="#cb20-1418" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interactive visualization tools (Shiny app) for exploring model results and sensitivity patterns</span>
<span id="cb20-1419"><a href="#cb20-1419" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Open-source codebase facilitating community adoption and extension</span>
<span id="cb20-1420"><a href="#cb20-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1421"><a href="#cb20-1421" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practical Recommendations</span></span>
<span id="cb20-1422"><a href="#cb20-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1423"><a href="#cb20-1423" aria-hidden="true" tabindex="-1"></a>For practitioners applying COSERO in similar Alpine catchments, this study provides actionable guidance:</span>
<span id="cb20-1424"><a href="#cb20-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1425"><a href="#cb20-1425" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Focus calibration on TVS1, TVS2, and KBF as priority parameters</span>
<span id="cb20-1426"><a href="#cb20-1426" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Use behavioral parameter ranges (@tbl-behavioral) as informed prior constraints</span>
<span id="cb20-1427"><a href="#cb20-1427" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fix TAB3 and H2 to reduce calibration complexity</span>
<span id="cb20-1428"><a href="#cb20-1428" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Expect NSE values in range 0.75-0.90 with proper calibration</span>
<span id="cb20-1429"><a href="#cb20-1429" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Validate temperature input data quality given high sensitivity to temperature variance</span>
<span id="cb20-1430"><a href="#cb20-1430" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Consider multi-objective calibration balancing NSE and KGE</span>
<span id="cb20-1431"><a href="#cb20-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1432"><a href="#cb20-1432" aria-hidden="true" tabindex="-1"></a><span class="fu">## Future Research Directions</span></span>
<span id="cb20-1433"><a href="#cb20-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1434"><a href="#cb20-1434" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Extend sensitivity analysis to temporal aspects (seasonal parameter variation)</span>
<span id="cb20-1435"><a href="#cb20-1435" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Apply methodology to diverse catchments (non-Alpine, semi-arid) to assess transferability</span>
<span id="cb20-1436"><a href="#cb20-1436" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Investigate additional parameters (e.g., soil moisture, evapotranspiration) for catchments where baseflow is less dominant</span>
<span id="cb20-1437"><a href="#cb20-1437" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Implement formal uncertainty quantification using Bayesian or GLUE frameworks</span>
<span id="cb20-1438"><a href="#cb20-1438" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Develop multi-site calibration strategies leveraging parameter sensitivity insights</span>
<span id="cb20-1439"><a href="#cb20-1439" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Enhance COSERO-R with cloud computing integration for large-scale regional applications</span>
<span id="cb20-1440"><a href="#cb20-1440" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Explore machine learning emulators to accelerate sensitivity analysis for larger parameter spaces</span>
<span id="cb20-1441"><a href="#cb20-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1442"><a href="#cb20-1442" aria-hidden="true" tabindex="-1"></a>This comprehensive sensitivity analysis advances understanding of COSERO parameter importance in Alpine catchments and provides both theoretical insights and practical tools to improve hydrological modeling efficiency and reliability. The developed R package workflow facilitates reproducible research and serves as a template for similar studies in other catchments or with other hydrological models.</span>
<span id="cb20-1443"><a href="#cb20-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1444"><a href="#cb20-1444" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered}</span></span>
<span id="cb20-1445"><a href="#cb20-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1446"><a href="#cb20-1446" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb20-1447"><a href="#cb20-1447" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb20-1448"><a href="#cb20-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1449"><a href="#cb20-1449" aria-hidden="true" tabindex="-1"></a><span class="fu"># Appendices {.unnumbered}</span></span>
<span id="cb20-1450"><a href="#cb20-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1451"><a href="#cb20-1451" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix A: Complete COSERO Parameter List</span></span>
<span id="cb20-1452"><a href="#cb20-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1453"><a href="#cb20-1453" aria-hidden="true" tabindex="-1"></a>@tbl-all-parameters presents all COSERO parameters available for calibration, including those not analyzed in this sensitivity study. Parameters analyzed in this study are marked with an asterisk (<span class="sc">\*</span>).</span>
<span id="cb20-1454"><a href="#cb20-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1457"><a href="#cb20-1457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1458"><a href="#cb20-1458" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-all-parameters</span></span>
<span id="cb20-1459"><a href="#cb20-1459" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Complete list of COSERO parameters with analysis status"</span></span>
<span id="cb20-1460"><a href="#cb20-1460" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1461"><a href="#cb20-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1462"><a href="#cb20-1462" aria-hidden="true" tabindex="-1"></a>all_params <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-1463"><a href="#cb20-1463" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"M*"</span>, <span class="st">"TAB1*"</span>, <span class="st">"TAB2*"</span>, <span class="st">"TAB3*"</span>, <span class="st">"TAB4"</span>, <span class="st">"TAB5"</span>, </span>
<span id="cb20-1464"><a href="#cb20-1464" aria-hidden="true" tabindex="-1"></a>                <span class="st">"TVS1*"</span>, <span class="st">"TVS2*"</span>, <span class="st">"KBF*"</span>, <span class="st">"H1*"</span>, <span class="st">"H2*"</span>, <span class="st">"BETA"</span>, </span>
<span id="cb20-1465"><a href="#cb20-1465" aria-hidden="true" tabindex="-1"></a>                <span class="st">"FK"</span>, <span class="st">"PWP"</span>, <span class="st">"FKFAK"</span>, <span class="st">"TCOR"</span>, <span class="st">"CTMAX"</span>, <span class="st">"CTMIN"</span>, </span>
<span id="cb20-1466"><a href="#cb20-1466" aria-hidden="true" tabindex="-1"></a>                <span class="st">"ETSLPCOR"</span>, <span class="st">"NVAR"</span>),</span>
<span id="cb20-1467"><a href="#cb20-1467" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description =</span> <span class="fu">c</span>(</span>
<span id="cb20-1468"><a href="#cb20-1468" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Snowmelt coefficient"</span>, <span class="st">"Temperature threshold 1"</span>, <span class="st">"Temperature threshold 2"</span>,</span>
<span id="cb20-1469"><a href="#cb20-1469" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Temperature threshold 3"</span>, <span class="st">"Temperature threshold 4"</span>, <span class="st">"Temperature threshold 5"</span>,</span>
<span id="cb20-1470"><a href="#cb20-1470" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Temperature variance 1"</span>, <span class="st">"Temperature variance 2"</span>, <span class="st">"Baseflow recession coefficient"</span>,</span>
<span id="cb20-1471"><a href="#cb20-1471" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Storage coefficient 1"</span>, <span class="st">"Storage coefficient 2"</span>, <span class="st">"Soil moisture parameter"</span>,</span>
<span id="cb20-1472"><a href="#cb20-1472" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Field capacity"</span>, <span class="st">"Permanent wilting point"</span>, <span class="st">"Field capacity factor"</span>,</span>
<span id="cb20-1473"><a href="#cb20-1473" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Temperature correction factor"</span>, <span class="st">"Maximum temperature correction"</span>,</span>
<span id="cb20-1474"><a href="#cb20-1474" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Minimum temperature correction"</span>, <span class="st">"ET slope correction"</span>, <span class="st">"Number of variables"</span></span>
<span id="cb20-1475"><a href="#cb20-1475" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-1476"><a href="#cb20-1476" aria-hidden="true" tabindex="-1"></a>  <span class="at">Unit =</span> <span class="fu">c</span>(<span class="st">"mm/°C/day"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"days"</span>, </span>
<span id="cb20-1477"><a href="#cb20-1477" aria-hidden="true" tabindex="-1"></a>           <span class="st">"mm"</span>, <span class="st">"mm"</span>, <span class="st">"-"</span>, <span class="st">"mm"</span>, <span class="st">"mm"</span>, <span class="st">"-"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"°C"</span>, <span class="st">"-"</span>, <span class="st">"-"</span>),</span>
<span id="cb20-1478"><a href="#cb20-1478" aria-hidden="true" tabindex="-1"></a>  <span class="at">Analyzed =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">11</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">9</span>))</span>
<span id="cb20-1479"><a href="#cb20-1479" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-1480"><a href="#cb20-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1481"><a href="#cb20-1481" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (knitr<span class="sc">::</span><span class="fu">is_latex_output</span>()) {</span>
<span id="cb20-1482"><a href="#cb20-1482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(all_params,</span>
<span id="cb20-1483"><a href="#cb20-1483" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Parameter"</span>, <span class="st">"Description"</span>, <span class="st">"Unit"</span>, <span class="st">"Analyzed"</span>),</span>
<span id="cb20-1484"><a href="#cb20-1484" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"c"</span>),</span>
<span id="cb20-1485"><a href="#cb20-1485" aria-hidden="true" tabindex="-1"></a>        <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-1486"><a href="#cb20-1486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>))</span>
<span id="cb20-1487"><a href="#cb20-1487" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb20-1488"><a href="#cb20-1488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(all_params,</span>
<span id="cb20-1489"><a href="#cb20-1489" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Parameter"</span>, <span class="st">"Description"</span>, <span class="st">"Unit"</span>, <span class="st">"Analyzed"</span>),</span>
<span id="cb20-1490"><a href="#cb20-1490" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"c"</span>))</span>
<span id="cb20-1491"><a href="#cb20-1491" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-1492"><a href="#cb20-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1493"><a href="#cb20-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1494"><a href="#cb20-1494" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix B: Code Repository and Reproducibility</span></span>
<span id="cb20-1495"><a href="#cb20-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1496"><a href="#cb20-1496" aria-hidden="true" tabindex="-1"></a><span class="fu">### GitHub Repository</span></span>
<span id="cb20-1497"><a href="#cb20-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1498"><a href="#cb20-1498" aria-hidden="true" tabindex="-1"></a>The complete COSERO-R package, including all code, documentation, and example datasets, is available upon request. The package contains:</span>
<span id="cb20-1499"><a href="#cb20-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1500"><a href="#cb20-1500" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Complete R source code for all sensitivity analysis functions</span>
<span id="cb20-1501"><a href="#cb20-1501" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Example parameter files and configuration templates</span>
<span id="cb20-1502"><a href="#cb20-1502" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Documentation and vignettes for reproducibility</span>
<span id="cb20-1503"><a href="#cb20-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1504"><a href="#cb20-1504" aria-hidden="true" tabindex="-1"></a><span class="fu">### Repository Structure</span></span>
<span id="cb20-1505"><a href="#cb20-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1506"><a href="#cb20-1506" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`R/`</span>: Core package functions (cosero_run.R, cosero_readers.R, sensitivity_analysis.R)</span>
<span id="cb20-1507"><a href="#cb20-1507" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`inst/shiny-app/`</span>: Interactive visualization application</span>
<span id="cb20-1508"><a href="#cb20-1508" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`inst/extdata/`</span>: Parameter bounds and example data</span>
<span id="cb20-1509"><a href="#cb20-1509" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`tests/testthat/`</span>: Unit tests (33 tests)</span>
<span id="cb20-1510"><a href="#cb20-1510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`vignettes/`</span>: Tutorials and examples</span>
<span id="cb20-1511"><a href="#cb20-1511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`man/`</span>: Function documentation</span>
<span id="cb20-1512"><a href="#cb20-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1513"><a href="#cb20-1513" aria-hidden="true" tabindex="-1"></a><span class="fu">### Software Versions</span></span>
<span id="cb20-1514"><a href="#cb20-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1515"><a href="#cb20-1515" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>R version: 4.3.0 or higher</span>
<span id="cb20-1516"><a href="#cb20-1516" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>COSERO version: 5.2 (2023 build)</span>
<span id="cb20-1517"><a href="#cb20-1517" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Key package versions:</span>
<span id="cb20-1518"><a href="#cb20-1518" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>data.table: 1.14.8</span>
<span id="cb20-1519"><a href="#cb20-1519" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>ggplot2: 3.4.2</span>
<span id="cb20-1520"><a href="#cb20-1520" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>sensitivity: 1.28.0</span>
<span id="cb20-1521"><a href="#cb20-1521" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>shiny: 1.7.4</span>
<span id="cb20-1522"><a href="#cb20-1522" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>plotly: 4.10.2</span>
<span id="cb20-1523"><a href="#cb20-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1524"><a href="#cb20-1524" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reproducing This Analysis</span></span>
<span id="cb20-1525"><a href="#cb20-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1526"><a href="#cb20-1526" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Install COSERO-R package: <span class="in">`remotes::install_github("username/COSERO-R")`</span></span>
<span id="cb20-1527"><a href="#cb20-1527" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Download example data from repository</span>
<span id="cb20-1528"><a href="#cb20-1528" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Run vignette code: <span class="in">`vignette("sensitivity_analysis", package = "COSERO")`</span></span>
<span id="cb20-1529"><a href="#cb20-1529" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Expected runtime: 18-24 hours for full 5,500 simulations</span>
<span id="cb20-1530"><a href="#cb20-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1531"><a href="#cb20-1531" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix C: Top 10 Parameter Sets</span></span>
<span id="cb20-1532"><a href="#cb20-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1533"><a href="#cb20-1533" aria-hidden="true" tabindex="-1"></a>The top 10 parameter combinations ranked by NSE performance represent optimal calibration starting points for similar catchments. These simulations show NSE values ranging from 0.891 to 0.896 and KGE values from 0.881 to 0.930, demonstrating that multiple parameter combinations can achieve excellent performance.</span>
<span id="cb20-1534"><a href="#cb20-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1535"><a href="#cb20-1535" aria-hidden="true" tabindex="-1"></a>@tbl-top10 presents the complete parameter values for the top 10 simulations.</span>
<span id="cb20-1536"><a href="#cb20-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1539"><a href="#cb20-1539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb20-1540"><a href="#cb20-1540" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-top10</span></span>
<span id="cb20-1541"><a href="#cb20-1541" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Top 10 parameter sets ranked by NSE performance"</span></span>
<span id="cb20-1542"><a href="#cb20-1542" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb20-1543"><a href="#cb20-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1544"><a href="#cb20-1544" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb20-1545"><a href="#cb20-1545" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb20-1546"><a href="#cb20-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1547"><a href="#cb20-1547" aria-hidden="true" tabindex="-1"></a>top10_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-1548"><a href="#cb20-1548" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rank =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb20-1549"><a href="#cb20-1549" aria-hidden="true" tabindex="-1"></a>  <span class="at">SimID =</span> <span class="fu">c</span>(<span class="dv">3287</span>, <span class="dv">4079</span>, <span class="dv">1876</span>, <span class="dv">1241</span>, <span class="dv">1980</span>, <span class="dv">4667</span>, <span class="dv">2207</span>, <span class="dv">1019</span>, <span class="dv">2723</span>, <span class="dv">1357</span>),</span>
<span id="cb20-1550"><a href="#cb20-1550" aria-hidden="true" tabindex="-1"></a>  <span class="at">NSE =</span> <span class="fu">c</span>(<span class="fl">0.896</span>, <span class="fl">0.896</span>, <span class="fl">0.893</span>, <span class="fl">0.893</span>, <span class="fl">0.892</span>, <span class="fl">0.892</span>, <span class="fl">0.892</span>, <span class="fl">0.891</span>, <span class="fl">0.891</span>, <span class="fl">0.891</span>),</span>
<span id="cb20-1551"><a href="#cb20-1551" aria-hidden="true" tabindex="-1"></a>  <span class="at">KGE =</span> <span class="fu">c</span>(<span class="fl">0.919</span>, <span class="fl">0.895</span>, <span class="fl">0.922</span>, <span class="fl">0.910</span>, <span class="fl">0.930</span>, <span class="fl">0.903</span>, <span class="fl">0.917</span>, <span class="fl">0.881</span>, <span class="fl">0.925</span>, <span class="fl">0.921</span>),</span>
<span id="cb20-1552"><a href="#cb20-1552" aria-hidden="true" tabindex="-1"></a>  <span class="at">M =</span> <span class="fu">c</span>(<span class="fl">218.2</span>, <span class="fl">247.0</span>, <span class="fl">278.1</span>, <span class="fl">290.7</span>, <span class="fl">215.9</span>, <span class="fl">304.5</span>, <span class="fl">244.7</span>, <span class="fl">288.4</span>, <span class="fl">226.3</span>, <span class="fl">252.8</span>),</span>
<span id="cb20-1553"><a href="#cb20-1553" aria-hidden="true" tabindex="-1"></a>  <span class="at">TAB1 =</span> <span class="fu">c</span>(<span class="fl">45.5</span>, <span class="fl">32.2</span>, <span class="fl">46.2</span>, <span class="fl">31.2</span>, <span class="fl">36.5</span>, <span class="fl">35.9</span>, <span class="fl">38.4</span>, <span class="fl">36.9</span>, <span class="fl">37.3</span>, <span class="fl">37.6</span>),</span>
<span id="cb20-1554"><a href="#cb20-1554" aria-hidden="true" tabindex="-1"></a>  <span class="at">TAB2 =</span> <span class="fu">c</span>(<span class="fl">243.5</span>, <span class="fl">232.3</span>, <span class="fl">231.9</span>, <span class="fl">176.6</span>, <span class="fl">177.8</span>, <span class="fl">221.5</span>, <span class="fl">201.5</span>, <span class="fl">197.4</span>, <span class="fl">246.5</span>, <span class="fl">158.7</span>),</span>
<span id="cb20-1555"><a href="#cb20-1555" aria-hidden="true" tabindex="-1"></a>  <span class="at">TAB3 =</span> <span class="fu">c</span>(<span class="dv">3001</span>, <span class="dv">3691</span>, <span class="dv">4366</span>, <span class="dv">2310</span>, <span class="dv">4745</span>, <span class="dv">3312</span>, <span class="dv">2978</span>, <span class="dv">3842</span>, <span class="dv">2492</span>, <span class="dv">4002</span>),</span>
<span id="cb20-1556"><a href="#cb20-1556" aria-hidden="true" tabindex="-1"></a>  <span class="at">TVS1 =</span> <span class="fu">c</span>(<span class="fl">33.4</span>, <span class="fl">16.0</span>, <span class="fl">40.1</span>, <span class="fl">25.6</span>, <span class="fl">20.7</span>, <span class="fl">32.3</span>, <span class="fl">34.8</span>, <span class="fl">16.4</span>, <span class="fl">24.9</span>, <span class="fl">24.7</span>),</span>
<span id="cb20-1557"><a href="#cb20-1557" aria-hidden="true" tabindex="-1"></a>  <span class="at">TVS2 =</span> <span class="fu">c</span>(<span class="fl">513.9</span>, <span class="fl">569.6</span>, <span class="fl">627.3</span>, <span class="fl">559.8</span>, <span class="fl">621.4</span>, <span class="fl">634.1</span>, <span class="fl">489.4</span>, <span class="fl">464.0</span>, <span class="fl">661.5</span>, <span class="fl">611.6</span>),</span>
<span id="cb20-1558"><a href="#cb20-1558" aria-hidden="true" tabindex="-1"></a>  <span class="at">KBF =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">4330</span>, <span class="dv">3214</span>, <span class="dv">3520</span>, <span class="dv">4892</span>, <span class="dv">3323</span>, <span class="dv">3599</span>, <span class="dv">5633</span>, <span class="dv">6284</span>, <span class="dv">4004</span>),</span>
<span id="cb20-1559"><a href="#cb20-1559" aria-hidden="true" tabindex="-1"></a>  <span class="at">H1 =</span> <span class="fu">c</span>(<span class="fl">0.278</span>, <span class="fl">0.317</span>, <span class="fl">0.517</span>, <span class="fl">0.383</span>, <span class="fl">0.376</span>, <span class="fl">0.495</span>, <span class="fl">0.479</span>, <span class="fl">0.290</span>, <span class="fl">0.585</span>, <span class="fl">0.496</span>),</span>
<span id="cb20-1560"><a href="#cb20-1560" aria-hidden="true" tabindex="-1"></a>  <span class="at">H2 =</span> <span class="fu">c</span>(<span class="fl">11.4</span>, <span class="fl">19.8</span>, <span class="fl">8.1</span>, <span class="fl">10.7</span>, <span class="fl">11.9</span>, <span class="fl">17.9</span>, <span class="fl">10.4</span>, <span class="fl">5.7</span>, <span class="fl">14.8</span>, <span class="fl">12.5</span>)</span>
<span id="cb20-1561"><a href="#cb20-1561" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-1562"><a href="#cb20-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1563"><a href="#cb20-1563" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (knitr<span class="sc">::</span><span class="fu">is_latex_output</span>()) {</span>
<span id="cb20-1564"><a href="#cb20-1564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(top10_df,</span>
<span id="cb20-1565"><a href="#cb20-1565" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Rank"</span>, <span class="st">"Sim ID"</span>, <span class="st">"NSE"</span>, <span class="st">"KGE"</span>, <span class="st">"M"</span>, <span class="st">"TAB1"</span>, <span class="st">"TAB2"</span>,</span>
<span id="cb20-1566"><a href="#cb20-1566" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"TAB3"</span>, <span class="st">"TVS1"</span>, <span class="st">"TVS2"</span>, <span class="st">"KBF"</span>, <span class="st">"H1"</span>, <span class="st">"H2"</span>),</span>
<span id="cb20-1567"><a href="#cb20-1567" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="dv">9</span>)),</span>
<span id="cb20-1568"><a href="#cb20-1568" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb20-1569"><a href="#cb20-1569" aria-hidden="true" tabindex="-1"></a>        <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-1570"><a href="#cb20-1570" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"scale_down"</span>, <span class="st">"hold_position"</span>),</span>
<span id="cb20-1571"><a href="#cb20-1571" aria-hidden="true" tabindex="-1"></a>                  <span class="at">font_size =</span> <span class="dv">9</span>)</span>
<span id="cb20-1572"><a href="#cb20-1572" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb20-1573"><a href="#cb20-1573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(top10_df,</span>
<span id="cb20-1574"><a href="#cb20-1574" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Rank"</span>, <span class="st">"Sim ID"</span>, <span class="st">"NSE"</span>, <span class="st">"KGE"</span>, <span class="st">"M"</span>, <span class="st">"TAB1"</span>, <span class="st">"TAB2"</span>,</span>
<span id="cb20-1575"><a href="#cb20-1575" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"TAB3"</span>, <span class="st">"TVS1"</span>, <span class="st">"TVS2"</span>, <span class="st">"KBF"</span>, <span class="st">"H1"</span>, <span class="st">"H2"</span>),</span>
<span id="cb20-1576"><a href="#cb20-1576" aria-hidden="true" tabindex="-1"></a>        <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="fu">rep</span>(<span class="st">"r"</span>, <span class="dv">9</span>)),</span>
<span id="cb20-1577"><a href="#cb20-1577" aria-hidden="true" tabindex="-1"></a>        <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb20-1578"><a href="#cb20-1578" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-1579"><a href="#cb20-1579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb20-1580"><a href="#cb20-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1581"><a href="#cb20-1581" aria-hidden="true" tabindex="-1"></a>These parameter sets provide robust starting points for calibration in similar Alpine catchments. Note the variability in parameter values even among high-performing simulations, indicating some degree of parameter compensation and equifinality.</span>
<span id="cb20-1582"><a href="#cb20-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1583"><a href="#cb20-1583" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix D: Behavioral Parameter Constraints</span></span>
<span id="cb20-1584"><a href="#cb20-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1585"><a href="#cb20-1585" aria-hidden="true" tabindex="-1"></a>Detailed statistical summaries of parameter values for behavioral simulations (NSE <span class="sc">\&gt;</span> 0.5) are useful for defining informed prior distributions in Bayesian calibration or for constraining automated optimization algorithms.</span>
<span id="cb20-1586"><a href="#cb20-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-1587"><a href="#cb20-1587" aria-hidden="true" tabindex="-1"></a>These constraints represent empirical evidence of acceptable parameter ranges for this catchment and can serve as initial bounds for calibration in similar Alpine environments. Full behavioral constraints are available in <span class="in">`parameter_constraints_behavioral.csv`</span>.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>