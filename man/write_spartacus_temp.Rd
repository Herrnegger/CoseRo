% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spartacus_preprocessing.R
\name{write_spartacus_temp}
\alias{write_spartacus_temp}
\title{Extract SPARTACUS Temperature (Tmean) for COSERO Input}
\usage{
write_spartacus_temp(
  tmin_dir,
  tmax_dir,
  output_dir,
  model_zones,
  nz_col = "NZ",
  n_cores = NULL
)
}
\arguments{
\item{tmin_dir}{Directory containing yearly SPARTACUS Tmin NetCDF files
(pattern: SPARTACUS2-DAILY_TN_YYYY.nc)}

\item{tmax_dir}{Directory containing yearly SPARTACUS Tmax NetCDF files
(pattern: SPARTACUS2-DAILY_TX_YYYY.nc)}

\item{output_dir}{Directory where the output .txt file will be saved}

\item{model_zones}{sf object containing modeling zones, must include a zone ID column}

\item{nz_col}{Name of the column with zone IDs (default: "NZ"). Output will be
sorted by this column to ensure consistent ordering.}

\item{n_cores}{Number of cores for parallel processing. If NULL (default),
uses all available cores minus 1.}
}
\value{
Invisibly returns the path to the output file
}
\description{
Processes yearly SPARTACUS min/max temperature NetCDF files, calculates
pixel-wise mean temperature, and writes a single text file in COSERO
meteorological input format. Handles large datasets efficiently through
parallel processing and batched I/O.
}
\details{
\strong{Output Format:}
The output file follows COSERO's meteorological input format:
\itemize{
\item Rows: One per day (chronologically ordered)
\item Columns: YYYY MM DD HH mm NZ1 NZ2 ... NZn
\item Values: Area-weighted mean temperature (Â°C) per zone
\item Filename: \verb{T_NZ_<start_year>_<end_year>.txt}
}

\strong{Temperature Calculation:}
Tmean is calculated at the pixel level before spatial aggregation:
\code{Tmean = (Tmin + Tmax) / 2}

This approach is more accurate than averaging zone-aggregated min/max values,
especially in areas with high topographic variability.

\strong{Performance:}
\itemize{
\item Pixel-wise calculation using terra's vectorized C++ operations
\item exactextractr for fast area-weighted spatial aggregation
\item Parallel processing with batched execution
\item High-speed disk I/O using data.table::fwrite
}

\strong{SPARTACUS Data:}
\itemize{
\item Source: GeoSphere Austria (https://doi.org/10.60669/m6w8-s545)
\item Spatial Resolution: 1 km
\item Temporal Resolution: Daily
\item Projection: ETRS89 (EPSG:4258)
\item Coverage: Austria (1961-present)
\item Parameters: TN (minimum), TX (maximum)
}
}
\examples{
\dontrun{
library(sf)
zones <- st_read("model_zones.shp")

# Process temperature data
write_spartacus_temp(
  tmin_dir = "data/SPARTACUS_Daily/TN",
  tmax_dir = "data/SPARTACUS_Daily/TX",
  output_dir = "output/cosero_input",
  model_zones = zones,
  nz_col = "NZ",
  n_cores = 4
)
}

}
\seealso{
\code{\link{write_spartacus_precip}} for precipitation preprocessing
}
