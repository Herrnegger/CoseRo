% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spartacus_preprocessing.R
\name{write_spartacus_precip}
\alias{write_spartacus_precip}
\title{Extract SPARTACUS Precipitation for COSERO Input}
\usage{
write_spartacus_precip(
  nc_dir,
  output_dir,
  model_zones,
  nz_col = "NZ",
  n_cores = NULL
)
}
\arguments{
\item{nc_dir}{Directory containing yearly SPARTACUS precipitation NetCDF files
(pattern: SPARTACUS2-DAILY_RR_YYYY.nc)}

\item{output_dir}{Directory where the output .txt file will be saved}

\item{model_zones}{sf object containing modeling zones, must include a zone ID column}

\item{nz_col}{Name of the column with zone IDs (default: "NZ"). Output will be
sorted by this column to ensure consistent ordering.}

\item{n_cores}{Number of cores for parallel processing. If NULL (default),
uses all available cores minus 1.}
}
\value{
Invisibly returns the path to the output file
}
\description{
Processes yearly SPARTACUS precipitation NetCDF files and writes a single
text file in COSERO meteorological input format. The function performs
spatial aggregation by zone using area-weighted means and handles large
datasets efficiently through parallel processing and batched I/O.
}
\details{
\strong{Output Format:}
The output file follows COSERO's meteorological input format:
\itemize{
\item Rows: One per day (chronologically ordered)
\item Columns: YYYY MM DD HH mm NZ1 NZ2 ... NZn
\item Values: Area-weighted mean precipitation (mm) per zone
\item Filename: \verb{P_NZ_<start_year>_<end_year>.txt}
}

\strong{Performance:}
\itemize{
\item Uses exactextractr for fast area-weighted spatial aggregation
\item Parallel processing with batched execution to optimize CPU and memory usage
\item High-speed disk I/O using data.table::fwrite
\item Processes 10+ years of daily 1km data in minutes
}

\strong{SPARTACUS Data:}
\itemize{
\item Source: GeoSphere Austria (https://doi.org/10.60669/m6w8-s545)
\item Spatial Resolution: 1 km
\item Temporal Resolution: Daily
\item Projection: ETRS89 (EPSG:4258)
\item Coverage: Austria (1961-present)
}
}
\examples{
\dontrun{
library(sf)
zones <- st_read("model_zones.shp")

# Process precipitation data
write_spartacus_precip(
  nc_dir = "data/SPARTACUS_Daily/RR",
  output_dir = "output/cosero_input",
  model_zones = zones,
  nz_col = "NZ",
  n_cores = 4
)
}

}
\seealso{
\code{\link{write_spartacus_temp}} for temperature preprocessing
}
