% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spartacus_preprocessing.R
\name{spartacus_preprocessing}
\alias{spartacus_preprocessing}
\title{SPARTACUS Data Preprocessing for COSERO}
\description{
High-performance extraction of SPARTACUS gridded climate data for Austria.
Uses a sparse weight matrix approach that maps modeling zones directly to
raw NetCDF memory layout for extremely fast, RAM-efficient processing.
}
\details{
\strong{IMPORTANT: These functions are specifically designed for SPARTACUS NetCDF files
from GeoSphere Austria. They will NOT work with other gridded datasets due to
the hardcoded filename patterns and the raw cell index mapping logic.}
\subsection{The Sparse Weight Matrix Approach}{

The innovation is building a sparse weight matrix that maps directly to
the raw (unflipped) NetCDF storage layout. This avoids expensive raster
transformations during processing:
\enumerate{
\item SPARTACUS NetCDF files store data top-to-bottom (row 0 = north),
but \code{exactextractr} works with standard GIS orientation (row 0 = south).
Flipping large rasters for each timestep is slow and memory-intensive.
\item We flip the raster ONCE to get correct cell-polygon overlaps,
then mathematically transform those cell indices back to raw NetCDF positions.
The formula reverses the row order: \code{raw_row = (nrows - 1) - flipped_row}
\item A sparse matrix W where \code{W[zone, cell] = coverage_fraction}.
Computing zonal means becomes a single matrix multiplication:
\code{zonal_means = W \%*\% cell_values} - highly optimized by the Matrix package.
}

This approach is ~10x faster than traditional methods because:
\itemize{
\item We extract only the cells we need (not the entire grid)
\item Sparse matrix algebra replaces nested loops
\item No per-timestep raster transformations
}

The primary functions are:
\itemize{
\item \code{\link{write_spartacus_precip}}: For precipitation (RR).
\item \code{\link{write_spartacus_temp}}: For mean temperature (from TN and TX).
}
}
}
\references{
Hiebl, J. and Frei, C. (2016). Daily temperature grids for Austria since 1961 —
concept, creation and applicability. \emph{Theor. Appl. Climatol.}
\strong{124}(1):161-178.
\href{https://doi.org/10.1007/s00704-015-1411-4}{doi:10.1007/s00704-015-1411-4}

Hiebl, J. and Frei, C. (2018). Daily precipitation grids for Austria since 1961 —
development and evaluation of a spatial dataset for hydroclimatic monitoring and
modelling. \emph{Theor. Appl. Climatol.} \strong{132}(1):327-345.
\href{https://doi.org/10.1007/s00704-017-2093-x}{doi:10.1007/s00704-017-2093-x}

GeoSphere Austria (2023). SPARTACUS v2 — Spatial Reanalysis of Temperature and
Precipitation for Austria.
\href{https://doi.org/10.60669/m6w8-s545}{doi:10.60669/m6w8-s545}
}
\keyword{internal}
